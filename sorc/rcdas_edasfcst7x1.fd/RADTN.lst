Page 1           Source Listing                  RADTN
2022-02-15 16:37                                 /tmp/ifortel5iTg.i

      1 # 1 "RADTN.F"
      2 C&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
      3                              SUBROUTINE RADTN
      4 C     ******************************************************************
      5 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
      6 C                .      .    .
      7 C SUBPROGRAM:    RADTN       THE OUTER RADIATION DRIVER
      8 C   PRGRMMR: BLACK           ORG: W/NP22     DATE: 93-12-??
      9 C
     10 C ABSTRACT:
     11 C     RADTN PRIMARILY SERVES TO SET UP THE ARRAYS NEEDED AS INPUT
     12 C     FOR RADFS (THE INNER RADIATION DRIVER).  GROUPS OF MODEL COLUMNS
     13 C     ARE SENT TO RADFS BUT FIRST THEY ARE "LIFTED" SO THAT THE LOWEST
     14 C     LAYER ABOVE THE GROUND HAS A VERTICAL INDEX VALUE OF LM NOT LMH.
     15 C     THIS ROUTINE IS CALLED AS OFTEN AS DESIRED (EVERY 1 TO 2 HOURS)
     16 C     FOR BOTH THE SHORT AND LONGWAVE EFFECTS.  THE RESULTING TEMPER-
     17 C     ATURE TENDENCIES, TOTAL DOWNWARD AND SHORTWAVE UPWARD FLUXES ARE
     18 C     COLLECTED.
     19 C     THE INITIAL GROUND POTENTIAL TEMPERATURE IS ALSO COMPUTED HERE
     20 C     AND IS SIMPLY AN ADIABATIC EXTRAPOLATION FROM THE LOWEST MID-
     21 C     LAYER VALUE ABOVE THE GROUND.
     22 C
     23 C PROGRAM HISTORY LOG:
     24 C   87-09-??  BLACK      - ORIGINATOR
     25 C   92-10-??  BALDWIN    - VARIOUS CLOUD EFFECTS WERE INCLUDED
     26 C                          WHICH WERE ALREADY IN THE MRF
     27 C   93-11-??  ZHAO       - TIED TO UPDATED GFDL RADIATION SCHEME
     28 C                          USING MODEL-PREDICTED CLOUD
     29 C   95-03-25  BLACK      - CONVERSION FROM 1-D TO 2-D IN HORIZONTAL
     30 C   95-04-13  BLACK      - PARALLELIZED THE LARGE LOOP STEPPING
     31 C                          THROUGH THE DOMAIN THAT CALLS RADFS
     32 C   95-10-10  ZHAO       - i) THE CALCULATION OF CLOUD FRACTION WAS
     33 C                             CHANGED TO USE BOTH CLOUD WATER/ICE
     34 C                             MIXING RATIO AND RELATIVE HUMIDITY
     35 C                             (RANDALL, 1994);
     36 C                          ii) THE CLOUD INPUTS WERE CHANGED TO USE
     37 C                              CLOUD FRACTION IN EACH MODEL LAYER
     38 C                              AFTER Y.T. HOU (1995).
     39 C   96-06-03  ZHAO       - SNOW ALBEDO IS CHANGED ACCORDING TO
     40 C                          SUGGESTIONS FROM KEN MITCHELL AND FEI CHEN
     41 C   96-07-23  ZHAO       - ADD CALL TO SOLARD TO CALCULATE THE NON-
     42 C                          DIMENSIONAL SUN-EARTH DISTANCE R1 WHICH
     43 C                          WILL BE USED IN RADFS TO COMPUTE SOLAR
     44 C                          CONSTANT SOLC ON EACH DAY
     45 C   96-07-26  BLACK      - ADDED OZONE COMPUTATIONS
     46 C   97-05-19  ZHAO       - DIAGNOSTIC CLOUDS (LOW, MIDDLE, AND HIGH)
     47 C                          ARE MODIFIED TO USE THE MAXIMUM OF
     48 C                          CONVECTIVE AND STRATIFORM. THIS WILL REPLACE
     49 C                          THE PREVIOUS SCHEME WHICH USES ONLY CONVECTIVE
     50 C                          CLOUDS AT CONVECTIVE POINTS. THIS WILL
     51 C                          AFFECT CFRACL, CFRACM, CFRACH, AND WILL
     52 C                          AFFECT THE TOTAL CLOUD FRACTION CALCULATION
     53 C                          IN THE POST PROCESSORS.
     54 C   98-??-??  TUCCILLO   - ADDED PARALLELISM FOR CLASS VIII
     55 C   98-10-27  BLACK      - PARALLELISM INTO NEWEST VERSION
     56 C
     57 C

Page 2           Source Listing                  RADTN
2022-02-15 16:37                                 RADTN.F

     58 C
     59 C USAGE: CALL RADTN FROM MAIN PROGRAM EBU
     60 C   INPUT ARGUMENT LIST:
     61 C     NONE
     62 C
     63 C   OUTPUT ARGUMENT LIST:
     64 C     NONE
     65 C
     66 C   OUTPUT FILES:
     67 C     NONE
     68 C
     69 C   SUBPROGRAMS CALLED:
     70 C
     71 C     UNIQUE:
     72 C        ZENITH
     73 C        RADFS
     74 C        GRADFS
     75 C        SOLARD
     76 C        O3CLIM
     77 C        OZON2D
     78 C
     79 C     LIBRARY:
     80 C        NONE
     81 C
     82 C   COMMON BLOCKS: CTLBLK
     83 C                  LOOPS
     84 C                  MASKS
     85 C                  DYNAMD
     86 C                  PHYS
     87 C                  VRBLS
     88 C                  PVRBLS
     89 C                  CLDWTR
     90 C                  CNVCLD
     91 C                  INDX
     92 C                  ACMCLD
     93 C                  ACMRDS
     94 C                  ACMRDL
     95 C
     96 C ATTRIBUTES:
     97 C   LANGUAGE: FORTRAN 90
     98 C   MACHINE : IBM SP
     99 C$$$
    100 C     ******************************************************************
    101 C     *   Note: Convective clouds are added in this subroutine         *
    102 C     *         for use in the eta model in which model-predicted      *
    103 C     *         clouds are not used in the convective precipitation    *
    104 C     *         processes.                                             *
    105 C     *         For use with the version of the eta model in which     *
    106 C     *         the model-predicted clouds are linked into the model's *
    107 C     *         convective precipitation processes, just set:          *
    108 C     *                    CNCLD=.FALSE.                               *
    109 C     *                                     Qingyun  Zhao  12-9-94     *
    110 C     ******************************************************************
    111 C-----------------------------------------------------------------------
    112       INCLUDE "parmeta"
    135       INCLUDE "parm.tbl"
    137       INCLUDE "parmsoil"

Page 3           Source Listing                  RADTN
2022-02-15 16:37                                 RADTN.F

    139       INCLUDE "mpp.h"
    140 # 1 "./sp.h" 1 
    141 # 4
    142 
    143 # 116 "RADTN.F" 2 
    144 C-----------------------------------------------------------------------
    203                              P A R A M E T E R
    204      & (CAPA=0.28589641,RTD=57.2957795
    205      &, WA=.10,WG=1.-WA,KSMUD=0)
    206 C-------------------------CLOUD----------------------------------------
    207                              P A R A M E T E R
    208      & (A1=610.78,A2=17.2693882,A3=273.16,A4=35.86              
    209 c     &, PQ0=379.90516,SNOALB=0.55)
    210      &, PQ0=379.90516) 
    211 C-------------------------CLOUD----------------------------------------
    212                              P A R A M E T E R
    213      & (IMJM=IM*JM-JM/2,JAM=6+2*(JM-10),LM1=LM-1,LP1=LM+1)
    214 C
    215                              P A R A M E T E R
    216      & (SLPM=1.01325E5,EPSQ1=1.E-5,EPSQ=2.E-12,EPSO3=1.E-10,HPINC=1.E1
    217      &, CLDRH0=0.80,TRESH=1.00,RNRM=1./(TRESH-CLDRH0)
    218      &, CLDRH2=0.90,TRESH2=1.00,RNRM2=1./(TRESH2-CLDRH2)
    219      &, CLAPSE=-0.0005,CLPSE=-0.0006,DCLPS=-0.0001
    220      &, CM1=2937.4,CM2=4.9283,CM3=23.5518,EPS=0.622,PBOT=10000.0 
    221      &, STBOL=5.67E-8,PI2=2.*3.14159265,RLAG=14.8125)
    222 C
    223                              P A R A M E T E R
    224      & (NB=12)
    225 C-----------------------------------------------------------------------
    226                              P A R A M E T E R
    227      & (K15=SELECTED_REAL_KIND(15))
    228 C
    229                              R E A L
    230      & (KIND=K15) PROD,DDX,EEX
    231 C-----------------------------------------------------------------------
    232                              L O G I C A L
    233      & RUN,FIRST,RESTRT,SIGMA,CALL1,SHORT,LONG
    234      &,BCLD(IDIM1:IDIM2),BTEMP1(IDIM1:IDIM2)
    235      &,BITX,BITY,BITZ,BITW,BIT1,BIT2,BITC,BITS,BITCP1,BITSP1
    236 C-------------------------CONVECTION------------------------------------
    237                              L O G I C A L
    238      & CNCLD
    239 C-------------------------CONVECTION------------------------------------
    240       INCLUDE "CTLBLK.comm"
    241 C-----------------------------------------------------------------------
    251       INCLUDE "LOOPS.comm"
    252 C-----------------------------------------------------------------------
    259       INCLUDE "MASKS.comm"
    260 C-----------------------------------------------------------------------
    271       INCLUDE "DYNAMD.comm"
    272 C-----------------------------------------------------------------------
    288       INCLUDE "PHYS.comm"
    289 C-----------------------------------------------------------------------
    317       INCLUDE "VRBLS.comm"
    318 C-----------------------------------------------------------------------
    328       INCLUDE "PVRBLS.comm"
    329 C-----------------------------------------------------------------------

Page 4           Source Listing                  RADTN
2022-02-15 16:37                                 RADTN.F

    359       INCLUDE "SOIL.comm"
    360 C-----------------------------------------------------------------------
    373       INCLUDE "CLDWTR.comm"
    374 C-----------------------------------------------------------------------
    382       INCLUDE "CNVCLD.comm"
    383 C-----------------------------------------------------------------------
    390       INCLUDE "INDX.comm"
    391 C-----------------------------------------------------------------------
    403       INCLUDE "ACMCLD.comm"
    404 C----------------------------------------------------------------------
    411       INCLUDE "ACMRDL.comm"
    412 C----------------------------------------------------------------------
    421       INCLUDE "ACMRDS.comm"
    422 C-----------------------------------------------------------------------
    431       COMMON /CUINIT/ CURAD
    432       LOGICAL CURAD
    433 C-----------------------------------------------------------------------
    434                              C O M M O N
    435      & /SWRSAV/ABCFF(NB),PWTS(NB),CFCO2,CFO3,REFLO3,RRAYAV
    436                              C O M M O N
    437      & /RD1TIM/K400,CTHK(3),LTOP(3),PTOPC(4),TAUCV(3),R1
    438      &, LVL(IDIM1:IDIM2,JDIM1:JDIM2)
    439 C-----------------------------------------------------------------------
    440                              D I M E N S I O N
    441      &  TENDK (LM),CLDAMT(0:LM)
    442      &, PSFC  (IDIM1:IDIM2),TSKN (IDIM1:IDIM2)
    443 c     &, ALBEDO(IDIM1:IDIM2),XLAT(IDIM1:IDIM2),COSZ (IDIM1:IDIM2)
    444      &, ALBDO (IDIM1:IDIM2),XLAT(IDIM1:IDIM2),COSZ (IDIM1:IDIM2)
    445      &, CLDCFR(IDIM1:IDIM2,3),MBOT(IDIM1:IDIM2,3)
    446      &, CLDF  (IDIM1:IDIM2,LP1),SLMSK (IDIM1:IDIM2)
    447      &, TENDS (IDIM1:IDIM2,LM),TENDL (IDIM1:IDIM2,LM)
    448 C
    449      &, PMID  (IDIM1:IDIM2,LM),TMID  (IDIM1:IDIM2,LM)
    450      &, QMID  (IDIM1:IDIM2,LM),THMID(IDIM1:IDIM2,LM)
    451      &, OZN   (IDIM1:IDIM2,LM),POZN  (IDIM1:IDIM2,LM)
    452      &, MTOP(IDIM1:IDIM2,3),ICVB(IDIM1:IDIM2), ICVT(IDIM1:IDIM2)
    453      &, CV(IDIM1:IDIM2),SV(IDIM1:IDIM2)
    454 C
    455      &, FLWUP (IDIM1:IDIM2),FSWDN (IDIM1:IDIM2),FSWUP (IDIM1:IDIM2)
    456      &, FSWDNS(IDIM1:IDIM2),FSWUPS(IDIM1:IDIM2)
    457      &, FLWDNS(IDIM1:IDIM2),FLWUPS(IDIM1:IDIM2)
    458      &, PDSL  (IDIM1:IDIM2,JDIM1:JDIM2)
    459      &, FNE(IDIM1:IDIM2,JDIM1:JDIM2),FSE(IDIM1:IDIM2,JDIM1:JDIM2)
    460      &, TL (IDIM1:IDIM2,JDIM1:JDIM2)
    461                              D I M E N S I O N
    462      & PBOTL(IDIM1:IDIM2,JDIM1:JDIM2), PTOPL(IDIM1:IDIM2,JDIM1:JDIM2)
    463      &,PBOTM(IDIM1:IDIM2,JDIM1:JDIM2), PTOPM(IDIM1:IDIM2,JDIM1:JDIM2)
    464      &,PBOTH(IDIM1:IDIM2,JDIM1:JDIM2), PTOPH(IDIM1:IDIM2,JDIM1:JDIM2)
    465      &,TOT  (IDIM1:IDIM2,JDIM1:JDIM2)
    466                              D I M E N S I O N
    467      & CC(9),PPT(9)
    468                              D I M E N S I O N
    469      &  PINT(IDIM1:IDIM2,LP1),PHALF(LP1),CSTR(IDIM1:IDIM2)
    470      &, EMIS(IDIM1:IDIM2,LP1), TAUC(IDIM1:IDIM2)
    471      &, CVB(IDIM1:IDIM2),CVT(IDIM1:IDIM2),TAUDAR(IDIM1:IDIM2)
    472                              D I M E N S I O N
    473      & CAMT(IDIM1:IDIM2,LP1),NCLDS(IDIM1:IDIM2)

Page 5           Source Listing                  RADTN
2022-02-15 16:37                                 RADTN.F

    474      &,ITYP(IDIM1:IDIM2,LP1),KTOP(IDIM1:IDIM2,LP1)
    475      &,KBTM(IDIM1:IDIM2,LP1),RRCL(IDIM1:IDIM2,NB,LP1)
    476      &,TTCL(IDIM1:IDIM2,NB,LP1),KCLD(IDIM1:IDIM2)
    477 C--------------------CLOUD----------------------------------------------
    478                              D I M E N S I O N                          
    479      & CCR(IDIM1:IDIM2,LM),IW(IDIM1:IDIM2,LM),CSMID(IDIM1:IDIM2,LM)
    480      &,WMID(IDIM1:IDIM2,LM),HMID(IDIM1:IDIM2,LM)
    481      &,BMID(IDIM1:IDIM2),UMID(IDIM1:IDIM2)
    482      &,CCMID(IDIM1:IDIM2,LM)
    483 C--------------------CLOUD----------------------------------------------
    484                              D A T A
    485      1  PLOMD/64200./,PMDHI/35000./,PHITP/15000./,P400/40000./
    486      2, PLBTM/105000./
    487                              D A T A
    488      1  NFILE/14/
    489         DATA CC/0.,0.1,0.2,0.3,0.4,0.5,0.6,0.7,0.8/
    490         DATA PPT/.14,.31,.70,1.6,3.4,7.7,17.,38.,85./
    491 C----------------------------------------------------------------------
    492       UTIM=1.
    493       CNCLD=.TRUE.
    494 C***
    495 C***  ASSIGN THE PRESSURES FOR CLOUD DOMAIN BOUNDARIES
    496 C***
    497         PTOPC(1)=PLBTM
    498         PTOPC(2)=PLOMD
    499         PTOPC(3)=PMDHI
    500         PTOPC(4)=PHITP
    501 C***
    502 C***  FIND THE 'SEA LEVEL PRESSURE'.
    503 C***
    504       DO J=MYJS,MYJE
    505       DO I=MYIS,MYIE
    506         PDSL(I,J)=RES(I,J)*PD(I,J)
    507       ENDDO
    508       ENDDO
    509 C**********************************************************************
    510 C***  THE FOLLOWING CODE IS EXECUTED EACH TIME THE RADIATION IS CALLED.
    511 C**********************************************************************
    512 C----------------------CONVECTION--------------------------------------
    513 C  NRADPP IS THE NUMBER OF TIME STEPS TO ACCUMULATE CONVECTIVE PRECIP
    514 C     FOR RADIATION
    515 C   NOTE: THIS WILL NOT WORK IF NRADS AND NRADL ARE DIFFERENT UNLESS
    516 C         THEY ARE INTEGER MULTIPLES OF EACH OTHER
    517 C  CLSTP IS THE NUMBER OF HOURS OF THE ACCUMULATION PERIOD
    518 C
    519       NTSPH=NINT(3600./DT)
    520       NRADPP=MIN(NRADS,NRADL)
    521       CLSTP=1.0*NRADPP/NTSPH
    522 C----------------------CONVECTION--------------------------------------
    523 C***
    524 C***  STATE WHETHER THE SHORT OR LONGWAVE COMPUTATIONS ARE TO BE DONE.
    525 C***
    526       SHORT=.FALSE.
    527       LONG=.FALSE.
    528       IF(MOD(NTSD,NRADS).EQ.1.OR.RESTRT)SHORT=.TRUE.
    529       IF(MOD(NTSD,NRADL).EQ.1.OR.RESTRT)LONG=.TRUE.
    530       ITIMSW=0

Page 6           Source Listing                  RADTN
2022-02-15 16:37                                 RADTN.F

    531       ITIMLW=0
    532       IF(SHORT)ITIMSW=1
    533       IF(LONG) ITIMLW=1
    534 C-----------------------------------------------------------------------
    535 C***
    536 C***  FLAG FOR RESETTING CUPPT,HTOP,HBOT IN CHKOUT
    537 C***
    538       IF (MOD(NTSD,NRADPP).EQ.1) CURAD=.TRUE.
    539 C***
    540 C***  FIND THE MEAN COSINE OF THE SOLAR ZENITH ANGLE
    541 C***  BETWEEN THE CURRENT TIME AND THE NEXT TIME RADIATION IS
    542 C***  CALLED.  ONLY AVERAGE IF THE SUN IS ABOVE THE HORIZON.
    543 C***
    544       TIME=(NTSD-1)*DT
    545       CALL ZENITH(TIME,DAYI,HOUR)
    546       JD=INT(DAYI+0.50)
    547       ADDL=0.
    548       IF(MOD(IDAT(3),4).EQ.0)ADDL=1.
    549       RANG=PI2*(DAYI-RLAG)/(365.25+ADDL)
    550       RSIN1=SIN(RANG)
    551       RCOS1=COS(RANG)
    552       RCOS2=COS(2.*RANG)
    553       IF(SHORT)THEN
    554 !$omp parallel do private(i,j)
    555         DO J=MYJS,MYJE
    556         DO I=MYIS,MYIE
    557           CZMEAN(I,J)=0.
    558           TOT(I,J)=0.
    559         ENDDO
    560         ENDDO
    561 C
    562         DO II=0,NRADS,NPHS
    563           TIMES=(NTSD-1)*DT+II*DT
    564           CALL ZENITH(TIMES,DAYI,HOUR)
    565 !$omp parallel do private(i,j)
    566           DO J=MYJS,MYJE
    567           DO I=MYIS,MYIE
    568             IF(CZEN(I,J).GT.0.)THEN
    569               CZMEAN(I,J)=CZMEAN(I,J)+CZEN(I,J)
    570               TOT(I,J)=TOT(I,J)+1.
    571             ENDIF
    572           ENDDO
    573           ENDDO
    574         ENDDO
    575 !$omp parallel do private(i,j)
    576         DO J=MYJS,MYJE
    577         DO I=MYIS,MYIE
    578           IF(TOT(I,J).GT.0.)CZMEAN(I,J)=CZMEAN(I,J)/TOT(I,J)
    579         ENDDO
    580         ENDDO
    581       ENDIF
    582 C
    583 C2345678901234567890123456789012345678901234567890123456789012345678901
    584 !$omp parallel do
    585 c!$omp& private (aa,albedo,apes,bb,bcld,bit1,bit2,bitc,bitcp1,bits,
    586 !$omp& private (aa,albdo,apes,bb,bcld,bit1,bit2,bitc,bitcp1,bits,
    587 !$omp&          bitsp1,bitw,bitx,bity,bitz,bmid,btemp1,camt,

Page 7           Source Listing                  RADTN
2022-02-15 16:37                                 RADTN.F

    588 !$omp&          cc1,cc2,ccmid,ccr,cfravg,cl1,cl2,
    589 !$omp&          cldamt,cldcfr,cldmax,clpfil,cosz,cr1,
    590 !$omp&          csmid,cstr,cv,cwmkl,dd,ddp,delp,denom,
    591 !$omp&          dpcl,dthdp,ee,emis,exner,fctra,
    592 !$omp&          fctrb,ff,fiq,fiw,flwdns,flwup,flwups,fswdn,fswdns,
    593 !$omp&          fswup,fswups,gg,hh,hmid,i,icvb,icvt,ir,ityp,
    594 !$omp&          iw,iwkl,j,kbt1,kbt2,kbtm,kcld,kntlyr,
    595 !$omp&          kth1,kth2,ktop,ktop1,l,l400,lbase,lin,ll,
    596 !$omp&          llbot,lltop,lml,ltrop,lvlij,malvl,mbot,mtop,
    597 !$omp&          n,nband,nbtm,nc,ncld,nclds,nktp,nlvl,
    598 !$omp&          nmod,ozn,p1,p2,pdslij,pint,
    599 !$omp&          pmid,pmod,pozn,pp,prs1,prs2,psfc,qc,qi,qint,qkl,
    600 !$omp&          qmid,qsum,qw,rqkl,rrcl,slmsk,snofac,sv,
    601 !$omp&          tauc,taudar,tcld,tendl,tends,thmid,
    602 !$omp&          tkl,tmid,tmt0,tmt15,tskn,ttcl,
    603 !$omp&          u00kl,umid,us,wmid,xlat)
    604 c
    605 C********************************************************************
    606 C***  THIS IS THE BEGINNING OF THE PRIMARY LOOP THROUGH THE DOMAIN
    607 C********************************************************************
    608 C                        *********************
    609                          DO 700 J = MYJS, MYJE
    610 C                        *********************
    611 C
    612       DO 125 L=1,LM
    613       DO I=MYIS,MYIE
    614         IR=IRAD(I)
    615         TMID(I,L)=T(I,J,1)
    616         QMID(I,L)=EPSQ
    617         CSMID(I,L)=0.
    618         WMID(I,L)=0.
    619         CCMID(I,L)=0.
    620         IW(I,L)=0.
    621         CCR(I,L)=0.
    622         HMID(I,L)=0.
    623         OZN(I,L)=EPSO3
    624         TENDS(I,L)=0.
    625         TENDL(I,L)=0.
    626       ENDDO
    627   125 CONTINUE
    628 C
    629       DO 140 N=1,3
    630       DO I=MYIS,MYIE
    631         CLDCFR(I,N)=0.
    632         MTOP(I,N)=0
    633         MBOT(I,N)=0
    634       ENDDO
    635   140 CONTINUE
    636 C***
    637 C***  FILL IN WORKING ARRAYS WHERE VALUES AT L=LM ARE THOSE THAT
    638 C***  ARE ACTUALLY AT ETA LEVEL L=LMH.
    639 C***
    640       DO 200 I=MYIS,MYIE
    641       IR=IRAD(I)
    642       LML=LMH(I,J)
    643       LVLIJ=LVL(I,J)
    644 ctlb  BMID(I)=HBM2(IR,J)

Page 8           Source Listing                  RADTN
2022-02-15 16:37                                 RADTN.F

    645       BMID(I)=HBM2(I,J)
    646       UMID(I)=U00(I,J)
    647 C
    648       DO L=1,LML
    649         PMID(I,L+LVLIJ)=AETA(L)*PDSL(I,J)+PT
    650         PINT(I,L+LVLIJ+1)=ETAD(L+1)*PDSL(I,J)+PT
    651         EXNER=(1.E5/PMID(I,L+LVLIJ))**CAPA
    652         TMID(I,L+LVLIJ)=T(I,J,L)
    653         THMID(I,L+LVLIJ)=T(I,J,L)*EXNER
    654         QMID(I,L+LVLIJ)=Q(I,J,L)
    655         WMID(I,L+LVLIJ)=CWM(I,J,L)
    656         HMID(I,L+LVLIJ)=HTM(I,J,L)
    657       ENDDO
    658 C***
    659 C***  FILL IN ARTIFICIAL VALUES ABOVE THE TOP OF THE DOMAIN.
    660 C***  PRESSURE DEPTHS OF THESE LAYERS IS 1 HPA.
    661 C***  TEMPERATURES ABOVE ARE ALREADY ISOTHERMAL WITH (TRUE) LAYER 1.
    662 C***
    663       IF(LVLIJ.GT.0)THEN
    664         KNTLYR=0
    665 C
    666         DO L=LVLIJ,1,-1
    667           KNTLYR=KNTLYR+1
    668           PMID(I,L)=PT-REAL(2*KNTLYR-1)*0.5*HPINC
    669           PINT(I,L+1)=PMID(I,L)+0.5*HPINC
    670           EXNER=(1.E5/PMID(I,L))**CAPA
    671           THMID(I,L)=TMID(I,L)*EXNER
    672         ENDDO
    673       ENDIF
    674 C
    675       IF(LVLIJ.EQ.0) THEN
    676          PINT(I,1)=PT
    677       ELSE
    678          PINT(I,1)=PMID(I,1)-0.5*HPINC
    679       ENDIF
    680   200 CONTINUE
    681 C***
    682 C***  FILL IN THE SURFACE PRESSURE, SKIN TEMPERATURE, GEODETIC LATITUDE,
    683 C***  ZENITH ANGLE, SEA MASK, AND ALBEDO.  THE SKIN TEMPERATURE IS
    684 C***  NEGATIVE OVER WATER.
    685 C***
    686       DO 250 I=MYIS,MYIE
    687       PSFC(I)=PD(I,J)+PT
    688       APES=(PSFC(I)*1.E-5)**CAPA
    689       TSKN(I)=THS(I,J)*APES*(1.-2.*SM(I,J))
    690       if(mype.eq.13.and.i.eq.40.and.j.eq.77) then
    691         print*,'apes,sm(i,j),ths(i,j)=',apes,sm(i,j),ths(i,j)
    692       endif
    693       SLMSK(I)=SM(I,J)
    694 C
    695 C ----------------------------------------------------------------------
    696 c turn off snow albedo calculation since it is now calculated in SFLX.
    697 c      SNO(I,J)=AMAX1(SNO(I,J),0.)
    698 c      SNOFAC=AMIN1(SNO(I,J)/0.02, 1.0)
    699 c      ALBEDO(I)=ALB(I,J)+(1.0-VEGFRC(I,J))*SNOFAC*(SNOALB-ALB(I,J))
    700       ALBDO(I)=ALBEDO(I,J)
    701 C

Page 9           Source Listing                  RADTN
2022-02-15 16:37                                 RADTN.F

    702       XLAT(I)=GLAT(I,J)*RTD
    703       COSZ(I)=CZMEAN(I,J)
    704   250 CONTINUE
    705 C-----------------------------------------------------------------------
    706 C*******************STRATIFORM CLOUD SECTION***************************
    707 C-----------------------------------------------------------------------
    708 C  CALCULATE STRATIFORM CLOUD COVERAGE AT EACH MODEL GRID POINT WHICH
    709 C  WILL BE USED IN THE MODEL RADIATION PARAMETERIZATION SCHEME.
    710 C-----------------------------------------------------------------------
    711       US=1.                                                             
    712       CCLIMIT=1.0E-3                                                    
    713       CLIMIT =1.0E-20                                                   
    714 C------------------QW, QI AND QINT--------------------------------------
    715       DO 280 I=MYIS,MYIE
    716       LML=LMH(I,J)
    717       LVLIJ=LVL(I,J)
    718 C
    719       DO 275 L=1,LML
    720       LL=L+LVLIJ
    721       HH=HMID(I,LL)*BMID(I)
    722       TKL=TMID(I,LL)                                                   
    723       QKL=QMID(I,LL)                                                   
    724       CWMKL=WMID(I,LL)                                                 
    725       TMT0=(TKL-273.16)*HH                                              
    726       TMT15=AMIN1(TMT0,-15.)*HH                                         
    727       AI=0.008855
    728       BI=1.
    729 C
    730       IF(TMT0.LT.-20.)THEN
    731         AI=0.007225
    732         BI=0.9674
    733       ENDIF 
    734 C
    735       PP=PMID(I,LL)
    736       QW=HH*PQ0/PP*EXP(HH*A2*(TKL-A3)/(TKL-A4))                  
    737       QI=QW*(BI+AI*AMIN1(TMT0,0.))                               
    738       QINT=QW*(1.-0.00032*TMT15*(TMT15+15.))                        
    739       IF(TMT0.LE.-40.) QINT=QI                                    
    740 C-------------------ICE-WATER ID NUMBER IW------------------------------
    741       U00KL=UMID(I)+UL(L)*(0.95-UMID(I))*UTIM
    742       IF(TMT0.LT.-15.0)THEN
    743         FIQ=QKL-U00KL*QI    
    744         IF(FIQ.GT.0..OR.CWMKL.GT.CLIMIT)THEN                    
    745           IW(I,LL)=1                                                 
    746         ELSE                                                           
    747           IW(I,LL)=0                                                 
    748         ENDIF                                                         
    749       ENDIF
    750 C
    751       IF(TMT0.GE.0.)THEN
    752         IW(I,LL)=0                                                    
    753       ENDIF
    754 C
    755       IF(TMT0.LT.0.0.AND.TMT0.GE.-15.0)THEN
    756         IW(I,LL)=0
    757         IF(IW(I,LL-1).EQ.1.AND.CWMKL.GT.CLIMIT) IW(I,LL)=1 
    758       ENDIF

Page 10          Source Listing                  RADTN
2022-02-15 16:37                                 RADTN.F

    759 C
    760       IWKL=IW(I,LL)                                                    
    761 C
    762 C----------------THE SATURATION SPECIFIC HUMIDITY------------------------
    763 C
    764       FIW=FLOAT(IWKL)                                                   
    765       QC=(1.-FIW)*QINT+FIW*QI                                 
    766 C
    767 C----------------THE RELATIVE HUMIDITY----------------------------------
    768 C
    769       IF(QC.LE.EPSQ1.OR.QKL.LE.EPSQ1)THEN  
    770         RQKL=0.
    771       ELSE                                                             
    772         RQKL=QKL/QC                                                 
    773       ENDIF                                                             
    774 C
    775 C----------------CLOUD COVER RATIO CCR----------------------------------
    776 C
    777       IF(RQKL.GE.0.9999)THEN                                      
    778         CCR(I,LL)=AMIN1(US,RQKL) 
    779       ELSE                                                            
    780         ARG=-1000.*CWMKL/(US-RQKL)
    781         ARG=AMAX1(ARG,-25.)
    782         CCR(I,LL)= RQKL*(1.-EXP(ARG))
    783       ENDIF                                                             
    784       CSMID(I,LL)=AMIN1(US,CCR(I,LL))
    785 C----------------------------------------------------------------------
    786   275 CONTINUE
    787   280 CONTINUE
    788 C----------------------------------------------------------------------
    789 C**********************************************************************
    790 C NOW CHECK THE CLOUDS PRODUCED ABOVE TO MAKE SURE THEY ARE GOOD
    791 C ENOUGH FOR RADIATION CALCULATIONS
    792 C**********************************************************************
    793 C***
    794 C***  NO STRATIFORM CLOUDS FOR THIS TYPE
    795 C***
    796       DO 350 I=MYIS,MYIE
    797 C
    798       LML=LMH(I,J)
    799       LVLIJ=LVL(I,J)
    800 C***
    801 C***  ZERO OUT CLDAMT IF LAND AND BELOW PBOT ABOVE GROUND
    802 C***
    803       IF(SM(I,J).LT.0.5)THEN
    804         DO L=1,LML
    805           LL=LML-L+1+LVLIJ
    806           DDP=PSFC(I)-PMID(I,LL)
    807           IF(DDP.GE.PBOT) GO TO 290
    808           CSMID(I,LL)=0.
    809         ENDDO
    810   290   CONTINUE
    811       ENDIF
    812 C***
    813 C***  CHECK FOR OCEAN STRATUS (LOW CLOUD)
    814 C***  LOOK ONLY OVER OCEAN AND ONLY IF AN INVERSION (DTHDP.LE.-0.05)
    815 C***  IS PRESENT WITH AT LEAST 2 CLOUD FREE LAYERS ABOVE IT

Page 11          Source Listing                  RADTN
2022-02-15 16:37                                 RADTN.F

    816 C***
    817       IF(SM(I,J).GT.0.5)THEN
    818 C
    819 C***  FIND BASE OF INVERSION
    820 C
    821         LBASE=LM
    822         DO L=1,LML-1
    823           LL=LML-L+1+LVLIJ
    824           DTHDP=(THMID(I,LL-1)-THMID(I,LL))
    825      &          /(PMID(I,LL-1)-PMID(I,LL))
    826           IF(DTHDP.LE.CLAPSE)THEN
    827             LBASE=LL
    828             GO TO 300
    829           ENDIF
    830         ENDDO
    831   300   CONTINUE
    832 C
    833 C***  CHECK 2 LAYERS ABOVE LBASE FOR DRYNESS
    834 C
    835         IF(CSMID(I,LBASE-1).LE.0..AND.CSMID(I,LBASE-2).LE.0.
    836      1                               .AND.LBASE.LT.LM)THEN
    837           IF(DTHDP.GT.CLPSE)THEN
    838             CLPFIL=1.-((CLPSE-DTHDP)/DCLPS)
    839           ELSE
    840             CLPFIL=1.
    841           ENDIF
    842 C
    843           DO L=1,LML
    844             LL=LML-L+1+LVLIJ
    845             DDP=PSFC(I)-PMID(I,LL)
    846             IF(DDP.GE.PBOT) GO TO 310
    847             CSMID(I,LL)=CSMID(I,LL)*CLPFIL
    848           ENDDO
    849   310     CONTINUE
    850 C
    851 C***  IF NO INVERSION OR IF CLDS EXIST IN EITHER OF THE 2 LAYERS ABOVE
    852 C***  INVERSION, ZERO OUT CLOUD BELOW PBOT
    853 C
    854         ELSE
    855           DO L=1,LML
    856             LL=LML-L+1+LVLIJ
    857             DDP=PSFC(I)-PMID(I,LL)
    858             IF(DDP.GE.PBOT) GO TO 320
    859             CSMID(I,LL)=0.
    860           ENDDO
    861   320     CONTINUE
    862 C
    863         ENDIF
    864 C------------
    865       ENDIF
    866 C------------
    867 C***
    868 C***  REMOVE HIGH CLOUDS ABOVE THE TROPOPAUSE
    869 C***
    870       L400=LM
    871       DO L=1,LML
    872         LL=LML-L+1+LVLIJ

Page 12          Source Listing                  RADTN
2022-02-15 16:37                                 RADTN.F

    873         IF(PMID(I,LL).LE.40000.0)THEN
    874           L400=LL
    875           GO TO 330
    876         ENDIF
    877       ENDDO
    878   330 CONTINUE
    879 C
    880       LTROP=LM
    881       DO LL=L400,2,-1
    882         DTHDP=(THMID(I,LL-1)-THMID(I,LL))
    883      1         /(PMID(I,LL-1)-PMID(I,LL))
    884 C
    885         IF(DTHDP.LT.-0.0025.OR.QMID(I,LL).LE.EPSQ1)THEN
    886           LTROP=LL
    887           GOTO 340
    888         ENDIF
    889       ENDDO
    890   340 IF(LTROP.LT.LM)THEN
    891         DO LL=LTROP,1,-1
    892           CSMID(I,LL)=0.
    893         ENDDO
    894       ENDIF
    895   350 CONTINUE
    896 C
    897 C*********************************************************************
    898 C*****************END OF STRATIFORM CLOUD SECTION*****************
    899 C------------------------CONVECTION--------------------------------
    900 C***
    901 C***  CONVECTIVE CLOUD SECTION
    902 C***
    903 C*** THIS PART WAS MODIFIED TO COMPUTE CONVECTIVE CLOUDS AT EACH
    904 C*** MODEL LAYER BASED ON CONVECTIVE PRECIPITATION RATES. CURRENTLY,
    905 C*** CLOUDS ARE SET TO 0.75*CV(I) BELOW 400MB
    906 C*** AND    0.90*CV(I) ABOVE 400MB TO ACCOUNT FOR CIRRUS CAP
    907 C***                                       Q.ZHAO   95-3-22
    908 C
    909 C***
    910 C*** NON-PRECIPITATING CLOUD FRACTION OF 20 PERCENT IS ADDED AT
    911 C*** AT POINTS WHERE THE SHALLOW AND DEEP CONVECTIONS ACCUR.
    912 C***                                        Q. ZHAO  97-5-2
    913 C
    914 C   COMPUTE THE CONVECTIVE CLOUD COVER FOR RADIATION
    915 C
    916 C-----------------------------------------------------------------
    917       IF(CNCLD)THEN
    918 C-----------------------------------------------------------------
    919         DO 375 I=MYIS,MYIE
    920         IF(HBOT(I,J)-HTOP(I,J).GT.1.0)THEN
    921 C       IF(HTOP(I,J).LT.HBOT(I,J))THEN
    922           SV(I)=0.0
    923         ELSE
    924           SV(I)=0.0
    925         ENDIF
    926 C
    927         PMOD=CUPPT(I,J)*24.0*1000.0/CLSTP
    928         NMOD=0
    929 C

Page 13          Source Listing                  RADTN
2022-02-15 16:37                                 RADTN.F

    930         DO NC=1,9
    931           IF(PMOD.GT.PPT(NC)) NMOD=NC
    932         ENDDO
    933 C
    934 C***  CLOUD TOPS AND BOTTOMS COME FROM CUCNVC
    935 C***  ADD LVL TO BE CONSISTENT WITH OTHER WORKING ARRAYS
    936 C
    937         IF(NMOD.EQ.0)THEN
    938           CV(I)=0.
    939         ELSEIF(NMOD.EQ.9)THEN
    940           CV(I)=CC(9)
    941         ELSE
    942           CC1=CC(NMOD)
    943           CC2=CC(NMOD+1)
    944           P1=PPT(NMOD)
    945           P2=PPT(NMOD+1)
    946           CV(I)=CC1+(CC2-CC1)*(PMOD-P1)/(P2-P1)
    947         ENDIF
    948 C
    949         CV(I)=AMAX1(SV(I),CV(I))
    950         CV(I)=AMIN1(1.0,CV(I))
    951 C
    952         IF(CV(I).EQ.0.0)THEN
    953           ICVT(I)=0
    954           ICVB(I)=0
    955         ELSE
    956           ICVT(I)=INT(HTOP(I,J)+0.50)+LVL(I,J)
    957           ICVB(I)=INT(HBOT(I,J)+0.50)+LVL(I,J)
    958         ENDIF
    959   375   CONTINUE
    960 C***
    961 C***  MAKE SURE CLOUDS ARE DEEP ENOUGH
    962 C***
    963         DO I=MYIS,MYIE
    964           BCLD(I)=CV(I).GT.0..AND.
    965      1           (ICVB(I)-ICVT(I)).GE.1
    966           BTEMP1(I)=BCLD(I)
    967         ENDDO
    968 C***
    969 C*** COMPUTE CONVECTIVE CLOUD FRACTION
    970 C***
    971         DO 390 I=MYIS,MYIE
    972         IF(BCLD(I)) THEN
    973           LML=LMH(I,J)
    974           LVLIJ=LVL(I,J)
    975 C
    976           DO L=1,LML
    977             LL=L+LVLIJ
    978             IF(LL.GT.ICVB(I).OR.LL.LT.ICVT(I))THEN
    979               CCMID(I,LL)=0.
    980             ELSE
    981               CCMID(I,LL)=CV(I)
    982             ENDIF
    983             CCMID(I,LL)=AMIN1(1.0,CCMID(I,LL))
    984           ENDDO
    985         ENDIF
    986   390   CONTINUE

Page 14          Source Listing                  RADTN
2022-02-15 16:37                                 RADTN.F

    987 C***
    988 C***  REMOVE HIGH CLOUDS ABOVE THE TROPOPAUSE
    989 C***
    990         L400=LM
    991         DO 425 I=MYIS,MYIE
    992         LML=LMH(I,J)
    993         LVLIJ=LVL(I,J)
    994 C
    995         DO L = 1, LML
    996           LL=LML-L+1+LVLIJ
    997           IF(PMID(I,LL).LE.40000.0)THEN
    998             L400=LL
    999             GO TO 400
   1000           ENDIF
   1001         ENDDO
   1002   400   CONTINUE
   1003 C
   1004         LTROP=LM
   1005         DO LL=L400,2,-1
   1006           DTHDP=(THMID(I,LL-1)-THMID(I,LL))
   1007      1         /(PMID(I,LL-1)-PMID(I,LL))
   1008           IF(DTHDP.LT.-0.0025.OR.QMID(I,LL).LE.EPSQ1)THEN
   1009             LTROP=LL
   1010             GOTO 410
   1011           ENDIF
   1012         ENDDO
   1013   410   IF(LTROP.LT.LM)THEN
   1014          DO LL=LTROP,1,-1
   1015            CCMID(I,LL)=0.
   1016          ENDDO
   1017         ENDIF
   1018   425   CONTINUE
   1019 C***
   1020 C-----------------------------------------------------------------
   1021       ENDIF
   1022 C------------------------CONVECTION--------------------------------
   1023 C*****************END OF CONVECTIVE CLOUD SECTION*****************
   1024 C*********************************************************************
   1025 C***
   1026 C***  DETERMINE THE FRACTIONAL CLOUD COVERAGE FOR HIGH, MID
   1027 C***  AND LOW OF CLOUDS FROM THE CLOUD COVERAGE AT EACH LEVEL
   1028 C***
   1029 C***  NOTE: THIS IS FOR DIAGNOSTICS ONLY!!!
   1030 C***
   1031 C***
   1032       DO 500 I=MYIS,MYIE
   1033 C
   1034       CSTR(I)=0.0
   1035 C
   1036       DO L=0,LM
   1037         CLDAMT(L)=0.
   1038       ENDDO
   1039 C
   1040 C***  NOW GOES LOW, MIDDLE, HIGH
   1041 C
   1042       DO 480 NLVL=1,3
   1043       CLDMAX=0.

Page 15          Source Listing                  RADTN
2022-02-15 16:37                                 RADTN.F

   1044       MALVL=LM
   1045       LLTOP=LTOP(NLVL)+LVL(I,J)
   1046 C***
   1047 C***  GO TO THE NEXT CLOUD LAYER IF THE TOP OF THE CLOUD-TYPE IN
   1048 C***  QUESTION IS BELOW GROUND OR IS IN THE LOWEST LAYER ABOVE GROUND.
   1049 C***
   1050       IF(LLTOP.GE.LM)GO TO 480
   1051 C
   1052       IF(NLVL.GT.1)THEN
   1053         LLBOT=LTOP(NLVL-1)-1+LVL(I,J)
   1054         LLBOT=MIN(LLBOT,LM1)
   1055       ELSE
   1056         LLBOT=LM1
   1057       ENDIF
   1058 C
   1059       DO 435 L=LLTOP,LLBOT
   1060       CLDAMT(L)=AMAX1(CSMID(I,L),CCMID(I,L))
   1061       IF(CLDAMT(L).GT.CLDMAX)THEN
   1062         MALVL=L
   1063         CLDMAX=CLDAMT(L)
   1064       ENDIF
   1065   435 CONTINUE
   1066 C*********************************************************************
   1067 C NOW, CALCULATE THE TOTAL CLOUD FRACTION IN THIS PRESSURE DOMAIN
   1068 C USING THE METHOD DEVELOPED BY Y.H., K.A.C. AND A.K. (NOV., 1992).
   1069 C IN THIS METHOD, IT IS ASSUMED THAT SEPERATED CLOUD LAYERS ARE
   1070 C RADOMLY OVERLAPPED AND ADJACENT CLOUD LAYERS ARE MAXIMUM OVERLAPPED.
   1071 C VERTICAL LOCATION OF EACH TYPE OF CLOUD IS DETERMINED BY THE THICKEST
   1072 C CONTINUING CLOUD LAYERS IN THE DOMAIN.
   1073 C*********************************************************************
   1074       CL1=0.0
   1075       CL2=0.0
   1076       KBT1=LLBOT
   1077       KBT2=LLBOT
   1078       KTH1=0
   1079       KTH2=0
   1080 C
   1081       DO 450 LL=LLTOP,LLBOT
   1082       L=LLBOT-LL+LLTOP
   1083       BIT1=.FALSE.
   1084       CR1=CLDAMT(L)
   1085       BITX=(PINT(I,L).GE.PTOPC(NLVL+1)).AND.
   1086      1     (PINT(I,L).LT.PTOPC(NLVL)).AND.
   1087      2     (CLDAMT(L).GT.0.0)
   1088       BIT1=BIT1.OR.BITX
   1089       IF(.NOT.BIT1)GO TO 450
   1090 C***
   1091 C***  BITY=T: FIRST CLOUD LAYER; BITZ=T:CONSECUTIVE CLOUD LAYER
   1092 C***  NOTE:  WE ASSUME THAT THE THICKNESS OF EACH CLOUD LAYER IN THE
   1093 C***         DOMAIN IS LESS THAN 200 MB TO AVOID TOO MUCH COOLING OR
   1094 C***         HEATING. SO WE SET CTHK(NLVL)=200*E2. BUT THIS LIMIT MAY
   1095 C***         WORK WELL FOR CONVECTIVE CLOUDS. MODIFICATION MAY BE
   1096 C***         NEEDED IN THE FUTURE.
   1097 C***
   1098       BITY=BITX.AND.(KTH2.LE.0)
   1099       BITZ=BITX.AND.(KTH2.GT.0)
   1100 C

Page 16          Source Listing                  RADTN
2022-02-15 16:37                                 RADTN.F

   1101       IF(BITY)THEN
   1102         KBT2=L
   1103         KTH2=1
   1104       ENDIF
   1105 C
   1106       IF(BITZ)THEN
   1107         KTOP1=KBT2-KTH2+1
   1108         DPCL=PMID(I,KBT2)-PMID(I,KTOP1)
   1109         IF(DPCL.LT.CTHK(NLVL))THEN
   1110           KTH2=KTH2+1
   1111         ELSE
   1112           KBT2=KBT2-1
   1113         ENDIF
   1114       ENDIF
   1115       IF(BITX)CL2=AMAX1(CL2,CR1)
   1116 C***
   1117 C*** AT THE DOMAIN BOUNDARY OR SEPARATED CLD LAYERS, RANDOM OVERLAP.
   1118 C*** CHOOSE THE THICKEST OR THE LARGEST FRACTION AMT AS THE CLD
   1119 C*** LAYER IN THAT DOMAIN.
   1120 C***
   1121       BIT2=.FALSE.
   1122       BITY=BITX.AND.(CLDAMT(L-1).LE.0.0.OR.
   1123      1     PINT(I,L-1).LT.PTOPC(NLVL+1))
   1124       BITZ=BITY.AND.CL1.GT.0.0
   1125       BITW=BITY.AND.CL1.LE.0.0
   1126       BIT2=BIT2.OR.BITY
   1127       IF(.NOT.BIT2)GO TO 450
   1128 C
   1129       IF(BITZ)THEN
   1130         KBT1=INT((CL1*KBT1+CL2*KBT2)/(CL1+CL2))
   1131         KTH1=INT((CL1*KTH1+CL2*KTH2)/(CL1+CL2))+1
   1132         CL1=CL1+CL2-CL1*CL2
   1133       ENDIF
   1134 C
   1135       IF(BITW)THEN
   1136         KBT1=KBT2
   1137         KTH1=KTH2
   1138         CL1=CL2
   1139       ENDIF
   1140 C
   1141       IF(BITY)THEN
   1142         KBT2=LLBOT
   1143         KTH2=0
   1144         CL2=0.0
   1145       ENDIF
   1146   450 CONTINUE
   1147 C***
   1148       CLDCFR(I,NLVL)=AMIN1(1.0,CL1)
   1149       MTOP(I,NLVL)=MIN(KBT1,KBT1-KTH1+1)
   1150       MBOT(I,NLVL)=KBT1
   1151   480 CONTINUE
   1152   500 CONTINUE
   1153 C***
   1154 C***  SET THE UN-NEEDED TAUDAR TO ONE
   1155 C***
   1156       DO I=MYIS,MYIE
   1157         TAUDAR(I)=1.0

Page 17          Source Listing                  RADTN
2022-02-15 16:37                                 RADTN.F

   1158       ENDDO
   1159 C----------------------------------------------------------------------
   1160 C NOW, CALCULATE THE CLOUD RADIATIVE PROPERTIES AFTER DAVIS (1982),
   1161 C HARSHVARDHAN ET AL (1987) AND Y.H., K.A.C. AND A.K. (1993).
   1162 C
   1163 C UPDATE: THE FOLLOWING PARTS ARE MODIFIED, AFTER Y.T.H. (1994), TO
   1164 C         CALCULATE THE RADIATIVE PROPERTIES OF CLOUDS ON EACH MODEL
   1165 C         LAYER. BOTH CONVECTIVE AND STRATIFORM CLOUDS ARE USED
   1166 C         IN THIS CALCULATIONS.
   1167 C
   1168 C                                     QINGYUN ZHAO   95-3-22
   1169 C
   1170 C----------------------------------------------------------------------
   1171 C
   1172 C***
   1173 C*** INITIALIZE ARRAYS FOR USES LATER
   1174 C***
   1175 
   1176       DO 600 I=MYIS,MYIE
   1177       LML=LMH(I,J)
   1178       LVLIJ=LVL(I,J)
   1179 C
   1180 C***
   1181 C*** NOTE: LAYER=1 IS THE SURFACE, AND LAYER=2 IS THE FIRST CLOUD
   1182 C***       LAYER ABOVE THE SURFACE AND SO ON.
   1183 C***
   1184       EMIS(I,1)=1.0
   1185       KTOP(I,1)=LP1
   1186       KBTM(I,1)=LP1
   1187       CAMT(I,1)=1.0
   1188       ITYP(I,1)=0
   1189       KCLD(I)=2
   1190 C
   1191       DO NBAND=1,NB
   1192         RRCL(I,NBAND,1)=0.0
   1193         TTCL(I,NBAND,1)=1.0
   1194       ENDDO
   1195 C
   1196       DO 510 L=2,LP1
   1197       ITYP(I,L)=0
   1198       CAMT(I,L)=0.0
   1199       KTOP(I,L)=1
   1200       KBTM(I,L)=1
   1201       EMIS(I,L)=0.0
   1202 C
   1203       DO NBAND=1,NB
   1204         RRCL(I,NBAND,L)=0.0
   1205         TTCL(I,NBAND,L)=1.0
   1206       ENDDO
   1207   510 CONTINUE
   1208 C***
   1209 C*** NOW CALCULATE THE AMOUNT, TOP, BOTTOM AND TYPE OF EACH CLOUD LAYER
   1210 C*** CLOUD TYPE=1: STRATIFORM CLOUD
   1211 C***       TYPE=2: CONVECTIVE CLOUD
   1212 C*** WHEN BOTH CONVECTIVE AND STRATIFORM CLOUDS EXIST AT THE SAME POINT,
   1213 C*** SELECT CONVECTIVE CLOUD (TYPE=2),IN OTHER WORDS, CONVECTIVE CLOUDS
   1214 C*** HAVE THE HIGHER PRIORITY THAN STRATIFORM CLOUDS.

Page 18          Source Listing                  RADTN
2022-02-15 16:37                                 RADTN.F

   1215 C*** CLOUD LAYERS ARE SEPARATED BY:
   1216 C***       1. NO-CLOUD LAYER
   1217 C***       2. DIFFERENT CLOUD TYPE
   1218 C*** NOTE: THERE IS ONLY ONE CONVECTIVE CLOUD LAYER IN ONE COLUMN.
   1219 C*** KTOP AND KBTM ARE THE TOP AND BOTTOM OF EACH CLOUD LAYER IN TERMS O
   1220 C*** ETA MODEL LEVEL.
   1221 C***
   1222       DO 540 L=2,LML
   1223       LL=LML-L+1+LVLIJ
   1224       BITC=CCMID(I,LL).GT.0.1
   1225       BITS=CSMID(I,LL).GT.0.1
   1226       BITCP1=CCMID(I,LL+1).GT.0.1
   1227       BITSP1=CSMID(I,LL+1).GT.0.1
   1228       BIT1=BITS.OR.BITC
   1229 C-------------------
   1230       IF(BIT1)THEN
   1231 C-------------------
   1232         IF(ITYP(I,KCLD(I)).EQ.0)THEN
   1233           CAMT(I,KCLD(I))=CSMID(I,LL)
   1234           ITYP(I,KCLD(I))=1
   1235           KBTM(I,KCLD(I))=LL
   1236 C
   1237           IF(BITC)THEN
   1238             CAMT(I,KCLD(I))=CCMID(I,LL)
   1239             ITYP(I,KCLD(I))=2
   1240           ENDIF 
   1241         ELSE
   1242           IF(BITC)THEN
   1243             IF(BITCP1)THEN
   1244               CAMT(I,KCLD(I))=AMAX1(CAMT(I,KCLD(I)),CCMID(I,LL))
   1245             ELSE
   1246               KCLD(I)=KCLD(I)+1
   1247               CAMT(I,KCLD(I))=CCMID(I,LL)
   1248               ITYP(I,KCLD(I))=2
   1249               KTOP(I,KCLD(I)-1)=LL+1
   1250               KBTM(I,KCLD(I))=LL
   1251             ENDIF
   1252           ELSE
   1253             IF(BITCP1)THEN
   1254               KCLD(I)=KCLD(I)+1
   1255               CAMT(I,KCLD(I))=CSMID(I,LL)
   1256               ITYP(I,KCLD(I))=1
   1257               KTOP(I,KCLD(I)-1)=LL+1
   1258               KBTM(I,KCLD(I))=LL
   1259             ELSE
   1260               CAMT(I,KCLD(I))=AMAX1(CAMT(I,KCLD(I)),CSMID(I,LL))
   1261             ENDIF
   1262           ENDIF 
   1263         ENDIF 
   1264 C-------------------
   1265       ELSE
   1266 C-------------------
   1267         IF(BITCP1.OR.BITSP1)THEN
   1268           KCLD(I)=KCLD(I)+1
   1269           KTOP(I,KCLD(I)-1)=LL+1
   1270           ITYP(I,KCLD(I))=0
   1271           CAMT(I,KCLD(I))=0.0

Page 19          Source Listing                  RADTN
2022-02-15 16:37                                 RADTN.F

   1272         ENDIF
   1273 C-------------------
   1274       ENDIF
   1275 C-------------------
   1276   540 CONTINUE
   1277 C***
   1278 C*** THE REAL NUMBER OF CLOUD LAYERS IS (THE FIRST IS THE GROUNG;
   1279 C*** THE LAST IS THE SKY):
   1280 C***
   1281       NCLDS(I)=KCLD(I)-2
   1282       NCLD=NCLDS(I)
   1283 C***
   1284 C***  NOW CALCULATE CLOUD RADIATIVE PROPERTIES
   1285 C***
   1286       IF(NCLD.GE.1)THEN
   1287 C***
   1288 C*** NOTE: THE FOLLOWING CALCULATIONS, THE UNIT FOR PRESSURE IS MB!!!
   1289 C***
   1290         DO 580 NC=2,NCLD+1
   1291 C
   1292         TAUC(I)=0.0
   1293         QSUM=0.0
   1294         NKTP=LP1
   1295         NBTM=0
   1296         BITX=CAMT(I,NC).GT.0.1
   1297         NKTP=MIN(NKTP,KTOP(I,NC))
   1298         NBTM=MAX(NBTM,KBTM(I,NC))
   1299 C
   1300         DO 560 LL=NKTP,NBTM
   1301         IF(LL.GE.KTOP(I,NC).AND.LL.LE.KBTM(I,NC).AND.BITX)THEN
   1302           PRS1=PINT(I,LL)*0.01
   1303           PRS2=PINT(I,LL+1)*0.01
   1304           DELP=PRS2-PRS1
   1305           TCLD=TMID(I,LL)-273.16
   1306           QSUM=QSUM+QMID(I,LL)*DELP*(PRS1+PRS2)
   1307      1         /(120.1612*SQRT(TMID(I,LL)))
   1308 C***
   1309 C*** FOR CONVECTIVE CLOUD OR STARTIFORM CLOUD WITH TOP ABOVE 500MB
   1310 C***
   1311           IF(ITYP(I,NC).EQ.2
   1312      1           .OR.PINT(I,KTOP(I,NC)).LE.PTOPC(3))THEN
   1313             IF(TCLD.LE.-10.0)THEN
   1314               TAUC(I)=TAUC(I)+DELP*AMAX1(0.1E-3,
   1315      1                 2.0E-6*(TCLD+82.5)**2)
   1316             ELSE
   1317 	      TAUC(I)=TAUC(I)+DELP*AMIN1(0.08,6.949E-3*TCLD+0.1)
   1318             ENDIF
   1319           ELSE
   1320 C***
   1321 C***  FOR LOW AND MID STRATIFORM CLOUDS
   1322 C***
   1323             IF(TCLD.LE.-20.0)THEN
   1324               TAUC(I)=TAUC(I)+DELP*AMAX1(0.1E-3,2.56E-5*
   1325      1               (TCLD+82.5)**2)
   1326             ELSE
   1327               TAUC(I)=TAUC(I)+DELP*0.1
   1328             ENDIF

Page 20          Source Listing                  RADTN
2022-02-15 16:37                                 RADTN.F

   1329           ENDIF
   1330         ENDIF
   1331   560   CONTINUE
   1332 C
   1333         IF(BITX)EMIS(I,NC)=1.0-EXP(-0.75*TAUC(I))
   1334         IF(QSUM.GE.EPSQ1)THEN
   1335 C
   1336           DO 570 NBAND=1,NB
   1337           IF(BITX)THEN
   1338             PROD=ABCFF(NBAND)*QSUM
   1339             DDX=TAUC(I)/(TAUC(I)+PROD)
   1340             EEX=1.0-DDX
   1341             IF(ABS(EEX).GE.1.E-8)THEN
   1342               DD=DDX
   1343               EE=EEX
   1344               FF=1.0-DD*0.85
   1345               AA=MIN(50.0,SQRT(3.0*EE*FF)*TAUC(I))
   1346               AA=EXP(-AA)
   1347               BB=FF/EE
   1348               GG=SQRT(BB)
   1349               DD=(GG+1.0)*(GG+1.0)-(GG-1.0)*(GG-1.0)*AA*AA
   1350               RRCL(I,NBAND,NC)=MAX(0.1E-5,(BB-1.0)*(1.0-AA*AA)/DD)
   1351               TTCL(I,NBAND,NC)=AMAX1(0.1E-5,4.0*GG*AA/DD)
   1352             ENDIF
   1353           ENDIF
   1354   570     CONTINUE
   1355         ENDIF
   1356   580   CONTINUE
   1357 C
   1358       ENDIF
   1359 C
   1360   600 CONTINUE
   1361 C*********************************************************************
   1362 C******************  COMPUTE OZONE AT MIDLAYERS  *********************
   1363 C*********************************************************************
   1364 C
   1365 C***  MODIFY PRESSURES SO THAT THE ENTIRE COLUMN OF OZONE (TO 0 MB)
   1366 C***  IS INCLUDED IN THE MODEL COLUMN EVEN WHEN PT > 0 MB
   1367 C***
   1368       DO L=1,LM
   1369       DO I=MYIS,MYIE
   1370         DENOM=1./(PINT(I,LP1)-PINT(I,1))
   1371         FCTRA=PINT(I,LP1)*DENOM
   1372         FCTRB=-PINT(I,1)*PINT(I,LP1)*DENOM
   1373         POZN(I,L)=PMID(I,L)*FCTRA+FCTRB
   1374       ENDDO
   1375       ENDDO
   1376 C
   1377       CALL OZON2D(LM,POZN,XLAT,RSIN1,RCOS1,RCOS2,OZN)
   1378 C
   1379 C***
   1380 C***  NOW THE VARIABLES REQUIRED BY RADFS HAVE BEEN CALCULATED.
   1381 C***
   1382 C----------------------------------------------------------------------
   1383 C***
   1384 C***  CALL THE GFDL RADIATION DRIVER
   1385 C***

Page 21          Source Listing                  RADTN
2022-02-15 16:37                                 RADTN.F

   1386 C***
   1387       CALL RADFS
   1388 c     1     (PSFC,PMID,PINT,QMID,TMID,OZN,TSKN,SLMSK,ALBEDO,XLAT
   1389      1     (PSFC,PMID,PINT,QMID,TMID,OZN,TSKN,SLMSK,ALBDO,XLAT
   1390      2,     CAMT,ITYP,KTOP,KBTM,NCLDS,EMIS,RRCL,TTCL 
   1391      3,     COSZ,TAUDAR,1
   1392      4,     1,0 
   1393      5,     ETAD,AETA,ITIMSW,ITIMLW,JD,R1,HOUR,TENDS,TENDL
   1394      6,     FLWUP,FSWUP,FSWDN,FSWDNS,FSWUPS,FLWDNS,FLWUPS)
   1395 C----------------------------------------------------------------------
   1396       DO 650 I=MYIS,MYIE
   1397       PDSLIJ=PDSL(I,J)
   1398       PMOD=CUPPT(I,J)*24.0*1000.0/CLSTP
   1399       CFRACL(I,J)=CLDCFR(I,1)
   1400       CFRACM(I,J)=CLDCFR(I,2)
   1401       CFRACH(I,J)=CLDCFR(I,3)
   1402 C
   1403 C***  ARRAYS ACFRST AND ACFRCV ACCUMULATE AVERAGE STRATIFORM AND
   1404 C***  CONVECTIVE CLOUD FRACTIONS, RESPECTIVELY.  THIS INFORMATION
   1405 C***  IS PASSED TO THE POST PROCESSOR VIA COMMON BLOCK ACMCLD.
   1406 C
   1407       CFRAVG=AMAX1(CFRACL(I,J),AMAX1(CFRACM(I,J),CFRACH(I,J)))
   1408       IF(CNCLD)THEN
   1409         IF(PMOD.LE.PPT(1))THEN
   1410           ACFRST(I,J)=ACFRST(I,J)+CFRAVG
   1411           NCFRST(I,J)=NCFRST(I,J)+1
   1412         ELSE
   1413           ACFRCV(I,J)=ACFRCV(I,J)+CFRAVG
   1414           NCFRCV(I,J)=NCFRCV(I,J)+1
   1415         ENDIF
   1416       ELSE
   1417         ACFRST(I,J)=ACFRST(I,J)+CFRAVG
   1418         NCFRST(I,J)=NCFRST(I,J)+1
   1419       ENDIF
   1420   650 CONTINUE
   1421 C***
   1422 C***  COLLECT ATMOSPHERIC TEMPERATURE TENDENCIES DUE TO RADIATION.
   1423 C***  ALSO COLLECT THE TOTAL SW AND INCOMING LW RADIATION (W/M**2)
   1424 C***  AND CONVERT TO FORM NEEDED FOR PREDICTION OF THS IN SURFCE.
   1425 C***
   1426       DO 660 I=MYIS,MYIE
   1427       DO L=1,LM
   1428         LL=LVL(I,J)+L
   1429         IF(SHORT)RSWTT(I,J,L)=TENDS(I,LL)
   1430         IF(LONG) RLWTT(I,J,L)=TENDL(I,LL)
   1431 c       if(mype.eq.13.and.i.eq.40.and.j.eq.77) then
   1432 c        print*,'l,ll,tendl(i,ll),rlwtt(i,j,l)=',
   1433 c    *    l,ll,tendl(i,ll),rlwtt(i,j,l)
   1434 c       endif
   1435         IF(LL.EQ.LM)GO TO 660
   1436       ENDDO
   1437   660 CONTINUE
   1438 C***
   1439 C***  SUM THE LW INCOMING AND SW RADIATION (W/M**2) FOR RADIN.
   1440 C***
   1441       DO 675 I=MYIS,MYIE
   1442       IF(LONG)THEN

Page 22          Source Listing                  RADTN
2022-02-15 16:37                                 RADTN.F

   1443         SIGT4(I,J)=STBOL*TMID(I,LM)*TMID(I,LM)*
   1444      1             TMID(I,LM)*TMID(I,LM)
   1445       ENDIF
   1446 C
   1447 C***  ACCUMULATE VARIOUS LW AND SW RADIATIVE FLUXES FOR POST
   1448 C***  PROCESSOR.  PASSED VIA COMMON ACMRDL AND ACMRDS.
   1449 C
   1450       IF(LONG)THEN
   1451         RLWIN(I,J) =FLWDNS(I)
   1452         RLWOUT(I,J)=FLWUPS(I)
   1453         RLWTOA(I,J)=FLWUP(I)
   1454       ENDIF
   1455       IF(SHORT)THEN
   1456         RSWIN(I,J) =FSWDNS(I)
   1457         RSWOUT(I,J)=FSWUPS(I)
   1458         RSWTOA(I,J)=FSWUP(I)
   1459       ENDIF
   1460   675 CONTINUE
   1461 C***
   1462 C***  THIS ROW IS FINISHED. GO TO NEXT
   1463 C***
   1464 C                        *********************
   1465   700                          CONTINUE
   1466 C                        *********************
   1467 C----------------------------------------------------------------------
   1468 C***
   1469 C***  CALLS TO RADIATION THIS TIME STEP ARE COMPLETE.
   1470 C***
   1471 C----------------------------------------------------------------------
   1472 C----------------------------------------------------------------------
   1473 C***
   1474 C***  HORIZONTAL SMOOTHING OF TEMPERATURE TENDENCIES
   1475 C***
   1476 C----------------------------------------------------------------------
   1477       IF(SHORT) THEN
   1478         DO 800 L=1,LM
   1479         CALL ZERO2(TL)
   1480         CALL ZERO2(FNE)
   1481         CALL ZERO2(FSE)
   1482 C
   1483         IF(KSMUD.GE.1)THEN
   1484           DO 750 KS=1,KSMUD
   1485 C
   1486           DO J=MYJS,MYJE
   1487           DO I=MYIS,MYIE
   1488             TL(I,J)=RSWTT(I,J,L)*HTM(I,J,L)
   1489           ENDDO
   1490           ENDDO
   1491 C
   1492           DO J=MYJS,MYJE
   1493           DO I=MYIS,MYIE
   1494             FNE(I,J)=(TL(I+IHE(J),J+1)-TL(I,J))
   1495      1               *HTM(I,J,L)*HTM(I+IHE(J),J+1,L)
   1496           ENDDO
   1497           ENDDO
   1498 C
   1499           DO J=MYJS1,MYJE

Page 23          Source Listing                  RADTN
2022-02-15 16:37                                 RADTN.F

   1500           DO I=MYIS,MYIE
   1501             FSE(I,J)=(TL(I+IHE(J),J-1)-TL(I,J))
   1502      1               *HTM(I+IHE(J),J-1,L)*HTM(I,J,L)
   1503           ENDDO
   1504           ENDDO
   1505 C
   1506           DO J=MYJS2,MYJE2
   1507           DO I=MYIS,MYIE
   1508             TL(I,J)=(FNE(I,J)-FNE(I+IHW(J),J-1)
   1509      1              +FSE(I,J)-FSE(I+IHW(J),J+1))
   1510      2              *HBM2(I,J)*0.125+TL(I,J)
   1511           ENDDO
   1512           ENDDO
   1513 C
   1514           DO J=MYJS,MYJE
   1515           DO I=MYIS,MYIE
   1516             RSWTT(I,J,L)=TL(I,J)
   1517           ENDDO
   1518           ENDDO
   1519 C
   1520   750     CONTINUE
   1521         ENDIF
   1522 C
   1523   800   CONTINUE
   1524       ENDIF
   1525 C----------------------------------------------------------------------
   1526 C
   1527       IF(LONG)THEN
   1528 C
   1529         DO 900 L=1,LM
   1530         CALL ZERO2(TL)
   1531         CALL ZERO2(FNE)
   1532         CALL ZERO2(FSE)
   1533 C
   1534         IF(KSMUD.GE.1)THEN
   1535           DO 850 KS=1,KSMUD
   1536 C
   1537           DO J=MYJS,MYJE
   1538           DO I=MYIS,MYIE
   1539             TL(I,J)=RLWTT(I,J,L)*HTM(I,J,L)
   1540           ENDDO
   1541           ENDDO
   1542 C
   1543           DO J=MYJS,MYJE1
   1544           DO I=MYIS,MYIE
   1545             FNE(I,J)=(TL(I+IHE(J),J+1)-TL(I,J))
   1546      1               *HTM(I,J,L)*HTM(I+IHE(J),J+1,L)
   1547           ENDDO
   1548           ENDDO
   1549 C
   1550           DO J=MYJS1,MYJE
   1551           DO I=MYIS,MYIE
   1552             FSE(I,J)=(TL(I+IHE(J),J-1)-TL(I,J))
   1553      1               *HTM(I+IHE(J),J-1,L)*HTM(I,J,L)
   1554           ENDDO
   1555           ENDDO
   1556 C

Page 24          Source Listing                  RADTN
2022-02-15 16:37                                 RADTN.F

   1557           DO J=MYJS2,MYJE2
   1558           DO I=MYIS,MYIE
   1559             TL(I,J)=(FNE(I,J)-FNE(I+IHW(J),J-1)
   1560      1              +FSE(I,J)-FSE(I+IHW(J),J+1))
   1561      2              *HBM2(I,J)*0.125+TL(I,J)
   1562           ENDDO
   1563           ENDDO
   1564 C
   1565           DO J=MYJS,MYJE
   1566           DO I=MYIS,MYIE
   1567             RLWTT(I,J,L)=TL(I,J)
   1568           ENDDO
   1569           ENDDO
   1570 C
   1571   850     CONTINUE
   1572         ENDIF
   1573   900   CONTINUE
   1574       ENDIF
   1575 C-----------------------------------------------------------------------
   1576 C-----------------------------------------------------------------------
   1577                               RETURN
   1578                               END


ENTRY POINTS

  Name              
                    
 radtn_             

Page 25          Source Listing                  RADTN
2022-02-15 16:37 Symbol Table                    RADTN.F



SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 125                        Label  627                                                            612                               
 140                        Label  635                                                            629                               
 200                        Label  680                                                            640                               
 250                        Label  704                                                            686                               
 275                        Label  786                                                            719                               
 280                        Label  787                                                            715                               
 290                        Label  810                                                            807                               
 300                        Label  831                                                            828                               
 310                        Label  849                                                            846                               
 320                        Label  861                                                            858                               
 330                        Label  878                                                            875                               
 340                        Label  890                                                            887                               
 350                        Label  895                                                            796                               
 375                        Label  959                                                            919                               
 390                        Label  986                                                            971                               
 400                        Label  1002                                                           999                               
 410                        Label  1013                                                           1010                              
 425                        Label  1018                                                           991                               
 435                        Label  1065                                                           1059                              
 450                        Label  1146                                                           1081,1089,1127                    
 480                        Label  1151                                                           1042,1050                         
 500                        Label  1152                                                           1032                              
 510                        Label  1207                                                           1196                              
 540                        Label  1276                                                           1222                              
 560                        Label  1331                                                           1300                              
 570                        Label  1354                                                           1336                              
 580                        Label  1356                                                           1290                              
 600                        Label  1360                                                           1176                              
 650                        Label  1420                                                           1396                              
 660                        Label  1437                                                           1426,1435                         
 675                        Label  1460                                                           1441                              
 700                        Label  1465                                                           609                               
 750                        Label  1520                                                           1484                              
 800                        Label  1523                                                           1478                              
 850                        Label  1571                                                           1535                              
 900                        Label  1573                                                           1529                              
 A1                         Param  208      R(4)            4           scalar                                                      
 A2                         Param  208      R(4)            4           scalar                    736                               
 A3                         Param  208      R(4)            4           scalar                    736                               
 A4                         Param  208      R(4)            4           scalar                    736                               
 AA                         Local  1345     R(4)            4           scalar                    1345,1346,1349,1350,1351          
 ABS                        Func   1341                                 scalar                    1341                              
 ACMCLD                     Common 406                                  287288   SAVE                                               
 ACMRDL                     Common 414                                  3662832  SAVE                                               
 ACMRDS                     Common 424                                  3662832  SAVE                                               
 ADDL                       Local  547      R(4)            4           scalar                    547,548,549                       
 AI                         Local  727      R(4)            4           scalar                    727,731,737                       
 ALBDO                      Local  444      R(4)            4     1     45                        700,1389                          
 AMAX1                      Func   781                                  scalar                    781,949,1060,1115,1244,1260,1314,1
                                                                                                  324,1351,1407                     
 AMIN1                      Func   726                                  scalar                    726,737,778,784,950,983,1148,1317 

Page 26          Source Listing                  RADTN
2022-02-15 16:37 Symbol Table                    RADTN.F

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 APES                       Local  688      R(4)            4           scalar                    688,689,691                       
 ARG                        Local  780      R(4)            4           scalar                    780,781,782                       
 BB                         Local  1347     R(4)            4           scalar                    1347,1348,1350                    
 BCLD                       Local  234      L(4)            4     1     45                        964,966,972                       
 BI                         Local  728      R(4)            4           scalar                    728,732,737                       
 BIT1                       Local  235      L(4)            4           scalar                    1083,1088,1089,1228,1230          
 BIT2                       Local  235      L(4)            4           scalar                    1121,1126,1127                    
 BITC                       Local  235      L(4)            4           scalar                    1224,1228,1237,1242               
 BITCP1                     Local  235      L(4)            4           scalar                    1226,1243,1253,1267               
 BITS                       Local  235      L(4)            4           scalar                    1225,1228                         
 BITSP1                     Local  235      L(4)            4           scalar                    1227,1267                         
 BITW                       Local  235      L(4)            4           scalar                    1125,1135                         
 BITX                       Local  235      L(4)            4           scalar                    1085,1088,1098,1099,1115,1122,1296
                                                                                                  ,1301,1333,1337                   
 BITY                       Local  235      L(4)            4           scalar                    1098,1101,1122,1124,1125,1126,1141
 BITZ                       Local  235      L(4)            4           scalar                    1099,1106,1124,1129               
 BMID                       Local  481      R(4)            4     1     45                        645,721                           
 BTEMP1                     Local  234      L(4)            4     1     45                        966                               
 CALL1                      Local  233      L(4)            4           scalar                                                      
 CAMT                       Local  473      R(4)            4     2     2070                      1187,1198,1233,1238,1244,1247,1255
                                                                                                  ,1260,1271,1296,1390              
 CAPA                       Param  204      R(4)            4           scalar                    651,670,688                       
 CC                         Local  467      R(4)            4     1     9                         489,940,942,943                   
 CC1                        Local  942      R(4)            4           scalar                    942,946                           
 CC2                        Local  943      R(4)            4           scalar                    943,946                           
 CCLIMIT                    Local  712      R(4)            4           scalar                    712                               
 CCMID                      Local  482      R(4)            4     2     2025                      619,979,981,983,1015,1060,1224,122
                                                                                                  6,1238,1244,1247                  
 CCR                        Local  479      R(4)            4     2     2025                      621,778,782,784                   
 CFRAVG                     Local  1407     R(4)            4           scalar                    1407,1410,1413,1417               
 CL1                        Local  1074     R(4)            4           scalar                    1074,1124,1125,1130,1131,1132,1138
                                                                                                  ,1148                             
 CL2                        Local  1075     R(4)            4           scalar                    1075,1115,1130,1131,1132,1138,1144
 CLAPSE                     Param  219      R(4)            4           scalar                    826                               
 CLDAMT                     Local  441      R(4)            4     1     46                        1037,1060,1061,1063,1084,1087,1122
 CLDCFR                     Local  445      R(4)            4     2     135                       631,1148,1399,1400,1401           
 CLDF                       Local  446      R(4)            4     2     2070                                                        
 CLDMAX                     Local  1043     R(4)            4           scalar                    1043,1061,1063                    
 CLDRH0                     Param  217      R(4)            4           scalar                    217                               
 CLDRH2                     Param  218      R(4)            4           scalar                    218                               
 CLDWTR                     Common 376                                  3447720  SAVE                                               
 CLIMIT                     Local  713      R(4)            4           scalar                    713,744,757                       
 CLPFIL                     Local  838      R(4)            4           scalar                    838,840,847                       
 CLPSE                      Param  219      R(4)            4           scalar                    837,838                           
 CLSTP                      Local  521      R(4)            4           scalar                    521,927,1398                      
 CM1                        Param  220      R(4)            4           scalar                                                      
 CM2                        Param  220      R(4)            4           scalar                                                      
 CM3                        Param  220      R(4)            4           scalar                                                      
 CNCLD                      Local  238      L(4)            4           scalar                    493,917,1408                      
 CNVCLD                     Common 385                                  287280   SAVE                                               
 COS                        Func   551                                  scalar                    551,552                           
 COSZ                       Local  444      R(4)            4     1     45                        703,1391                          
 CR1                        Local  1084     R(4)            4           scalar                    1084,1115                         
 CSMID                      Local  479      R(4)            4     2     2025                      617,784,808,835,847,859,892,1060,1
                                                                                                  225,1227,1233,1255,1260           

Page 27          Source Listing                  RADTN
2022-02-15 16:37 Symbol Table                    RADTN.F

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 CSTR                       Local  469      R(4)            4     1     45                        1034                              
 CTLBLK                     Common 245                                  112      SAVE                                               
 CUINIT                     Common 431                                  4                                                           
 CV                         Local  453      R(4)            4     1     45                        938,940,946,949,950,952,964,981   
 CVB                        Local  471      R(4)            4     1     45                                                          
 CVT                        Local  471      R(4)            4     1     45                                                          
 CWMKL                      Local  724      R(4)            4           scalar                    724,744,757,780                   
 DAYI                       Local  545      R(4)            4           scalar                    545,546,549,564                   
 DCLPS                      Param  219      R(4)            4           scalar                    838                               
 DD                         Local  1342     R(4)            4           scalar                    1342,1344,1349,1350,1351          
 DDP                        Local  806      R(4)            4           scalar                    806,807,845,846,857,858           
 DDX                        Local  230      R(8)            8           scalar                    1339,1340,1342                    
 DELP                       Local  1304     R(4)            4           scalar                    1304,1306,1314,1317,1324,1327     
 DENOM                      Local  1370     R(4)            4           scalar                    1370,1371,1372                    
 DPCL                       Local  1108     R(4)            4           scalar                    1108,1109                         
 DTHDP                      Local  824      R(4)            4           scalar                    824,826,837,838,882,885,1006,1008 
 DYNAM                      Common 274                                  725404   SAVE                                               
 EE                         Local  1343     R(4)            4           scalar                    1343,1345,1347                    
 EEX                        Local  230      R(8)            8           scalar                    1340,1341,1343                    
 EMIS                       Local  470      R(4)            4     2     2070                      1184,1201,1333,1390               
 EPS                        Param  220      R(4)            4           scalar                                                      
 EPSO3                      Param  216      R(4)            4           scalar                    623                               
 EPSQ                       Param  216      R(4)            4           scalar                    616                               
 EPSQ1                      Param  216      R(4)            4           scalar                    769,885,1008,1334                 
 EXNER                      Local  651      R(4)            4           scalar                    651,653,670,671                   
 EXP                        Func   736                                  scalar                    736,782,1333,1346                 
 FCTRA                      Local  1371     R(4)            4           scalar                    1371,1373                         
 FCTRB                      Local  1372     R(4)            4           scalar                    1372,1373                         
 FF                         Local  1344     R(4)            4           scalar                    1344,1345,1347                    
 FIQ                        Local  743      R(4)            4           scalar                    743,744                           
 FIW                        Local  764      R(4)            4           scalar                    764,765                           
 FLOAT                      Func   764                                  scalar                    764                               
 FLWDNS                     Local  457      R(4)            4     1     45                        1394,1451                         
 FLWUP                      Local  455      R(4)            4     1     45                        1394,1453                         
 FLWUPS                     Local  457      R(4)            4     1     45                        1394,1452                         
 FNE                        Local  459      R(4)            4     2     17955                     1480,1494,1508,1531,1545,1559     
 FSE                        Local  459      R(4)            4     2     17955                     1481,1501,1509,1532,1552,1560     
 FSWDN                      Local  455      R(4)            4     1     45                        1394                              
 FSWDNS                     Local  456      R(4)            4     1     45                        1394,1456                         
 FSWUP                      Local  455      R(4)            4     1     45                        1394,1458                         
 FSWUPS                     Local  456      R(4)            4     1     45                        1394,1457                         
 GG                         Local  1348     R(4)            4           scalar                    1348,1349,1351                    
 GLB_TABLE                  Common 181                                  128      SAVE                                               
 HH                         Local  721      R(4)            4           scalar                    721,725,726,736                   
 HMID                       Local  480      R(4)            4     2     2025                      622,656,721                       
 HOUR                       Local  545      R(4)            4           scalar                    545,564,1393                      
 HPINC                      Param  216      R(4)            4           scalar                    668,669,678                       
 I                          Local  505      I(4)            4           scalar                    505,506,556,557,558,567,568,569,57
                                                                                                  0,577,578,613,614,615,616,617,618,
                                                                                                  619,620,621,622,623,624,625,630,63
                                                                                                  1,632,633,640,641,642,643,645,646,
                                                                                                  649,650,651,652,653,654,655,656,66
                                                                                                  8,669,670,671,676,678,686,687,688,
                                                                                                  689,690,691,693,700,702,703,715,71
                                                                                                  6,717,721,722,723,724,735,741,745,

Page 28          Source Listing                  RADTN
2022-02-15 16:37 Symbol Table                    RADTN.F

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
                                                                                                  747,752,756,757,760,778,782,784,79
                                                                                                  6,798,799,803,806,808,817,824,825,
                                                                                                  835,845,847,857,859,873,882,883,88
                                                                                                  5,892,919,920,922,924,927,938,940,
                                                                                                  946,949,950,952,953,954,956,957,96
                                                                                                  3,964,965,966,971,972,973,974,978,
                                                                                                  979,981,983,991,992,993,997,1006,1
                                                                                                  007,1008,1015,1032,1034,1045,1053,
                                                                                                  1060,1085,1086,1108,1123,1148,1149
                                                                                                  ,1150,1156,1157,1176,1177,1178,118
                                                                                                  4,1185,1186,1187,1188,1189,1192,11
                                                                                                  93,1197,1198,1199,1200,1201,1204,1
                                                                                                  205,1224,1225,1226,1227,1232,1233,
                                                                                                  1234,1235,1238,1239,1244,1246,1247
                                                                                                  ,1248,1249,1250,1254,1255,1256,125
                                                                                                  7,1258,1260,1268,1269,1270,1271,12
                                                                                                  81,1282,1292,1296,1297,1298,1301,1
                                                                                                  302,1303,1305,1306,1307,1311,1312,
                                                                                                  1314,1317,1324,1327,1333,1339,1345
                                                                                                  ,1350,1351,1369,1370,1371,1372,137
                                                                                                  3,1396,1397,1398,1399,1400,1401,14
                                                                                                  07,1410,1411,1413,1414,1417,1418,1
                                                                                                  426,1428,1429,1430,1441,1443,1444,
                                                                                                  1451,1452,1453,1456,1457,1458,1487
                                                                                                  ,1488,1493,1494,1495,1500,1501,150
                                                                                                  2,1507,1508,1509,1510,1515,1516,15
                                                                                                  38,1539,1544,1545,1546,1551,1552,1
                                                                                                  553,1558,1559,1560,1561,1566,1567 
 ICVB                       Local  452      I(4)            4     1     45                        954,957,965,978                   
 ICVT                       Local  452      I(4)            4     1     45                        953,956,965,978                   
 IDIM1                      Param  131      I(4)            4           scalar                    234,256,263,264,266,267,268,280,28
                                                                                                  1,282,283,284,285,302,303,304,305,
                                                                                                  306,307,308,309,310,311,312,321,32
                                                                                                  3,324,325,332,333,334,335,336,337,
                                                                                                  338,339,340,341,342,343,344,345,34
                                                                                                  6,347,348,350,355,363,364,365,366,
                                                                                                  367,368,369,370,377,379,386,387,39
                                                                                                  6,408,409,416,417,418,419,426,427,
                                                                                                  428,429,438,442,444,445,446,447,44
                                                                                                  9,450,451,452,453,455,456,457,458,
                                                                                                  459,460,462,463,464,465,469,470,47
                                                                                                  1,473,474,475,476,479,480,481,482 
 IDIM2                      Param  131      I(4)            4           scalar                    234,256,263,264,266,267,268,280,28
                                                                                                  1,282,283,284,285,302,303,304,305,
                                                                                                  306,307,308,309,310,311,312,321,32
                                                                                                  3,324,325,332,333,334,335,336,337,
                                                                                                  338,339,340,341,342,343,344,345,34
                                                                                                  6,347,348,350,355,363,364,365,366,
                                                                                                  367,368,369,370,377,379,386,387,39
                                                                                                  6,408,409,416,417,418,419,426,427,
                                                                                                  428,429,438,442,444,445,446,447,44
                                                                                                  9,450,451,452,453,455,456,457,458,
                                                                                                  459,460,462,463,464,465,469,470,47
                                                                                                  1,473,474,475,476,479,480,481,482 
 IGSTL                      Param  126      I(4)            4           scalar                    131                               

Page 29          Source Listing                  RADTN
2022-02-15 16:37 Symbol Table                    RADTN.F

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 IGSTR                      Param  126      I(4)            4           scalar                    131                               
 II                         Local  562      I(4)            4           scalar                    562,563                           
 IM                         Param  115      I(4)            4           scalar                    128,131,187,188,189,190,191,195,19
                                                                                                  6,201,213,400                     
 IMJM                       Param  213      I(4)            4           scalar                                                      
 INDX                       Common 393                                  6564     SAVE                                               
 INDXG                      Common 399                                  8084     SAVE                                               
 INPES                      Param  123      I(4)            4           scalar                    128,131,171,172,173,182,183       
 INT                        Func   546                                  scalar                    546,956,957,1130,1131             
 IR                         Local  614      I(4)            4           scalar                    614,641                           
 ITAIL                      Param  128      I(4)            4           scalar                                                      
 ITB                        Param  136      I(4)            4           scalar                    299,314                           
 ITBQ                       Param  136      I(4)            4           scalar                    300,314                           
 ITIMLW                     Local  531      I(4)            4           scalar                    531,533,1393                      
 ITIMSW                     Local  530      I(4)            4           scalar                    530,532,1393                      
 ITYP                       Local  474      I(4)            4     2     2070                      1188,1197,1232,1234,1239,1248,1256
                                                                                                  ,1270,1311,1390                   
 IW                         Local  479      I(4)            4     2     2025                      620,745,747,752,756,757,760       
 IWKL                       Local  760      I(4)            4           scalar                    760,764                           
 J                          Local  504      I(4)            4           scalar                    504,506,555,557,558,566,568,569,57
                                                                                                  0,576,578,609,615,642,643,645,646,
                                                                                                  649,650,652,653,654,655,656,687,68
                                                                                                  9,690,691,693,700,702,703,716,717,
                                                                                                  798,799,803,817,920,927,956,957,97
                                                                                                  3,974,992,993,1045,1053,1177,1178,
                                                                                                  1397,1398,1399,1400,1401,1407,1410
                                                                                                  ,1411,1413,1414,1417,1418,1428,142
                                                                                                  9,1430,1443,1451,1452,1453,1456,14
                                                                                                  57,1458,1486,1488,1492,1494,1495,1
                                                                                                  499,1501,1502,1506,1508,1509,1510,
                                                                                                  1514,1516,1537,1539,1543,1545,1546
                                                                                                  ,1550,1552,1553,1557,1559,1560,156
                                                                                                  1,1565,1567                       
 JAM                        Param  213      I(4)            4           scalar                    255,278                           
 JD                         Local  546      I(4)            4           scalar                    546,1393                          
 JDIM1                      Param  132      I(4)            4           scalar                    256,263,264,266,267,268,280,281,28
                                                                                                  2,283,284,285,302,303,304,305,306,
                                                                                                  307,308,309,310,311,312,321,323,32
                                                                                                  4,325,332,333,334,335,336,337,338,
                                                                                                  339,340,341,342,343,344,345,346,34
                                                                                                  7,348,350,355,363,364,365,366,367,
                                                                                                  368,369,370,377,379,386,387,394,39
                                                                                                  5,408,409,416,417,418,419,426,427,
                                                                                                  428,429,438,458,459,460,462,463,46
                                                                                                  4,465                             
 JDIM2                      Param  132      I(4)            4           scalar                    256,263,264,266,267,268,280,281,28
                                                                                                  2,283,284,285,302,303,304,305,306,
                                                                                                  307,308,309,310,311,312,321,323,32
                                                                                                  4,325,332,333,334,335,336,337,338,
                                                                                                  339,340,341,342,343,344,345,346,34
                                                                                                  7,348,350,355,363,364,365,366,367,
                                                                                                  368,369,370,377,379,386,387,394,39
                                                                                                  5,408,409,416,417,418,419,426,427,
                                                                                                  428,429,438,458,459,460,462,463,46
                                                                                                  4,465                             

Page 30          Source Listing                  RADTN
2022-02-15 16:37 Symbol Table                    RADTN.F

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 JGSTL                      Param  127      I(4)            4           scalar                    132                               
 JGSTR                      Param  127      I(4)            4           scalar                    132                               
 JM                         Param  115      I(4)            4           scalar                    129,132,187,188,189,190,191,195,19
                                                                                                  6,201,213,400                     
 JNPES                      Param  123      I(4)            4           scalar                    129,132,171,172,173,182,183       
 JTAIL                      Param  129      I(4)            4           scalar                                                      
 JTB                        Param  136      I(4)            4           scalar                    299,314                           
 JTBQ                       Param  136      I(4)            4           scalar                    314                               
 K15                        Param  227      I(4)            4           scalar                    230                               
 KBT1                       Local  1076     I(4)            4           scalar                    1076,1130,1136,1149,1150          
 KBT2                       Local  1077     I(4)            4           scalar                    1077,1102,1107,1108,1112,1130,1136
                                                                                                  ,1142                             
 KBTM                       Local  475      I(4)            4     2     2070                      1186,1200,1235,1250,1258,1298,1301
                                                                                                  ,1390                             
 KCLD                       Local  476      I(4)            4     1     45                        1189,1232,1233,1234,1235,1238,1239
                                                                                                  ,1244,1246,1247,1248,1249,1250,125
                                                                                                  4,1255,1256,1257,1258,1260,1268,12
                                                                                                  69,1270,1271,1281                 
 KNTLYR                     Local  664      I(4)            4           scalar                    664,667,668                       
 KS                         Local  1484     I(4)            4           scalar                    1484,1535                         
 KSMUD                      Param  205      I(4)            4           scalar                    1483,1484,1534,1535               
 KTH1                       Local  1078     I(4)            4           scalar                    1078,1131,1137,1149               
 KTH2                       Local  1079     I(4)            4           scalar                    1079,1098,1099,1103,1107,1110,1131
                                                                                                  ,1137,1143                        
 KTOP                       Local  474      I(4)            4     2     2070                      1185,1199,1249,1257,1269,1297,1301
                                                                                                  ,1312,1390                        
 KTOP1                      Local  1107     I(4)            4           scalar                    1107,1108                         
 L                          Local  612      I(4)            4           scalar                    612,615,616,617,618,619,620,621,62
                                                                                                  2,623,624,625,648,649,650,651,652,
                                                                                                  653,654,655,656,666,668,669,670,67
                                                                                                  1,719,720,741,804,805,822,823,843,
                                                                                                  844,855,856,871,872,976,977,995,99
                                                                                                  6,1036,1037,1059,1060,1061,1062,10
                                                                                                  63,1082,1084,1085,1086,1087,1102,1
                                                                                                  122,1123,1196,1197,1198,1199,1200,
                                                                                                  1201,1204,1205,1222,1223,1368,1373
                                                                                                  ,1427,1428,1429,1430,1478,1488,149
                                                                                                  5,1502,1516,1529,1539,1546,1553,15
                                                                                                  67                                
 L400                       Local  870      I(4)            4           scalar                    870,874,881,990,998,1005          
 LBASE                      Local  821      I(4)            4           scalar                    821,827,835,836                   
 LL                         Local  720      I(4)            4           scalar                    720,721,722,723,724,735,745,747,75
                                                                                                  2,756,757,760,778,782,784,805,806,
                                                                                                  808,823,824,825,827,844,845,847,85
                                                                                                  6,857,859,872,873,874,881,882,883,
                                                                                                  885,886,891,892,977,978,979,981,98
                                                                                                  3,996,997,998,1005,1006,1007,1008,
                                                                                                  1009,1014,1015,1081,1082,1223,1224
                                                                                                  ,1225,1226,1227,1233,1235,1238,124
                                                                                                  4,1247,1249,1250,1255,1257,1258,12
                                                                                                  60,1269,1300,1301,1302,1303,1305,1
                                                                                                  306,1307,1428,1429,1430,1435      
 LLBOT                      Local  1053     I(4)            4           scalar                    1053,1054,1056,1059,1076,1077,1081
                                                                                                  ,1082,1142                        
 LLTOP                      Local  1045     I(4)            4           scalar                    1045,1050,1059,1081,1082          

Page 31          Source Listing                  RADTN
2022-02-15 16:37 Symbol Table                    RADTN.F

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 LM                         Param  115      I(4)            4           scalar                    196,213,266,267,276,298,323,324,35
                                                                                                  0,377,378,419,429,441,447,449,450,
                                                                                                  451,479,480,482,612,821,836,870,88
                                                                                                  0,890,990,1004,1013,1036,1044,1050
                                                                                                  ,1368,1377,1427,1435,1443,1444,147
                                                                                                  8,1529                            
 LM1                        Param  213      I(4)            4           scalar                    1054,1056                         
 LML                        Local  642      I(4)            4           scalar                    642,648,716,719,798,804,805,822,82
                                                                                                  3,843,844,855,856,871,872,973,976,
                                                                                                  992,995,996,1177,1222,1223        
 LONG                       Local  233      L(4)            4           scalar                    527,529,533,1430,1442,1450,1527   
 LOOPS                      Common 254                                  158840   SAVE                                               
 LP1                        Param  213      I(4)            4           scalar                    276,298,446,469,470,473,474,475,47
                                                                                                  6,1185,1186,1196,1294,1370,1371,13
                                                                                                  72                                
 LSM                        Param  115      I(4)            4           scalar                                                      
 LTROP                      Local  880      I(4)            4           scalar                    880,886,890,891,1004,1009,1013,101
                                                                                                  4                                 
 LVLIJ                      Local  643      I(4)            4           scalar                    643,649,650,651,652,653,654,655,65
                                                                                                  6,663,666,675,717,720,799,805,823,
                                                                                                  844,856,872,974,977,993,996,1178,1
                                                                                                  223                               
 MALVL                      Local  1044     I(4)            4           scalar                    1044,1062                         
 MAPPINGS                   Common 200                                  5024     SAVE                                               
 MASKS                      Common 262                                  6894720  SAVE                                               
 MAX                        Func   1298                                 scalar                    1298,1350                         
 MBOT                       Local  445      I(4)            4     2     135                       633,1150                          
 MIN                        Func   520                                  scalar                    520,1054,1149,1297,1345           
 MOD                        Func   528                                  scalar                    528,529,538,548                   
 MPPCOM                     Common 145                                  1464     SAVE                                               
 MTOP                       Local  452      I(4)            4     2     135                       632,1149                          
 N                          Local  629      I(4)            4           scalar                    629,631,632,633                   
 NB                         Param  224      I(4)            4           scalar                    435,475,476,1191,1203,1336        
 NBAND                      Local  1191     I(4)            4           scalar                    1191,1192,1193,1203,1204,1205,1336
                                                                                                  ,1338,1350,1351                   
 NBTM                       Local  1295     I(4)            4           scalar                    1295,1298,1300                    
 NC                         Local  930      I(4)            4           scalar                    930,931,1290,1296,1297,1298,1301,1
                                                                                                  311,1312,1333,1350,1351           
 NCLD                       Local  1282     I(4)            4           scalar                    1282,1286,1290                    
 NCLDS                      Local  473      I(4)            4     1     45                        1281,1282,1390                    
 NFILE                      Local  488      I(4)            4           scalar                    488                               
 NINT                       Func   519                                  scalar                    519                               
 NKTP                       Local  1294     I(4)            4           scalar                    1294,1297,1300                    
 NLVL                       Local  1042     I(4)            4           scalar                    1042,1045,1052,1053,1085,1086,1109
                                                                                                  ,1123,1148,1149,1150              
 NMOD                       Local  928      I(4)            4           scalar                    928,931,937,939,942,943,944,945   
 NRADPP                     Local  520      I(4)            4           scalar                    520,521,538                       
 NROOT                      Param  138      I(4)            4           scalar                                                      
 NSOIL                      Param  138      I(4)            4           scalar                    368,369,370                       
 NTSPH                      Local  519      I(4)            4           scalar                    519,521                           
 OZN                        Local  451      R(4)            4     2     2025                      623,1377,1389                     
 OZON2D                     Subr   1377                                                           1377                              
 P1                         Local  944      R(4)            4           scalar                    944,946                           
 P2                         Local  945      R(4)            4           scalar                    945,946                           
 P400                       Local  485      R(4)            4           scalar                    485                               

Page 32          Source Listing                  RADTN
2022-02-15 16:37 Symbol Table                    RADTN.F

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 PBOT                       Param  220      R(4)            4           scalar                    807,846,858                       
 PBOTH                      Local  464      R(4)            4     2     17955                                                       
 PBOTL                      Local  462      R(4)            4     2     17955                                                       
 PBOTM                      Local  463      R(4)            4     2     17955                                                       
 PDSL                       Local  458      R(4)            4     2     17955                     506,649,650,1397                  
 PDSLIJ                     Local  1397     R(4)            4           scalar                    1397                              
 PHALF                      Local  469      R(4)            4     1     46                                                          
 PHITP                      Local  485      R(4)            4           scalar                    485,500                           
 PHYS                       Common 293                                  1788916  SAVE                                               
 PI2                        Param  221      R(4)            4           scalar                    549                               
 PINT                       Local  469      R(4)            4     2     2070                      650,669,676,678,1085,1086,1123,130
                                                                                                  2,1303,1312,1370,1371,1372,1389   
 PLBTM                      Local  486      R(4)            4           scalar                    486,497                           
 PLOMD                      Local  485      R(4)            4           scalar                    485,498                           
 PMDHI                      Local  485      R(4)            4           scalar                    485,499                           
 PMID                       Local  449      R(4)            4     2     2025                      649,651,668,669,670,678,735,806,82
                                                                                                  5,845,857,873,883,997,1007,1108,13
                                                                                                  73,1389                           
 PMOD                       Local  927      R(4)            4           scalar                    927,931,946,1398,1409             
 POZN                       Local  451      R(4)            4     2     2025                      1373,1377                         
 PP                         Local  735      R(4)            4           scalar                    735,736                           
 PPT                        Local  467      R(4)            4     1     9                         490,931,944,945,1409              
 PQ0                        Param  210      R(4)            4           scalar                    736                               
 PROD                       Local  230      R(8)            8           scalar                    1338,1339                         
 PRS1                       Local  1302     R(4)            4           scalar                    1302,1304,1306                    
 PRS2                       Local  1303     R(4)            4           scalar                    1303,1304,1306                    
 PSFC                       Local  442      R(4)            4     1     45                        687,688,806,845,857,1389          
 PTOPH                      Local  464      R(4)            4     2     17955                                                       
 PTOPL                      Local  462      R(4)            4     2     17955                                                       
 PTOPM                      Local  463      R(4)            4     2     17955                                                       
 PVRBLS                     Common 331                                  5530140  SAVE                                               
 QC                         Local  765      R(4)            4           scalar                    765,769,772                       
 QI                         Local  737      R(4)            4           scalar                    737,739,743,765                   
 QINT                       Local  738      R(4)            4           scalar                    738,739,765                       
 QKL                        Local  723      R(4)            4           scalar                    723,743,769,772                   
 QMID                       Local  450      R(4)            4     2     2025                      616,654,723,885,1008,1306,1389    
 QSUM                       Local  1293     R(4)            4           scalar                    1293,1306,1334,1338               
 QW                         Local  736      R(4)            4           scalar                    736,737,738                       
 RADFS                      Subr   1387                                                           1387                              
 RADTN                      Subr   3                                                                                                
 RANG                       Local  549      R(4)            4           scalar                    549,550,551,552                   
 RCOS1                      Local  551      R(4)            4           scalar                    551,1377                          
 RCOS2                      Local  552      R(4)            4           scalar                    552,1377                          
 RD1TIM                     Common 437                                  71880                                                       
 REAL                       Func   668                                  scalar                    668                               
 RLAG                       Param  221      R(4)            4           scalar                    549                               
 RNRM                       Param  217      R(4)            4           scalar                                                      
 RNRM2                      Param  218      R(4)            4           scalar                                                      
 RQKL                       Local  770      R(4)            4           scalar                    770,772,777,778,780,782           
 RRCL                       Local  475      R(4)            4     3     24840                     1192,1204,1350,1390               
 RSIN1                      Local  550      R(4)            4           scalar                    550,1377                          
 RTD                        Param  204      R(4)            4           scalar                    702                               
 SELECTED_REAL_KIND         Func   227                                  scalar                    227                               
 SHORT                      Local  233      L(4)            4           scalar                    526,528,532,553,1429,1455,1477    
 SIN                        Func   550                                  scalar                    550                               

Page 33          Source Listing                  RADTN
2022-02-15 16:37 Symbol Table                    RADTN.F

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 SINGLRST                   Local  243      L(4)            4           scalar                                                      
 SLMSK                      Local  446      R(4)            4     1     45                        693,1389                          
 SLPM                       Param  216      R(4)            4           scalar                                                      
 SOIL                       Common 362                                  1651892  SAVE                                               
 SQRT                       Func   1307                                 scalar                    1307,1345,1348                    
 STBOL                      Param  221      R(4)            4           scalar                    1443                              
 SV                         Local  453      R(4)            4     1     45                        922,924,949                       
 SWRSAV                     Common 435                                  112                                                         
 TAUC                       Local  470      R(4)            4     1     45                        1292,1314,1317,1324,1327,1333,1339
                                                                                                  ,1345                             
 TAUDAR                     Local  471      R(4)            4     1     45                        1157,1391                         
 TCLD                       Local  1305     R(4)            4           scalar                    1305,1313,1315,1317,1323,1325     
 TEMPCOM                    Common 186                                  6603768  SAVE                                               
 TENDK                      Local  441      R(4)            4     1     45                                                          
 TENDL                      Local  447      R(4)            4     2     2025                      625,1393,1430                     
 TENDS                      Local  447      R(4)            4     2     2025                      624,1393,1429                     
 THMID                      Local  450      R(4)            4     2     2025                      653,671,824,882,1006              
 TIME                       Local  544      R(4)            4           scalar                    544,545                           
 TIMES                      Local  563      R(4)            4           scalar                    563,564                           
 TKL                        Local  722      R(4)            4           scalar                    722,725,736                       
 TL                         Local  460      R(4)            4     2     17955                     1479,1488,1494,1501,1508,1510,1516
                                                                                                  ,1530,1539,1545,1552,1559,1561,156
                                                                                                  7                                 
 TMID                       Local  449      R(4)            4     2     2025                      615,652,671,722,1305,1307,1389,144
                                                                                                  3,1444                            
 TMT0                       Local  725      R(4)            4           scalar                    725,726,730,737,739,742,751,755   
 TMT15                      Local  726      R(4)            4           scalar                    726,738                           
 TOPO                       Common 194                                  17478548 SAVE                                               
 TOT                        Local  465      R(4)            4     2     17955                     558,570,578                       
 TRESH                      Param  217      R(4)            4           scalar                    217                               
 TRESH2                     Param  218      R(4)            4           scalar                    218                               
 TSKN                       Local  442      R(4)            4     1     45                        689,1389                          
 TTCL                       Local  476      R(4)            4     3     24840                     1193,1205,1351,1390               
 U00KL                      Local  741      R(4)            4           scalar                    741,743                           
 UMID                       Local  481      R(4)            4     1     45                        646,741                           
 US                         Local  711      R(4)            4           scalar                    711,778,780,784                   
 UTIM                       Local  492      R(4)            4           scalar                    492,741                           
 VRBLS                      Common 320                                  13143060 SAVE                                               
 WA                         Param  205      R(4)            4           scalar                    205                               
 WG                         Param  205      R(4)            4           scalar                                                      
 WMID                       Local  480      R(4)            4     2     2025                      618,655,724                       
 XLAT                       Local  444      R(4)            4     1     45                        702,1377,1389                     
 ZENITH                     Subr   545                                                            545,564                           
 ZERO2                      Subr   1479                                                           1479,1480,1481,1530,1531,1532     



Page 34          Source Listing                  RADTN
2022-02-15 16:37 Symbol Table                    RADTN.F

TYPE COMPONENTS/COMMON VARIABLES

 Name                       Type            Bytes Offset   Dimen Elements Attributes       References                         
                                                                                                                              
 ABCFF                      R(4)            4     0        1     12       COM              1338                               
 ACCLIQ                     R(4)            4     1292760  2     17955    COM                                                 
 ACFRCV                     R(4)            4     8        2     17955    COM              1413                               
 ACFRST                     R(4)            4     143648   2     17955    COM              1410,1417                          
 ACPREC                     R(4)            4     1220940  2     17955    COM                                                 
 AETA                       R(4)            4     264      1     45       COM              649,1393                           
 AETAD                      R(4)            4     396      1     45       COM                                                 
 AFSI                       R(4)            4     5458320  2     17955    COM                                                 
 AKHS                       R(4)            4     646380   2     17955    COM                                                 
 AKMS                       R(4)            4     574560   2     17955    COM                                                 
 ALBASE                     R(4)            4     1009004  2     17955    COM                                                 
 ALBEDO                     R(4)            4     1080824  2     17955    COM              700                                
 ALWIN                      R(4)            4     215472   2     17955    COM                                                 
 ALWOUT                     R(4)            4     287292   2     17955    COM                                                 
 ALWTOA                     R(4)            4     359112   2     17955    COM                                                 
 ARDLW                      R(4)            4     8              scalar   COM                                                 
 ARDSW                      R(4)            4     8              scalar   COM                                                 
 ASWIN                      R(4)            4     215472   2     17955    COM                                                 
 ASWOUT                     R(4)            4     287292   2     17955    COM                                                 
 ASWTOA                     R(4)            4     359112   2     17955    COM                                                 
 CFCO2                      R(4)            4     96             scalar   COM                                                 
 CFO3                       R(4)            4     100            scalar   COM                                                 
 CFRACH                     R(4)            4     215460   2     17955    COM              1401,1407                          
 CFRACL                     R(4)            4     71820    2     17955    COM              1399,1407                          
 CFRACM                     R(4)            4     143640   2     17955    COM              1400,1407                          
 CI                         R(4)            4     40             scalar   COM                                                 
 CLDEFI                     R(4)            4     1077300  2     17955    COM                                                 
 CMC                        R(4)            4     718200   2     17955    COM                                                 
 CNVBOT                     R(4)            4     721724   2     17955    COM                                                 
 CNVTOP                     R(4)            4     649904   2     17955    COM                                                 
 CPGFUX                     R(4)            4     150844   2     17955    COM                                                 
 CPGFV                      R(4)            4     4              scalar   COM                                                 
 CS                         R(4)            4     28             scalar   COM                                                 
 CTHK                       R(4)            4     4        1     3        COM              1109                               
 CUPPT                      R(4)            4     0        2     17955    COM              927,1398                           
 CUPREC                     R(4)            4     1364580  2     17955    COM                                                 
 CURAD                      L(4)            4     0              scalar   COM              538                                
 CURVX                      R(4)            4     222664   2     17955    COM                                                 
 CWM                        R(4)            4     0        3     807975   COM              655                                
 CZEN                       R(4)            4     434444   2     17955    COM              568,569                            
 CZMEAN                     R(4)            4     1296284  2     17955    COM              557,569,578,703                    
 DDMPUX                     R(4)            4     509944   2     17955    COM                                                 
 DDMPVX                     R(4)            4     581764   2     17955    COM                                                 
 DETA                       R(4)            4     84       1     45       COM                                                 
 DETAD                      R(4)            4     36       1     45       COM                                                 
 DFL                        R(4)            4     940      1     46       COM                                                 
 DFRLG                      R(4)            4     444      1     46       COM                                                 
 DI                         R(4)            4     44             scalar   COM                                                 
 DS                         R(4)            4     32             scalar   COM                                                 
 DT                         R(4)            4     48             scalar   COM              519,544,563                        
 DTD                        R(4)            4     16             scalar   COM                                                 
 DTQ2                       R(4)            4     8              scalar   COM                                                 
 DXX                        R(4)            4     7204     2     17955    COM                                                 

Page 35          Source Listing                  RADTN
2022-02-15 16:37 Symbol Table                    RADTN.F

 Name                       Type            Bytes Offset   Dimen Elements Attributes       References                         
                                                                                                                              
 DY                         R(4)            4     0              scalar   COM                                                 
 EF4T                       R(4)            4     32             scalar   COM                                                 
 EM                         R(4)            4     1124     1     760      COM                                                 
 EMT                        R(4)            4     4164     1     760      COM                                                 
 EN                         R(4)            4     8              scalar   COM                                                 
 ENT                        R(4)            4     12             scalar   COM                                                 
 EPSR                       R(4)            4     75344    2     17955    COM                                                 
 ETAD                       R(4)            4     756      1     46       COM              650,1393                           
 F4D                        R(4)            4     24             scalar   COM                                                 
 F4Q                        R(4)            4     28             scalar   COM                                                 
 F4Q2                       R(4)            4     576      1     45       COM                                                 
 FADX                       R(4)            4     653584   2     17955    COM                                                 
 FCP                        R(4)            4     294484   2     17955    COM                                                 
 FDIVX                      R(4)            4     366304   2     17955    COM                                                 
 FIRST                      L(4)            4     24             scalar   COM                                                 
 FIS                        R(4)            4     12999420 2     17955    COM                                                 
 FX                         R(4)            4     438124   2     17955    COM                                                 
 G2LI                       I(4)            4     0        1     239      COM                                                 
 G2LJ                       I(4)            4     1912     1     389      COM                                                 
 GFFC                       R(4)            4     865364   2     17955    COM                                                 
 GLAT                       R(4)            4     290804   2     17955    COM              702                                
 GLON                       R(4)            4     362624   2     17955    COM                                                 
 GRNFLX                     R(4)            4     287280   2     17955    COM                                                 
 HBM2                       R(4)            4     6751080  2     17955    COM              645,1510,1561                      
 HBM3                       R(4)            4     6822900  2     17955    COM                                                 
 HBOT                       R(4)            4     578084   2     17955    COM              920,957                            
 HDAC                       R(4)            4     1152644  2     17955    COM                                                 
 HDACV                      R(4)            4     1224464  2     17955    COM                                                 
 HTM                        R(4)            4     287280   3     807975   COM              656,1488,1495,1502,1539,1546,1553  
 HTMG                       R(4)            4     743768   3     4183695  COM                                                 
 HTOP                       R(4)            4     506264   2     17955    COM              920,956                            
 IBROW                      I(4)            4     404            scalar   COM                                                 
 ICHUNKTAB                  I(4)            4     620      1     8        COM                                                 
 IDAT                       I(4)            4     8        1     3        COM              548                                
 IDTAD                      I(4)            4     72             scalar   COM                                                 
 IE_GLB_TABLE               I(4)            4     32       1     8        COM                                                 
 IE_LOC_TABLE               I(4)            4     556      1     8        COM                                                 
 IHE                        I(4)            4     0        1     399      COM              1494,1495,1501,1502,1545,1546,1552 
                                                                                           ,1553                              
 IHEG                       I(4)            4     0        1     387      COM                                                 
 IHHA                       I(4)            4     3040     1     760      COM                                                 
 IHLA                       I(4)            4     0        1     760      COM                                                 
 IHRST                      I(4)            4     20             scalar   COM                                                 
 IHW                        I(4)            4     1596     1     399      COM              1508,1509,1559,1560                
 IHWG                       I(4)            4     1548     1     387      COM                                                 
 ILCOL                      I(4)            4     396            scalar   COM                                                 
 ILPAD1                     I(4)            4     412            scalar   COM                                                 
 ILPAD2                     I(4)            4     416            scalar   COM                                                 
 ILPAD3                     I(4)            4     420            scalar   COM                                                 
 ILPAD4                     I(4)            4     424            scalar   COM                                                 
 ILPAD5                     I(4)            4     428            scalar   COM                                                 
 INUMQ                      I(4)            4     1064     1     100      COM                                                 
 IOUT                       I(4)            4     44             scalar   COM                                                 
 IQUILT_GROUP               I(4)            4     1060           scalar   COM                                                 
 IRAD                       I(4)            4     6384     1     45       COM              614,641                            

Page 36          Source Listing                  RADTN
2022-02-15 16:37 Symbol Table                    RADTN.F

 Name                       Type            Bytes Offset   Dimen Elements Attributes       References                         
                                                                                                                              
 IRADG                      I(4)            4     6192     1     473      COM                                                 
 IRCOL                      I(4)            4     400            scalar   COM                                                 
 IRPAD1                     I(4)            4     432            scalar   COM                                                 
 IRPAD2                     I(4)            4     436            scalar   COM                                                 
 IRPAD3                     I(4)            4     440            scalar   COM                                                 
 IRPAD4                     I(4)            4     444            scalar   COM                                                 
 IRPAD5                     I(4)            4     448            scalar   COM                                                 
 ISLOPE                     I(4)            4     574560   2     17955    COM                                                 
 ISLTYP                     I(4)            4     502740   2     17955    COM                                                 
 IS_GLB_TABLE               I(4)            4     0        1     8        COM                                                 
 IS_LOC_TABLE               I(4)            4     492      1     8        COM                                                 
 ITEMP                      I(4)            4     5870016  2     91719    COM                                                 
 ITEMP2                     I(4)            4     6236892  2     91719    COM                                                 
 ITROW                      I(4)            4     408            scalar   COM                                                 
 IVE                        I(4)            4     3192     1     399      COM                                                 
 IVEG                       I(4)            4     3096     1     387      COM                                                 
 IVGTYP                     I(4)            4     430920   2     17955    COM                                                 
 IVHA                       I(4)            4     9120     1     760      COM                                                 
 IVLA                       I(4)            4     6080     1     760      COM                                                 
 IVW                        I(4)            4     4788     1     399      COM                                                 
 IVWG                       I(4)            4     4644     1     387      COM                                                 
 JBPAD1                     I(4)            4     452            scalar   COM                                                 
 JBPAD2                     I(4)            4     456            scalar   COM                                                 
 JBPAD3                     I(4)            4     460            scalar   COM                                                 
 JBPAD4                     I(4)            4     464            scalar   COM                                                 
 JBPAD5                     I(4)            4     468            scalar   COM                                                 
 JE_GLB_TABLE               I(4)            4     96       1     8        COM                                                 
 JE_LOC_TABLE               I(4)            4     588      1     8        COM                                                 
 JRA                        I(4)            4     12160    1     760      COM                                                 
 JS_GLB_TABLE               I(4)            4     64       1     8        COM                                                 
 JS_LOC_TABLE               I(4)            4     524      1     8        COM                                                 
 JTPAD1                     I(4)            4     472            scalar   COM                                                 
 JTPAD2                     I(4)            4     476            scalar   COM                                                 
 JTPAD3                     I(4)            4     480            scalar   COM                                                 
 JTPAD4                     I(4)            4     484            scalar   COM                                                 
 JTPAD5                     I(4)            4     488            scalar   COM                                                 
 K400                       I(4)            4     0              scalar   COM                                                 
 KTM                        I(4)            4     0              scalar   COM                                                 
 L2GI                       I(4)            4     956      1     239      COM                                                 
 L2GJ                       I(4)            4     3468     1     389      COM                                                 
 LC                         I(4)            4     3304080  2     17955    COM                                                 
 LIST                       I(4)            4     40             scalar   COM                                                 
 LMH                        I(4)            4     15200    2     17955    COM              642,716,798,973,992,1177           
 LMV                        I(4)            4     87020    2     17955    COM                                                 
 LTOP                       I(4)            4     16       1     3        COM              1045,1053                          
 LVL                        I(4)            4     60       2     17955    COM              643,717,799,956,957,974,993,1045,1 
                                                                                           053,1178,1428                      
 MPI_COMM_COMP              I(4)            4     652            scalar   COM                                                 
 MPI_COMM_INTER             I(4)            4     656            scalar   COM                                                 
 MPI_COMM_INTER_ARRAY       I(4)            4     660      1     100      COM                                                 
 MXSNAL                     R(4)            4     3524     2     17955    COM                                                 
 MYIE                       I(4)            4     52             scalar   COM              505,556,567,577,613,630,640,686,71 
                                                                                           5,796,919,963,971,991,1032,1156,11 
                                                                                           76,1369,1396,1426,1441,1487,1493,1 
                                                                                           500,1507,1515,1538,1544,1551,1558, 

Page 37          Source Listing                  RADTN
2022-02-15 16:37 Symbol Table                    RADTN.F

 Name                       Type            Bytes Offset   Dimen Elements Attributes       References                         
                                                                                                                              
                                                                                           1566                               
 MYIE1                      I(4)            4     56             scalar   COM                                                 
 MYIE1_P1                   I(4)            4     120            scalar   COM                                                 
 MYIE1_P2                   I(4)            4     124            scalar   COM                                                 
 MYIE1_P3                   I(4)            4     128            scalar   COM                                                 
 MYIE1_P4                   I(4)            4     132            scalar   COM                                                 
 MYIE2                      I(4)            4     60             scalar   COM                                                 
 MYIE2_P1                   I(4)            4     136            scalar   COM                                                 
 MYIE_P1                    I(4)            4     100            scalar   COM                                                 
 MYIE_P2                    I(4)            4     104            scalar   COM                                                 
 MYIE_P3                    I(4)            4     108            scalar   COM                                                 
 MYIE_P4                    I(4)            4     112            scalar   COM                                                 
 MYIE_P5                    I(4)            4     116            scalar   COM                                                 
 MYIS                       I(4)            4     40             scalar   COM              505,556,567,577,613,630,640,686,71 
                                                                                           5,796,919,963,971,991,1032,1156,11 
                                                                                           76,1369,1396,1426,1441,1487,1493,1 
                                                                                           500,1507,1515,1538,1544,1551,1558, 
                                                                                           1566                               
 MYIS1                      I(4)            4     44             scalar   COM                                                 
 MYIS1_P1                   I(4)            4     84             scalar   COM                                                 
 MYIS1_P2                   I(4)            4     88             scalar   COM                                                 
 MYIS1_P3                   I(4)            4     92             scalar   COM                                                 
 MYIS1_P4                   I(4)            4     96             scalar   COM                                                 
 MYIS2                      I(4)            4     48             scalar   COM                                                 
 MYIS_P1                    I(4)            4     64             scalar   COM                                                 
 MYIS_P2                    I(4)            4     68             scalar   COM                                                 
 MYIS_P3                    I(4)            4     72             scalar   COM                                                 
 MYIS_P4                    I(4)            4     76             scalar   COM                                                 
 MYIS_P5                    I(4)            4     80             scalar   COM                                                 
 MYJE                       I(4)            4     236            scalar   COM              504,555,566,576,609,1486,1492,1499 
                                                                                           ,1514,1537,1550,1565               
 MYJE1                      I(4)            4     240            scalar   COM              1543                               
 MYJE1_P1                   I(4)            4     280            scalar   COM                                                 
 MYJE1_P2                   I(4)            4     284            scalar   COM                                                 
 MYJE1_P3                   I(4)            4     288            scalar   COM                                                 
 MYJE1_P4                   I(4)            4     292            scalar   COM                                                 
 MYJE2                      I(4)            4     244            scalar   COM              1506,1557                          
 MYJE2_P1                   I(4)            4     296            scalar   COM                                                 
 MYJE2_P2                   I(4)            4     300            scalar   COM                                                 
 MYJE2_P3                   I(4)            4     304            scalar   COM                                                 
 MYJE2_P4                   I(4)            4     308            scalar   COM                                                 
 MYJE3                      I(4)            4     248            scalar   COM                                                 
 MYJE3_P4                   I(4)            4     312            scalar   COM                                                 
 MYJE4                      I(4)            4     252            scalar   COM                                                 
 MYJE4_P1                   I(4)            4     316            scalar   COM                                                 
 MYJE4_P4                   I(4)            4     320            scalar   COM                                                 
 MYJE5                      I(4)            4     256            scalar   COM                                                 
 MYJE5_P1                   I(4)            4     324            scalar   COM                                                 
 MYJE5_P2                   I(4)            4     328            scalar   COM                                                 
 MYJE_P1                    I(4)            4     260            scalar   COM                                                 
 MYJE_P2                    I(4)            4     264            scalar   COM                                                 
 MYJE_P3                    I(4)            4     268            scalar   COM                                                 
 MYJE_P4                    I(4)            4     272            scalar   COM                                                 
 MYJE_P5                    I(4)            4     276            scalar   COM                                                 
 MYJS                       I(4)            4     140            scalar   COM              504,555,566,576,609,1486,1492,1514 

Page 38          Source Listing                  RADTN
2022-02-15 16:37 Symbol Table                    RADTN.F

 Name                       Type            Bytes Offset   Dimen Elements Attributes       References                         
                                                                                                                              
                                                                                           ,1537,1543,1565                    
 MYJS1                      I(4)            4     144            scalar   COM              1499,1550                          
 MYJS1_P1                   I(4)            4     184            scalar   COM                                                 
 MYJS1_P2                   I(4)            4     188            scalar   COM                                                 
 MYJS1_P3                   I(4)            4     192            scalar   COM                                                 
 MYJS1_P4                   I(4)            4     196            scalar   COM                                                 
 MYJS2                      I(4)            4     148            scalar   COM              1506,1557                          
 MYJS2_P1                   I(4)            4     200            scalar   COM                                                 
 MYJS2_P2                   I(4)            4     204            scalar   COM                                                 
 MYJS2_P3                   I(4)            4     208            scalar   COM                                                 
 MYJS2_P4                   I(4)            4     212            scalar   COM                                                 
 MYJS3                      I(4)            4     152            scalar   COM                                                 
 MYJS3_P4                   I(4)            4     216            scalar   COM                                                 
 MYJS4                      I(4)            4     156            scalar   COM                                                 
 MYJS4_P1                   I(4)            4     220            scalar   COM                                                 
 MYJS4_P4                   I(4)            4     224            scalar   COM                                                 
 MYJS5                      I(4)            4     160            scalar   COM                                                 
 MYJS5_P1                   I(4)            4     228            scalar   COM                                                 
 MYJS5_P2                   I(4)            4     232            scalar   COM                                                 
 MYJS_P1                    I(4)            4     164            scalar   COM                                                 
 MYJS_P2                    I(4)            4     168            scalar   COM                                                 
 MYJS_P3                    I(4)            4     172            scalar   COM                                                 
 MYJS_P4                    I(4)            4     176            scalar   COM                                                 
 MYJS_P5                    I(4)            4     180            scalar   COM                                                 
 MYPE                       I(4)            4     0              scalar   COM              690                                
 MY_E                       I(4)            4     336            scalar   COM                                                 
 MY_IE_GLB                  I(4)            4     12             scalar   COM                                                 
 MY_IE_LOC                  I(4)            4     28             scalar   COM                                                 
 MY_IS_GLB                  I(4)            4     8              scalar   COM                                                 
 MY_IS_LOC                  I(4)            4     24             scalar   COM                                                 
 MY_JE_GLB                  I(4)            4     20             scalar   COM                                                 
 MY_JE_LOC                  I(4)            4     36             scalar   COM                                                 
 MY_JS_GLB                  I(4)            4     16             scalar   COM                                                 
 MY_JS_LOC                  I(4)            4     32             scalar   COM                                                 
 MY_N                       I(4)            4     332            scalar   COM                                                 
 MY_NE                      I(4)            4     348            scalar   COM                                                 
 MY_NEB                     I(4)            4     364      1     8        COM                                                 
 MY_NW                      I(4)            4     360            scalar   COM                                                 
 MY_S                       I(4)            4     340            scalar   COM                                                 
 MY_SE                      I(4)            4     352            scalar   COM                                                 
 MY_SW                      I(4)            4     356            scalar   COM                                                 
 MY_W                       I(4)            4     344            scalar   COM                                                 
 NBC                        I(4)            4     36             scalar   COM                                                 
 NBOCO                      I(4)            4     76             scalar   COM                                                 
 NCFRCV                     I(4)            4     71828    2     17955    COM              1414                               
 NCFRST                     I(4)            4     215468   2     17955    COM              1411,1418                          
 NCLOD                      I(4)            4     4              scalar   COM                                                 
 NCNVC                      I(4)            4     92             scalar   COM                                                 
 NCP                        I(4)            4     84             scalar   COM                                                 
 NEST                       I(4)            4     108            scalar   COM                                                 
 NFCST                      I(4)            4     32             scalar   COM                                                 
 NPES                       I(4)            4     4              scalar   COM                                                 
 NPHS                       I(4)            4     88             scalar   COM              562                                
 NPREC                      I(4)            4     68             scalar   COM                                                 
 NRADL                      I(4)            4     100            scalar   COM              520,529                            

Page 39          Source Listing                  RADTN
2022-02-15 16:37 Symbol Table                    RADTN.F

 Name                       Type            Bytes Offset   Dimen Elements Attributes       References                         
                                                                                                                              
 NRADS                      I(4)            4     96             scalar   COM              520,528,562                        
 NRDLW                      I(4)            4     4              scalar   COM                                                 
 NRDSW                      I(4)            4     4              scalar   COM                                                 
 NSHDE                      I(4)            4     80             scalar   COM                                                 
 NSTART                     I(4)            4     60             scalar   COM                                                 
 NTDDMP                     I(4)            4     64             scalar   COM                                                 
 NTSD                       I(4)            4     52             scalar   COM              528,529,538,544,563                
 NTSTM                      I(4)            4     56             scalar   COM                                                 
 PCTSNO                     R(4)            4     359100   2     17955    COM                                                 
 PD                         R(4)            4     0        2     17955    COM              506,687                            
 PL                         R(4)            4     48             scalar   COM                                                 
 PLQ                        R(4)            4     72             scalar   COM                                                 
 PREC                       R(4)            4     1149120  2     17955    COM                                                 
 PSHLTR                     R(4)            4     2154600  2     17955    COM                                                 
 PT                         R(4)            4     4              scalar   COM              649,650,668,676,687                
 PTBL                       R(4)            4     1439924  2     10184    COM                                                 
 PTDYN                      R(4)            4     20             scalar   COM                                                 
 PTOPC                      R(4)            4     28       1     4        COM              497,498,499,500,1085,1086,1123,131 
                                                                                           2                                  
 PWTS                       R(4)            4     48       1     12       COM                                                 
 Q                          R(4)            4     9767520  3     807975   COM              654                                
 Q10                        R(4)            4     1795500  2     17955    COM                                                 
 Q2                         R(4)            4     2226420  3     807975   COM                                                 
 Q30                        R(4)            4     1508220  2     17955    COM                                                 
 QS                         R(4)            4     502740   2     17955    COM                                                 
 QS0                        R(4)            4     628      1     134      COM                                                 
 QSHLTR                     R(4)            4     2082780  2     17955    COM                                                 
 QWBS                       R(4)            4     861840   2     17955    COM                                                 
 QZ0                        R(4)            4     359100   2     17955    COM                                                 
 R1                         R(4)            4     56             scalar   COM              1393                               
 RADIN                      R(4)            4     147164   2     17955    COM                                                 
 RADOT                      R(4)            4     218984   2     17955    COM                                                 
 RDETA                      R(4)            4     216      1     45       COM                                                 
 RDP                        R(4)            4     64             scalar   COM                                                 
 RDPQ                       R(4)            4     76             scalar   COM                                                 
 RDQ                        R(4)            4     56             scalar   COM                                                 
 RDTH                       R(4)            4     60             scalar   COM                                                 
 RDTHE                      R(4)            4     68             scalar   COM                                                 
 RDTHEQ                     R(4)            4     80             scalar   COM                                                 
 RDYN                       R(4)            4     16             scalar   COM                                                 
 REFLO3                     R(4)            4     104            scalar   COM                                                 
 RES                        R(4)            4     13071240 2     17955    COM              506                                
 RESTRT                     L(4)            4     28             scalar   COM              528,529                            
 RF                         R(4)            4     718200   2     17955    COM                                                 
 RLWIN                      R(4)            4     12       2     17955    COM              1451                               
 RLWOUT                     R(4)            4     71832    2     17955    COM              1452                               
 RLWTOA                     R(4)            4     143652   2     17955    COM              1453                               
 RLWTT                      R(4)            4     430932   3     807975   COM              1430,1539,1567                     
 ROI                        R(4)            4     36             scalar   COM                                                 
 ROS                        R(4)            4     24             scalar   COM                                                 
 RRAYAV                     R(4)            4     108            scalar   COM                                                 
 RSWIN                      R(4)            4     12       2     17955    COM              1456                               
 RSWOUT                     R(4)            4     71832    2     17955    COM              1457                               
 RSWTOA                     R(4)            4     143652   2     17955    COM              1458                               
 RSWTT                      R(4)            4     430932   3     807975   COM              1429,1488,1516                     

Page 40          Source Listing                  RADTN
2022-02-15 16:37 Symbol Table                    RADTN.F

 Name                       Type            Bytes Offset   Dimen Elements Attributes       References                         
                                                                                                                              
 RTDPTH                     R(4)            4     1364596  1     4        COM                                                 
 RUN                        L(4)            4     4              scalar   COM                                                 
 SFCEXC                     R(4)            4     71820    2     17955    COM                                                 
 SH2O                       R(4)            4     1364612  3     71820    COM                                                 
 SI                         R(4)            4     1005480  2     17955    COM                                                 
 SICE                       R(4)            4     215460   2     17955    COM                                                 
 SIGMA                      L(4)            4     0              scalar   COM                                                 
 SIGT4                      R(4)            4     1368104  2     17955    COM              1443                               
 SLDPTH                     R(4)            4     1364580  1     4        COM                                                 
 SM                         R(4)            4     143640   2     17955    COM              689,691,693,803,817                
 SMC                        R(4)            4     790020   3     71820    COM                                                 
 SMSTAV                     R(4)            4     143640   2     17955    COM                                                 
 SMSTOT                     R(4)            4     215460   2     17955    COM                                                 
 SNO                        R(4)            4     933660   2     17955    COM                                                 
 SOILTB                     R(4)            4     0        2     17955    COM                                                 
 SQS                        R(4)            4     1164     1     134      COM                                                 
 SR                         R(4)            4     3375900  2     17955    COM                                                 
 SST                        R(4)            4     937184   2     17955    COM                                                 
 STC                        R(4)            4     1077300  3     71820    COM                                                 
 STHE                       R(4)            4     2004     1     76       COM                                                 
 STHEQ                      R(4)            4     2916     1     152      COM                                                 
 SUBPOST                    L(4)            4     104            scalar   COM                                                 
 T                          R(4)            4     71820    3     807975   COM              615,652,653                        
 TAUCV                      R(4)            4     44       1     3        COM                                                 
 TCLOD                      R(4)            4     0              scalar   COM                                                 
 TDTD                       R(4)            4     20             scalar   COM                                                 
 TDTQ2                      R(4)            4     12             scalar   COM                                                 
 TEMP1                      R(4)            4     0        2     91719    COM                                                 
 TEMP10                     R(4)            4     3301884  2     91719    COM                                                 
 TEMP11                     R(4)            4     3668760  2     91719    COM                                                 
 TEMP12                     R(4)            4     4035636  2     91719    COM                                                 
 TEMP13                     R(4)            4     4402512  2     91719    COM                                                 
 TEMP14                     R(4)            4     4769388  2     91719    COM                                                 
 TEMP15                     R(4)            4     5136264  2     91719    COM                                                 
 TEMP16                     R(4)            4     5503140  2     91719    COM                                                 
 TEMP2                      R(4)            4     366876   2     91719    COM                                                 
 TEMP2X                     R(4)            4     0        2     92971    COM                                                 
 TEMP3                      R(4)            4     733752   2     91719    COM                                                 
 TEMP4                      R(4)            4     1100628  2     91719    COM                                                 
 TEMP5                      R(4)            4     1467504  2     91719    COM                                                 
 TEMP6                      R(4)            4     1834380  2     91719    COM                                                 
 TEMP7                      R(4)            4     2201256  2     91719    COM                                                 
 TEMP8                      R(4)            4     2568132  2     91719    COM                                                 
 TEMP9                      R(4)            4     2935008  2     91719    COM                                                 
 TG                         R(4)            4     793544   2     17955    COM                                                 
 TH10                       R(4)            4     1723680  2     17955    COM                                                 
 TH30                       R(4)            4     1436400  2     17955    COM                                                 
 THE0                       R(4)            4     1700     1     76       COM                                                 
 THE0Q                      R(4)            4     2308     1     152      COM                                                 
 THL                        R(4)            4     52             scalar   COM                                                 
 THS                        R(4)            4     430920   2     17955    COM              689,691                            
 THZ0                       R(4)            4     287280   2     17955    COM                                                 
 TRDLW                      R(4)            4     0              scalar   COM                                                 
 TRDSW                      R(4)            4     0              scalar   COM                                                 
 TSHLTR                     R(4)            4     2010960  2     17955    COM                                                 

Page 41          Source Listing                  RADTN
2022-02-15 16:37 Symbol Table                    RADTN.F

 Name                       Type            Bytes Offset   Dimen Elements Attributes       References                         
                                                                                                                              
 TTBL                       R(4)            4     1480660  2     10184    COM                                                 
 TTBLQ                      R(4)            4     1521396  2     66880    COM                                                 
 TTVG                       R(4)            4     371884   2     92971    COM                                                 
 TWBS                       R(4)            4     790020   2     17955    COM                                                 
 U                          R(4)            4     3303720  3     807975   COM                                                 
 U00                        R(4)            4     3231900  2     17955    COM              646                                
 U10                        R(4)            4     1867320  2     17955    COM                                                 
 U30                        R(4)            4     1580040  2     17955    COM                                                 
 UL                         R(4)            4     3303720  1     90       COM              741                                
 USTAR                      R(4)            4     71820    2     17955    COM                                                 
 UZ0                        R(4)            4     143640   2     17955    COM                                                 
 V                          R(4)            4     6535620  3     807975   COM                                                 
 V10                        R(4)            4     1939140  2     17955    COM                                                 
 V30                        R(4)            4     1651860  2     17955    COM                                                 
 VBM2                       R(4)            4     0        2     17955    COM                                                 
 VBM3                       R(4)            4     71820    2     17955    COM                                                 
 VEGFRC                     R(4)            4     646380   2     17955    COM                                                 
 VTM                        R(4)            4     3519180  3     807975   COM                                                 
 VZ0                        R(4)            4     215460   2     17955    COM                                                 
 WPDARX                     R(4)            4     79024    2     17955    COM                                                 
 Z0                         R(4)            4     0        2     17955    COM                                                 

Page 42          Source Listing                  RADTN
2022-02-15 16:37 Subprograms/Common Blocks       RADTN.F



SUBPROGRAMS/COMMON BLOCKS

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 ACMCLD                     Common 406                                  287288   SAVE                                               
 ACMRDL                     Common 414                                  3662832  SAVE                                               
 ACMRDS                     Common 424                                  3662832  SAVE                                               
 CLDWTR                     Common 376                                  3447720  SAVE                                               
 CNVCLD                     Common 385                                  287280   SAVE                                               
 CTLBLK                     Common 245                                  112      SAVE                                               
 CUINIT                     Common 431                                  4                                                           
 DYNAM                      Common 274                                  725404   SAVE                                               
 GLB_TABLE                  Common 181                                  128      SAVE                                               
 INDX                       Common 393                                  6564     SAVE                                               
 INDXG                      Common 399                                  8084     SAVE                                               
 LOOPS                      Common 254                                  158840   SAVE                                               
 MAPPINGS                   Common 200                                  5024     SAVE                                               
 MASKS                      Common 262                                  6894720  SAVE                                               
 MPPCOM                     Common 145                                  1464     SAVE                                               
 PHYS                       Common 293                                  1788916  SAVE                                               
 PVRBLS                     Common 331                                  5530140  SAVE                                               
 RADTN                      Subr   3                                                                                                
 RD1TIM                     Common 437                                  71880                                                       
 SOIL                       Common 362                                  1651892  SAVE                                               
 SWRSAV                     Common 435                                  112                                                         
 TEMPCOM                    Common 186                                  6603768  SAVE                                               
 TOPO                       Common 194                                  17478548 SAVE                                               
 VRBLS                      Common 320                                  13143060 SAVE                                               

COMPILER OPTIONS BEING USED

       -align noall                          -align nonone
       -align nocommons                      -align nodcommons
       -align noqcommons                     -align nozcommons
       -align records                        -align nosequence
       -align norec1byte                     -align norec2byte
       -align norec4byte                     -align norec8byte
       -align norec16byte                    -align norec32byte
       -align norec64byte                    -align noarray8byte
       -align noarray16byte                  -align noarray32byte
       -align noarray64byte                  -align noarray128byte
       -align noarray256byte                 -altparam
       -assume accuracy_sensitive            -assume nobscc
       -assume nobuffered_io                 -assume nobuffered_stdout
       -assume byterecl                      -assume nocontiguous_assumed_shape
       -assume nocontiguous_pointer          -assume nocc_omp
       -assume nocstring                     -assume nodummy_aliases
       -assume nofpe_summary                 -assume noieee_fpe_flags
       -assume nominus0                      -assume noold_boz
       -assume old_complex_align             -assume old_unit_star
       -assume old_inquire_recl              -assume old_ldout_format
       -assume old_ldout_zero                -assume noold_logical_assign
       -assume noold_logical_ldio            -assume old_maxminloc
       -assume old_xor                       -assume noprotect_allocates
       -assume protect_constants             -assume noprotect_parens

Page 43          Source Listing                  RADTN
2022-02-15 16:37                                 RADTN.F

       -assume split_common                  -assume source_include
       -assume nostd_intent_in               -assume std_minus0_rounding
       -assume nostd_mod_proc_name           -assume std_value
       -assume realloc_lhs                   -assume underscore
       -assume no2underscores                -assume norecursion
  no   -auto                                 -auto_scalar
  no   -bintext                              -ccdefault default
       -check noarg_temp_created             -check noassume
       -check nobounds                       -check nocontiguous
       -check noformat                       -check nooutput_conversion
       -check nooverflow                     -check nopointers
       -check noshape                        -check nostack
       -check nouninitialized                -check noudio_iostat
       -coarray-num-procs 0             no   -coarray-config-file
       -convert big_endian                   -cross_reference
       -D __INTEL_COMPILER=1910              -D __INTEL_COMPILER_UPDATE=3
       -D __unix__                           -D __unix
       -D __linux__                          -D __linux
       -D __gnu_linux__                      -D unix
       -D linux                              -D __ELF__
       -D __x86_64                           -D __x86_64__
       -D __amd64                            -D __amd64__
       -D __INTEL_COMPILER_BUILD_DATE=20200925       -D __INTEL_OFFLOAD
       -D __MMX__                            -D __SSE__
       -D __SSE_MATH__                       -D __SSE2__
       -D __SSE2_MATH__                      -D __SSE3__
       -D __SSSE3__                          -D __SSE4_1__
       -D __SSE4_2__                         -D __POPCNT__
       -D __PCLMUL__                         -D __AES__
       -D __AVX__                            -D __F16C__
       -D __AVX_I__                          -D __RDRND__
       -D __FMA__                            -D __FP_FAST_FMA
       -D __FP_FAST_FMAF                     -D __BMI__
       -D __LZCNT__                          -D __AVX2__
       -D __haswell                          -D __haswell__
       -D __tune_haswell__                   -D __core_avx2
       -D __core_avx2__                      -D __tune_core_avx2__
       -D __CRAY_X86_ROME                    -D __CRAYXT_COMPUTE_LINUX_TARGET
       -double_size 64                  no   -d_lines
  no   -Qdyncom                              -error_limit 30
  no   -f66                             no   -f77rtl
  no   -fast                                 -fpscomp nofilesfromcmd
       -fpscomp nogeneral                    -fpscomp noioformat
       -fpscomp noldio_spacing               -fpscomp nologicals
       -fixed                           no   -fpconstant
       -fpe3                                 -fprm nearest
  no   -ftz                                  -fp_model precise
       -fp_model nofast                      -fp_model nostrict
       -fp_model nosource                    -fp_model nodouble
       -fp_model noextended                  -fp_model novery_fast
       -fp_model noexcept                    -fp_model nono_except
       -fp_modbits nofp_contract             -fp_modbits nono_fp_contract
       -fp_modbits nofenv_access             -fp_modbits nono_fenv_access
       -fp_modbits nocx_limited_range        -fp_modbits nono_cx_limited_range
       -fp_modbits noprec_div                -fp_modbits nono_prec_div
       -fp_modbits noprec_sqrt               -fp_modbits nono_prec_sqrt
       -fp_modbits noftz                     -fp_modbits no_ftz

Page 44          Source Listing                  RADTN
2022-02-15 16:37                                 RADTN.F

       -fp_modbits nointrin_limited_range       -fp_modbits nono_intrin_limited_range
       -fp_modbits notrunc_compares          -fp_modbits nono_trunc_compares
       -fp_modbits noieee_nan_compares       -fp_modbits nono_ieee_nan_compares
       -fp_modbits nohonor_f32_conversion       -fp_modbits nono_honor_f32_conversion
       -fp_modbits nohonor_f64_conversion       -fp_modbits nono_honor_f64_conversion
       -fp_modbits nono_x87_copy             -fp_modbits nono_no_x87_copy
       -fp_modbits noexception_semantics       -fp_modbits nono_exception_semantics
       -fp_modbits noprecise_libm_functions       -fp_modbits nono_precise_libm_functions
       -heap_arrays 0                   no   -threadprivate_compat
       -g2                                   -iface nomixed_str_len_arg
       -iface nono_mixed_str_len_arg         -init noarrays
       -init nohuge                          -init noinfinity
       -init nominus_huge                    -init nominus_infinity
       -init nominus_tiny                    -init nonan
       -init nosnan                          -init notiny
       -init nozero                     no   -intconstant
       -integer_size 32                 no   -mixed_str_len_arg
  no   -module                               -names lowercase
  no   -noinclude                       no   -o
       -offload-build=host                   -openmp-simd
       -O2                              no   -pad_source
       -real_size 32                    no   -recursive
       -reentrancy threaded                  -vec=simd
       -show nofullpath                      -show noinclude
       -show map                             -show options
  no   -syntax_only                     no   -threadcom
  no   -U                               no   -vms
       -w noall                              -w nonone
       -w alignments                         -w nodeclarations
       -w noexternals                        -w general
       -w noignore_bounds                    -w noignore_loc
       -w nointerfaces                       -w noshape
       -w notruncated_source                 -w uncalled
       -w uninitialized                      -w nounused
       -w usage                         no   -wrap-margins

       -includepath : /pe/intel/compilers_and_libraries_2020.4.304/linux/pstl/include/,/pe/intel/compilers_and_libraries_2020.4.304/linux/compiler/include/,
           .f90,./.f90,/opt/cray/pe/mpich/8.1.9/ofi/intel/19.0/include/.f90,/pe/intel/compilers_and_libraries_2020.4.304/linux/ipp/include/.f90,
           /pe/intel/compilers_and_libraries_2020.4.304/linux/mkl/include/.f90,/pe/intel/compilers_and_libraries_2020.4.304/linux/pstl/include/.f90,
           /pe/intel/compilers_and_libraries_2020.4.304/linux/pstl/stdlib/.f90,/pe/intel/compilers_and_libraries_2020.4.304/linux/tbb/include/.f90,
           /pe/intel/compilers_and_libraries_2020.4.304/linux/compiler/include/intel64/.f90,/pe/intel/compilers_and_libraries_2020.4.304/linux/compiler/include/icc/.f90,
           /pe/intel/compilers_and_libraries_2020.4.304/linux/compiler/include/.f90,/usr/lib64/gcc/x86_64-suse-linux/7/include/.f90,
           /usr/lib64/gcc/x86_64-suse-linux/7/include-fixed/.f90,/usr/include/.f90,/usr/include/.f90,/usr/include/.f90
       -list filename : RADTN.lst
  no   -o

COMPILER: Intel(R) Fortran 19.1-1655
