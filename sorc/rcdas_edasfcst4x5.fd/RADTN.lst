Page 1           Source Listing                  RADTN
2022-02-15 16:38                                 /tmp/ifortP3ukpS.i

      1 # 1 "RADTN.F"
      2 C&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&
      3                              SUBROUTINE RADTN
      4 C     ******************************************************************
      5 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
      6 C                .      .    .
      7 C SUBPROGRAM:    RADTN       THE OUTER RADIATION DRIVER
      8 C   PRGRMMR: BLACK           ORG: W/NP22     DATE: 93-12-??
      9 C
     10 C ABSTRACT:
     11 C     RADTN PRIMARILY SERVES TO SET UP THE ARRAYS NEEDED AS INPUT
     12 C     FOR RADFS (THE INNER RADIATION DRIVER).  GROUPS OF MODEL COLUMNS
     13 C     ARE SENT TO RADFS BUT FIRST THEY ARE "LIFTED" SO THAT THE LOWEST
     14 C     LAYER ABOVE THE GROUND HAS A VERTICAL INDEX VALUE OF LM NOT LMH.
     15 C     THIS ROUTINE IS CALLED AS OFTEN AS DESIRED (EVERY 1 TO 2 HOURS)
     16 C     FOR BOTH THE SHORT AND LONGWAVE EFFECTS.  THE RESULTING TEMPER-
     17 C     ATURE TENDENCIES, TOTAL DOWNWARD AND SHORTWAVE UPWARD FLUXES ARE
     18 C     COLLECTED.
     19 C     THE INITIAL GROUND POTENTIAL TEMPERATURE IS ALSO COMPUTED HERE
     20 C     AND IS SIMPLY AN ADIABATIC EXTRAPOLATION FROM THE LOWEST MID-
     21 C     LAYER VALUE ABOVE THE GROUND.
     22 C
     23 C PROGRAM HISTORY LOG:
     24 C   87-09-??  BLACK      - ORIGINATOR
     25 C   92-10-??  BALDWIN    - VARIOUS CLOUD EFFECTS WERE INCLUDED
     26 C                          WHICH WERE ALREADY IN THE MRF
     27 C   93-11-??  ZHAO       - TIED TO UPDATED GFDL RADIATION SCHEME
     28 C                          USING MODEL-PREDICTED CLOUD
     29 C   95-03-25  BLACK      - CONVERSION FROM 1-D TO 2-D IN HORIZONTAL
     30 C   95-04-13  BLACK      - PARALLELIZED THE LARGE LOOP STEPPING
     31 C                          THROUGH THE DOMAIN THAT CALLS RADFS
     32 C   95-10-10  ZHAO       - i) THE CALCULATION OF CLOUD FRACTION WAS
     33 C                             CHANGED TO USE BOTH CLOUD WATER/ICE
     34 C                             MIXING RATIO AND RELATIVE HUMIDITY
     35 C                             (RANDALL, 1994);
     36 C                          ii) THE CLOUD INPUTS WERE CHANGED TO USE
     37 C                              CLOUD FRACTION IN EACH MODEL LAYER
     38 C                              AFTER Y.T. HOU (1995).
     39 C   96-06-03  ZHAO       - SNOW ALBEDO IS CHANGED ACCORDING TO
     40 C                          SUGGESTIONS FROM KEN MITCHELL AND FEI CHEN
     41 C   96-07-23  ZHAO       - ADD CALL TO SOLARD TO CALCULATE THE NON-
     42 C                          DIMENSIONAL SUN-EARTH DISTANCE R1 WHICH
     43 C                          WILL BE USED IN RADFS TO COMPUTE SOLAR
     44 C                          CONSTANT SOLC ON EACH DAY
     45 C   96-07-26  BLACK      - ADDED OZONE COMPUTATIONS
     46 C   97-05-19  ZHAO       - DIAGNOSTIC CLOUDS (LOW, MIDDLE, AND HIGH)
     47 C                          ARE MODIFIED TO USE THE MAXIMUM OF
     48 C                          CONVECTIVE AND STRATIFORM. THIS WILL REPLACE
     49 C                          THE PREVIOUS SCHEME WHICH USES ONLY CONVECTIVE
     50 C                          CLOUDS AT CONVECTIVE POINTS. THIS WILL
     51 C                          AFFECT CFRACL, CFRACM, CFRACH, AND WILL
     52 C                          AFFECT THE TOTAL CLOUD FRACTION CALCULATION
     53 C                          IN THE POST PROCESSORS.
     54 C   98-??-??  TUCCILLO   - ADDED PARALLELISM FOR CLASS VIII
     55 C   98-10-27  BLACK      - PARALLELISM INTO NEWEST VERSION
     56 C
     57 C

Page 2           Source Listing                  RADTN
2022-02-15 16:38                                 RADTN.F

     58 C
     59 C USAGE: CALL RADTN FROM MAIN PROGRAM EBU
     60 C   INPUT ARGUMENT LIST:
     61 C     NONE
     62 C
     63 C   OUTPUT ARGUMENT LIST:
     64 C     NONE
     65 C
     66 C   OUTPUT FILES:
     67 C     NONE
     68 C
     69 C   SUBPROGRAMS CALLED:
     70 C
     71 C     UNIQUE:
     72 C        ZENITH
     73 C        RADFS
     74 C        GRADFS
     75 C        SOLARD
     76 C        O3CLIM
     77 C        OZON2D
     78 C
     79 C     LIBRARY:
     80 C        NONE
     81 C
     82 C   COMMON BLOCKS: CTLBLK
     83 C                  LOOPS
     84 C                  MASKS
     85 C                  DYNAMD
     86 C                  PHYS
     87 C                  VRBLS
     88 C                  PVRBLS
     89 C                  CLDWTR
     90 C                  CNVCLD
     91 C                  INDX
     92 C                  ACMCLD
     93 C                  ACMRDS
     94 C                  ACMRDL
     95 C
     96 C ATTRIBUTES:
     97 C   LANGUAGE: FORTRAN 90
     98 C   MACHINE : IBM SP
     99 C$$$
    100 C     ******************************************************************
    101 C     *   Note: Convective clouds are added in this subroutine         *
    102 C     *         for use in the eta model in which model-predicted      *
    103 C     *         clouds are not used in the convective precipitation    *
    104 C     *         processes.                                             *
    105 C     *         For use with the version of the eta model in which     *
    106 C     *         the model-predicted clouds are linked into the model's *
    107 C     *         convective precipitation processes, just set:          *
    108 C     *                    CNCLD=.FALSE.                               *
    109 C     *                                     Qingyun  Zhao  12-9-94     *
    110 C     ******************************************************************
    111 C-----------------------------------------------------------------------
    112       INCLUDE "parmeta"
    136       INCLUDE "parm.tbl"
    138       INCLUDE "parmsoil"

Page 3           Source Listing                  RADTN
2022-02-15 16:38                                 RADTN.F

    140       INCLUDE "mpp.h"
    141 # 1 "./sp.h" 1 
    142 # 4
    143 
    144 # 116 "RADTN.F" 2 
    145 C-----------------------------------------------------------------------
    204                              P A R A M E T E R
    205      & (CAPA=0.28589641,RTD=57.2957795
    206      &, WA=.10,WG=1.-WA,KSMUD=0)
    207 C-------------------------CLOUD----------------------------------------
    208                              P A R A M E T E R
    209      & (A1=610.78,A2=17.2693882,A3=273.16,A4=35.86              
    210 c     &, PQ0=379.90516,SNOALB=0.55)
    211      &, PQ0=379.90516) 
    212 C-------------------------CLOUD----------------------------------------
    213                              P A R A M E T E R
    214      & (IMJM=IM*JM-JM/2,JAM=6+2*(JM-10),LM1=LM-1,LP1=LM+1)
    215 C
    216                              P A R A M E T E R
    217      & (SLPM=1.01325E5,EPSQ1=1.E-5,EPSQ=2.E-12,EPSO3=1.E-10,HPINC=1.E1
    218      &, CLDRH0=0.80,TRESH=1.00,RNRM=1./(TRESH-CLDRH0)
    219      &, CLDRH2=0.90,TRESH2=1.00,RNRM2=1./(TRESH2-CLDRH2)
    220      &, CLAPSE=-0.0005,CLPSE=-0.0006,DCLPS=-0.0001
    221      &, CM1=2937.4,CM2=4.9283,CM3=23.5518,EPS=0.622,PBOT=10000.0 
    222      &, STBOL=5.67E-8,PI2=2.*3.14159265,RLAG=14.8125)
    223 C
    224                              P A R A M E T E R
    225      & (NB=12)
    226 C-----------------------------------------------------------------------
    227                              P A R A M E T E R
    228      & (K15=SELECTED_REAL_KIND(15))
    229 C
    230                              R E A L
    231      & (KIND=K15) PROD,DDX,EEX
    232 C-----------------------------------------------------------------------
    233                              L O G I C A L
    234      & RUN,FIRST,RESTRT,SIGMA,CALL1,SHORT,LONG
    235      &,BCLD(IDIM1:IDIM2),BTEMP1(IDIM1:IDIM2)
    236      &,BITX,BITY,BITZ,BITW,BIT1,BIT2,BITC,BITS,BITCP1,BITSP1
    237 C-------------------------CONVECTION------------------------------------
    238                              L O G I C A L
    239      & CNCLD
    240 C-------------------------CONVECTION------------------------------------
    241       INCLUDE "CTLBLK.comm"
    242 C-----------------------------------------------------------------------
    252       INCLUDE "LOOPS.comm"
    253 C-----------------------------------------------------------------------
    260       INCLUDE "MASKS.comm"
    261 C-----------------------------------------------------------------------
    272       INCLUDE "DYNAMD.comm"
    273 C-----------------------------------------------------------------------
    289       INCLUDE "PHYS.comm"
    290 C-----------------------------------------------------------------------
    318       INCLUDE "VRBLS.comm"
    319 C-----------------------------------------------------------------------
    329       INCLUDE "PVRBLS.comm"
    330 C-----------------------------------------------------------------------

Page 4           Source Listing                  RADTN
2022-02-15 16:38                                 RADTN.F

    360       INCLUDE "SOIL.comm"
    361 C-----------------------------------------------------------------------
    374       INCLUDE "CLDWTR.comm"
    375 C-----------------------------------------------------------------------
    383       INCLUDE "CNVCLD.comm"
    384 C-----------------------------------------------------------------------
    391       INCLUDE "INDX.comm"
    392 C-----------------------------------------------------------------------
    404       INCLUDE "ACMCLD.comm"
    405 C----------------------------------------------------------------------
    412       INCLUDE "ACMRDL.comm"
    413 C----------------------------------------------------------------------
    422       INCLUDE "ACMRDS.comm"
    423 C-----------------------------------------------------------------------
    432       COMMON /CUINIT/ CURAD
    433       LOGICAL CURAD
    434 C-----------------------------------------------------------------------
    435                              C O M M O N
    436      & /SWRSAV/ABCFF(NB),PWTS(NB),CFCO2,CFO3,REFLO3,RRAYAV
    437                              C O M M O N
    438      & /RD1TIM/K400,CTHK(3),LTOP(3),PTOPC(4),TAUCV(3),R1
    439      &, LVL(IDIM1:IDIM2,JDIM1:JDIM2)
    440 C-----------------------------------------------------------------------
    441                              D I M E N S I O N
    442      &  TENDK (LM),CLDAMT(0:LM)
    443      &, PSFC  (IDIM1:IDIM2),TSKN (IDIM1:IDIM2)
    444 c     &, ALBEDO(IDIM1:IDIM2),XLAT(IDIM1:IDIM2),COSZ (IDIM1:IDIM2)
    445      &, ALBDO (IDIM1:IDIM2),XLAT(IDIM1:IDIM2),COSZ (IDIM1:IDIM2)
    446      &, CLDCFR(IDIM1:IDIM2,3),MBOT(IDIM1:IDIM2,3)
    447      &, CLDF  (IDIM1:IDIM2,LP1),SLMSK (IDIM1:IDIM2)
    448      &, TENDS (IDIM1:IDIM2,LM),TENDL (IDIM1:IDIM2,LM)
    449 C
    450      &, PMID  (IDIM1:IDIM2,LM),TMID  (IDIM1:IDIM2,LM)
    451      &, QMID  (IDIM1:IDIM2,LM),THMID(IDIM1:IDIM2,LM)
    452      &, OZN   (IDIM1:IDIM2,LM),POZN  (IDIM1:IDIM2,LM)
    453      &, MTOP(IDIM1:IDIM2,3),ICVB(IDIM1:IDIM2), ICVT(IDIM1:IDIM2)
    454      &, CV(IDIM1:IDIM2),SV(IDIM1:IDIM2)
    455 C
    456      &, FLWUP (IDIM1:IDIM2),FSWDN (IDIM1:IDIM2),FSWUP (IDIM1:IDIM2)
    457      &, FSWDNS(IDIM1:IDIM2),FSWUPS(IDIM1:IDIM2)
    458      &, FLWDNS(IDIM1:IDIM2),FLWUPS(IDIM1:IDIM2)
    459      &, PDSL  (IDIM1:IDIM2,JDIM1:JDIM2)
    460      &, FNE(IDIM1:IDIM2,JDIM1:JDIM2),FSE(IDIM1:IDIM2,JDIM1:JDIM2)
    461      &, TL (IDIM1:IDIM2,JDIM1:JDIM2)
    462                              D I M E N S I O N
    463      & PBOTL(IDIM1:IDIM2,JDIM1:JDIM2), PTOPL(IDIM1:IDIM2,JDIM1:JDIM2)
    464      &,PBOTM(IDIM1:IDIM2,JDIM1:JDIM2), PTOPM(IDIM1:IDIM2,JDIM1:JDIM2)
    465      &,PBOTH(IDIM1:IDIM2,JDIM1:JDIM2), PTOPH(IDIM1:IDIM2,JDIM1:JDIM2)
    466      &,TOT  (IDIM1:IDIM2,JDIM1:JDIM2)
    467                              D I M E N S I O N
    468      & CC(9),PPT(9)
    469                              D I M E N S I O N
    470      &  PINT(IDIM1:IDIM2,LP1),PHALF(LP1),CSTR(IDIM1:IDIM2)
    471      &, EMIS(IDIM1:IDIM2,LP1), TAUC(IDIM1:IDIM2)
    472      &, CVB(IDIM1:IDIM2),CVT(IDIM1:IDIM2),TAUDAR(IDIM1:IDIM2)
    473                              D I M E N S I O N
    474      & CAMT(IDIM1:IDIM2,LP1),NCLDS(IDIM1:IDIM2)

Page 5           Source Listing                  RADTN
2022-02-15 16:38                                 RADTN.F

    475      &,ITYP(IDIM1:IDIM2,LP1),KTOP(IDIM1:IDIM2,LP1)
    476      &,KBTM(IDIM1:IDIM2,LP1),RRCL(IDIM1:IDIM2,NB,LP1)
    477      &,TTCL(IDIM1:IDIM2,NB,LP1),KCLD(IDIM1:IDIM2)
    478 C--------------------CLOUD----------------------------------------------
    479                              D I M E N S I O N                          
    480      & CCR(IDIM1:IDIM2,LM),IW(IDIM1:IDIM2,LM),CSMID(IDIM1:IDIM2,LM)
    481      &,WMID(IDIM1:IDIM2,LM),HMID(IDIM1:IDIM2,LM)
    482      &,BMID(IDIM1:IDIM2),UMID(IDIM1:IDIM2)
    483      &,CCMID(IDIM1:IDIM2,LM)
    484 C--------------------CLOUD----------------------------------------------
    485                              D A T A
    486      1  PLOMD/64200./,PMDHI/35000./,PHITP/15000./,P400/40000./
    487      2, PLBTM/105000./
    488                              D A T A
    489      1  NFILE/14/
    490         DATA CC/0.,0.1,0.2,0.3,0.4,0.5,0.6,0.7,0.8/
    491         DATA PPT/.14,.31,.70,1.6,3.4,7.7,17.,38.,85./
    492 C----------------------------------------------------------------------
    493       UTIM=1.
    494       CNCLD=.TRUE.
    495 C***
    496 C***  ASSIGN THE PRESSURES FOR CLOUD DOMAIN BOUNDARIES
    497 C***
    498         PTOPC(1)=PLBTM
    499         PTOPC(2)=PLOMD
    500         PTOPC(3)=PMDHI
    501         PTOPC(4)=PHITP
    502 C***
    503 C***  FIND THE 'SEA LEVEL PRESSURE'.
    504 C***
    505       DO J=MYJS,MYJE
    506       DO I=MYIS,MYIE
    507         PDSL(I,J)=RES(I,J)*PD(I,J)
    508       ENDDO
    509       ENDDO
    510 C**********************************************************************
    511 C***  THE FOLLOWING CODE IS EXECUTED EACH TIME THE RADIATION IS CALLED.
    512 C**********************************************************************
    513 C----------------------CONVECTION--------------------------------------
    514 C  NRADPP IS THE NUMBER OF TIME STEPS TO ACCUMULATE CONVECTIVE PRECIP
    515 C     FOR RADIATION
    516 C   NOTE: THIS WILL NOT WORK IF NRADS AND NRADL ARE DIFFERENT UNLESS
    517 C         THEY ARE INTEGER MULTIPLES OF EACH OTHER
    518 C  CLSTP IS THE NUMBER OF HOURS OF THE ACCUMULATION PERIOD
    519 C
    520       NTSPH=NINT(3600./DT)
    521       NRADPP=MIN(NRADS,NRADL)
    522       CLSTP=1.0*NRADPP/NTSPH
    523 C----------------------CONVECTION--------------------------------------
    524 C***
    525 C***  STATE WHETHER THE SHORT OR LONGWAVE COMPUTATIONS ARE TO BE DONE.
    526 C***
    527       SHORT=.FALSE.
    528       LONG=.FALSE.
    529       IF(MOD(NTSD,NRADS).EQ.1.OR.RESTRT)SHORT=.TRUE.
    530       IF(MOD(NTSD,NRADL).EQ.1.OR.RESTRT)LONG=.TRUE.
    531       ITIMSW=0

Page 6           Source Listing                  RADTN
2022-02-15 16:38                                 RADTN.F

    532       ITIMLW=0
    533       IF(SHORT)ITIMSW=1
    534       IF(LONG) ITIMLW=1
    535 C-----------------------------------------------------------------------
    536 C***
    537 C***  FLAG FOR RESETTING CUPPT,HTOP,HBOT IN CHKOUT
    538 C***
    539       IF (MOD(NTSD,NRADPP).EQ.1) CURAD=.TRUE.
    540 C***
    541 C***  FIND THE MEAN COSINE OF THE SOLAR ZENITH ANGLE
    542 C***  BETWEEN THE CURRENT TIME AND THE NEXT TIME RADIATION IS
    543 C***  CALLED.  ONLY AVERAGE IF THE SUN IS ABOVE THE HORIZON.
    544 C***
    545       TIME=(NTSD-1)*DT
    546       CALL ZENITH(TIME,DAYI,HOUR)
    547       JD=INT(DAYI+0.50)
    548       ADDL=0.
    549       IF(MOD(IDAT(3),4).EQ.0)ADDL=1.
    550       RANG=PI2*(DAYI-RLAG)/(365.25+ADDL)
    551       RSIN1=SIN(RANG)
    552       RCOS1=COS(RANG)
    553       RCOS2=COS(2.*RANG)
    554       IF(SHORT)THEN
    555 !$omp parallel do private(i,j)
    556         DO J=MYJS,MYJE
    557         DO I=MYIS,MYIE
    558           CZMEAN(I,J)=0.
    559           TOT(I,J)=0.
    560         ENDDO
    561         ENDDO
    562 C
    563         DO II=0,NRADS,NPHS
    564           TIMES=(NTSD-1)*DT+II*DT
    565           CALL ZENITH(TIMES,DAYI,HOUR)
    566 !$omp parallel do private(i,j)
    567           DO J=MYJS,MYJE
    568           DO I=MYIS,MYIE
    569             IF(CZEN(I,J).GT.0.)THEN
    570               CZMEAN(I,J)=CZMEAN(I,J)+CZEN(I,J)
    571               TOT(I,J)=TOT(I,J)+1.
    572             ENDIF
    573           ENDDO
    574           ENDDO
    575         ENDDO
    576 !$omp parallel do private(i,j)
    577         DO J=MYJS,MYJE
    578         DO I=MYIS,MYIE
    579           IF(TOT(I,J).GT.0.)CZMEAN(I,J)=CZMEAN(I,J)/TOT(I,J)
    580         ENDDO
    581         ENDDO
    582       ENDIF
    583 C
    584 C2345678901234567890123456789012345678901234567890123456789012345678901
    585 !$omp parallel do
    586 c!$omp& private (aa,albedo,apes,bb,bcld,bit1,bit2,bitc,bitcp1,bits,
    587 !$omp& private (aa,albdo,apes,bb,bcld,bit1,bit2,bitc,bitcp1,bits,
    588 !$omp&          bitsp1,bitw,bitx,bity,bitz,bmid,btemp1,camt,

Page 7           Source Listing                  RADTN
2022-02-15 16:38                                 RADTN.F

    589 !$omp&          cc1,cc2,ccmid,ccr,cfravg,cl1,cl2,
    590 !$omp&          cldamt,cldcfr,cldmax,clpfil,cosz,cr1,
    591 !$omp&          csmid,cstr,cv,cwmkl,dd,ddp,delp,denom,
    592 !$omp&          dpcl,dthdp,ee,emis,exner,fctra,
    593 !$omp&          fctrb,ff,fiq,fiw,flwdns,flwup,flwups,fswdn,fswdns,
    594 !$omp&          fswup,fswups,gg,hh,hmid,i,icvb,icvt,ir,ityp,
    595 !$omp&          iw,iwkl,j,kbt1,kbt2,kbtm,kcld,kntlyr,
    596 !$omp&          kth1,kth2,ktop,ktop1,l,l400,lbase,lin,ll,
    597 !$omp&          llbot,lltop,lml,ltrop,lvlij,malvl,mbot,mtop,
    598 !$omp&          n,nband,nbtm,nc,ncld,nclds,nktp,nlvl,
    599 !$omp&          nmod,ozn,p1,p2,pdslij,pint,
    600 !$omp&          pmid,pmod,pozn,pp,prs1,prs2,psfc,qc,qi,qint,qkl,
    601 !$omp&          qmid,qsum,qw,rqkl,rrcl,slmsk,snofac,sv,
    602 !$omp&          tauc,taudar,tcld,tendl,tends,thmid,
    603 !$omp&          tkl,tmid,tmt0,tmt15,tskn,ttcl,
    604 !$omp&          u00kl,umid,us,wmid,xlat)
    605 c
    606 C********************************************************************
    607 C***  THIS IS THE BEGINNING OF THE PRIMARY LOOP THROUGH THE DOMAIN
    608 C********************************************************************
    609 C                        *********************
    610                          DO 700 J = MYJS, MYJE
    611 C                        *********************
    612 C
    613       DO 125 L=1,LM
    614       DO I=MYIS,MYIE
    615         IR=IRAD(I)
    616         TMID(I,L)=T(I,J,1)
    617         QMID(I,L)=EPSQ
    618         CSMID(I,L)=0.
    619         WMID(I,L)=0.
    620         CCMID(I,L)=0.
    621         IW(I,L)=0.
    622         CCR(I,L)=0.
    623         HMID(I,L)=0.
    624         OZN(I,L)=EPSO3
    625         TENDS(I,L)=0.
    626         TENDL(I,L)=0.
    627       ENDDO
    628   125 CONTINUE
    629 C
    630       DO 140 N=1,3
    631       DO I=MYIS,MYIE
    632         CLDCFR(I,N)=0.
    633         MTOP(I,N)=0
    634         MBOT(I,N)=0
    635       ENDDO
    636   140 CONTINUE
    637 C***
    638 C***  FILL IN WORKING ARRAYS WHERE VALUES AT L=LM ARE THOSE THAT
    639 C***  ARE ACTUALLY AT ETA LEVEL L=LMH.
    640 C***
    641       DO 200 I=MYIS,MYIE
    642       IR=IRAD(I)
    643       LML=LMH(I,J)
    644       LVLIJ=LVL(I,J)
    645 ctlb  BMID(I)=HBM2(IR,J)

Page 8           Source Listing                  RADTN
2022-02-15 16:38                                 RADTN.F

    646       BMID(I)=HBM2(I,J)
    647       UMID(I)=U00(I,J)
    648 C
    649       DO L=1,LML
    650         PMID(I,L+LVLIJ)=AETA(L)*PDSL(I,J)+PT
    651         PINT(I,L+LVLIJ+1)=ETAD(L+1)*PDSL(I,J)+PT
    652         EXNER=(1.E5/PMID(I,L+LVLIJ))**CAPA
    653         TMID(I,L+LVLIJ)=T(I,J,L)
    654         THMID(I,L+LVLIJ)=T(I,J,L)*EXNER
    655         QMID(I,L+LVLIJ)=Q(I,J,L)
    656         WMID(I,L+LVLIJ)=CWM(I,J,L)
    657         HMID(I,L+LVLIJ)=HTM(I,J,L)
    658       ENDDO
    659 C***
    660 C***  FILL IN ARTIFICIAL VALUES ABOVE THE TOP OF THE DOMAIN.
    661 C***  PRESSURE DEPTHS OF THESE LAYERS IS 1 HPA.
    662 C***  TEMPERATURES ABOVE ARE ALREADY ISOTHERMAL WITH (TRUE) LAYER 1.
    663 C***
    664       IF(LVLIJ.GT.0)THEN
    665         KNTLYR=0
    666 C
    667         DO L=LVLIJ,1,-1
    668           KNTLYR=KNTLYR+1
    669           PMID(I,L)=PT-REAL(2*KNTLYR-1)*0.5*HPINC
    670           PINT(I,L+1)=PMID(I,L)+0.5*HPINC
    671           EXNER=(1.E5/PMID(I,L))**CAPA
    672           THMID(I,L)=TMID(I,L)*EXNER
    673         ENDDO
    674       ENDIF
    675 C
    676       IF(LVLIJ.EQ.0) THEN
    677          PINT(I,1)=PT
    678       ELSE
    679          PINT(I,1)=PMID(I,1)-0.5*HPINC
    680       ENDIF
    681   200 CONTINUE
    682 C***
    683 C***  FILL IN THE SURFACE PRESSURE, SKIN TEMPERATURE, GEODETIC LATITUDE,
    684 C***  ZENITH ANGLE, SEA MASK, AND ALBEDO.  THE SKIN TEMPERATURE IS
    685 C***  NEGATIVE OVER WATER.
    686 C***
    687       DO 250 I=MYIS,MYIE
    688       PSFC(I)=PD(I,J)+PT
    689       APES=(PSFC(I)*1.E-5)**CAPA
    690       TSKN(I)=THS(I,J)*APES*(1.-2.*SM(I,J))
    691       if(mype.eq.13.and.i.eq.40.and.j.eq.77) then
    692         print*,'apes,sm(i,j),ths(i,j)=',apes,sm(i,j),ths(i,j)
    693       endif
    694       SLMSK(I)=SM(I,J)
    695 C
    696 C ----------------------------------------------------------------------
    697 c turn off snow albedo calculation since it is now calculated in SFLX.
    698 c      SNO(I,J)=AMAX1(SNO(I,J),0.)
    699 c      SNOFAC=AMIN1(SNO(I,J)/0.02, 1.0)
    700 c      ALBEDO(I)=ALB(I,J)+(1.0-VEGFRC(I,J))*SNOFAC*(SNOALB-ALB(I,J))
    701       ALBDO(I)=ALBEDO(I,J)
    702 C

Page 9           Source Listing                  RADTN
2022-02-15 16:38                                 RADTN.F

    703       XLAT(I)=GLAT(I,J)*RTD
    704       COSZ(I)=CZMEAN(I,J)
    705   250 CONTINUE
    706 C-----------------------------------------------------------------------
    707 C*******************STRATIFORM CLOUD SECTION***************************
    708 C-----------------------------------------------------------------------
    709 C  CALCULATE STRATIFORM CLOUD COVERAGE AT EACH MODEL GRID POINT WHICH
    710 C  WILL BE USED IN THE MODEL RADIATION PARAMETERIZATION SCHEME.
    711 C-----------------------------------------------------------------------
    712       US=1.                                                             
    713       CCLIMIT=1.0E-3                                                    
    714       CLIMIT =1.0E-20                                                   
    715 C------------------QW, QI AND QINT--------------------------------------
    716       DO 280 I=MYIS,MYIE
    717       LML=LMH(I,J)
    718       LVLIJ=LVL(I,J)
    719 C
    720       DO 275 L=1,LML
    721       LL=L+LVLIJ
    722       HH=HMID(I,LL)*BMID(I)
    723       TKL=TMID(I,LL)                                                   
    724       QKL=QMID(I,LL)                                                   
    725       CWMKL=WMID(I,LL)                                                 
    726       TMT0=(TKL-273.16)*HH                                              
    727       TMT15=AMIN1(TMT0,-15.)*HH                                         
    728       AI=0.008855
    729       BI=1.
    730 C
    731       IF(TMT0.LT.-20.)THEN
    732         AI=0.007225
    733         BI=0.9674
    734       ENDIF 
    735 C
    736       PP=PMID(I,LL)
    737       QW=HH*PQ0/PP*EXP(HH*A2*(TKL-A3)/(TKL-A4))                  
    738       QI=QW*(BI+AI*AMIN1(TMT0,0.))                               
    739       QINT=QW*(1.-0.00032*TMT15*(TMT15+15.))                        
    740       IF(TMT0.LE.-40.) QINT=QI                                    
    741 C-------------------ICE-WATER ID NUMBER IW------------------------------
    742       U00KL=UMID(I)+UL(L)*(0.95-UMID(I))*UTIM
    743       IF(TMT0.LT.-15.0)THEN
    744         FIQ=QKL-U00KL*QI    
    745         IF(FIQ.GT.0..OR.CWMKL.GT.CLIMIT)THEN                    
    746           IW(I,LL)=1                                                 
    747         ELSE                                                           
    748           IW(I,LL)=0                                                 
    749         ENDIF                                                         
    750       ENDIF
    751 C
    752       IF(TMT0.GE.0.)THEN
    753         IW(I,LL)=0                                                    
    754       ENDIF
    755 C
    756       IF(TMT0.LT.0.0.AND.TMT0.GE.-15.0)THEN
    757         IW(I,LL)=0
    758         IF(IW(I,LL-1).EQ.1.AND.CWMKL.GT.CLIMIT) IW(I,LL)=1 
    759       ENDIF

Page 10          Source Listing                  RADTN
2022-02-15 16:38                                 RADTN.F

    760 C
    761       IWKL=IW(I,LL)                                                    
    762 C
    763 C----------------THE SATURATION SPECIFIC HUMIDITY------------------------
    764 C
    765       FIW=FLOAT(IWKL)                                                   
    766       QC=(1.-FIW)*QINT+FIW*QI                                 
    767 C
    768 C----------------THE RELATIVE HUMIDITY----------------------------------
    769 C
    770       IF(QC.LE.EPSQ1.OR.QKL.LE.EPSQ1)THEN  
    771         RQKL=0.
    772       ELSE                                                             
    773         RQKL=QKL/QC                                                 
    774       ENDIF                                                             
    775 C
    776 C----------------CLOUD COVER RATIO CCR----------------------------------
    777 C
    778       IF(RQKL.GE.0.9999)THEN                                      
    779         CCR(I,LL)=AMIN1(US,RQKL) 
    780       ELSE                                                            
    781         ARG=-1000.*CWMKL/(US-RQKL)
    782         ARG=AMAX1(ARG,-25.)
    783         CCR(I,LL)= RQKL*(1.-EXP(ARG))
    784       ENDIF                                                             
    785       CSMID(I,LL)=AMIN1(US,CCR(I,LL))
    786 C----------------------------------------------------------------------
    787   275 CONTINUE
    788   280 CONTINUE
    789 C----------------------------------------------------------------------
    790 C**********************************************************************
    791 C NOW CHECK THE CLOUDS PRODUCED ABOVE TO MAKE SURE THEY ARE GOOD
    792 C ENOUGH FOR RADIATION CALCULATIONS
    793 C**********************************************************************
    794 C***
    795 C***  NO STRATIFORM CLOUDS FOR THIS TYPE
    796 C***
    797       DO 350 I=MYIS,MYIE
    798 C
    799       LML=LMH(I,J)
    800       LVLIJ=LVL(I,J)
    801 C***
    802 C***  ZERO OUT CLDAMT IF LAND AND BELOW PBOT ABOVE GROUND
    803 C***
    804       IF(SM(I,J).LT.0.5)THEN
    805         DO L=1,LML
    806           LL=LML-L+1+LVLIJ
    807           DDP=PSFC(I)-PMID(I,LL)
    808           IF(DDP.GE.PBOT) GO TO 290
    809           CSMID(I,LL)=0.
    810         ENDDO
    811   290   CONTINUE
    812       ENDIF
    813 C***
    814 C***  CHECK FOR OCEAN STRATUS (LOW CLOUD)
    815 C***  LOOK ONLY OVER OCEAN AND ONLY IF AN INVERSION (DTHDP.LE.-0.05)
    816 C***  IS PRESENT WITH AT LEAST 2 CLOUD FREE LAYERS ABOVE IT

Page 11          Source Listing                  RADTN
2022-02-15 16:38                                 RADTN.F

    817 C***
    818       IF(SM(I,J).GT.0.5)THEN
    819 C
    820 C***  FIND BASE OF INVERSION
    821 C
    822         LBASE=LM
    823         DO L=1,LML-1
    824           LL=LML-L+1+LVLIJ
    825           DTHDP=(THMID(I,LL-1)-THMID(I,LL))
    826      &          /(PMID(I,LL-1)-PMID(I,LL))
    827           IF(DTHDP.LE.CLAPSE)THEN
    828             LBASE=LL
    829             GO TO 300
    830           ENDIF
    831         ENDDO
    832   300   CONTINUE
    833 C
    834 C***  CHECK 2 LAYERS ABOVE LBASE FOR DRYNESS
    835 C
    836         IF(CSMID(I,LBASE-1).LE.0..AND.CSMID(I,LBASE-2).LE.0.
    837      1                               .AND.LBASE.LT.LM)THEN
    838           IF(DTHDP.GT.CLPSE)THEN
    839             CLPFIL=1.-((CLPSE-DTHDP)/DCLPS)
    840           ELSE
    841             CLPFIL=1.
    842           ENDIF
    843 C
    844           DO L=1,LML
    845             LL=LML-L+1+LVLIJ
    846             DDP=PSFC(I)-PMID(I,LL)
    847             IF(DDP.GE.PBOT) GO TO 310
    848             CSMID(I,LL)=CSMID(I,LL)*CLPFIL
    849           ENDDO
    850   310     CONTINUE
    851 C
    852 C***  IF NO INVERSION OR IF CLDS EXIST IN EITHER OF THE 2 LAYERS ABOVE
    853 C***  INVERSION, ZERO OUT CLOUD BELOW PBOT
    854 C
    855         ELSE
    856           DO L=1,LML
    857             LL=LML-L+1+LVLIJ
    858             DDP=PSFC(I)-PMID(I,LL)
    859             IF(DDP.GE.PBOT) GO TO 320
    860             CSMID(I,LL)=0.
    861           ENDDO
    862   320     CONTINUE
    863 C
    864         ENDIF
    865 C------------
    866       ENDIF
    867 C------------
    868 C***
    869 C***  REMOVE HIGH CLOUDS ABOVE THE TROPOPAUSE
    870 C***
    871       L400=LM
    872       DO L=1,LML
    873         LL=LML-L+1+LVLIJ

Page 12          Source Listing                  RADTN
2022-02-15 16:38                                 RADTN.F

    874         IF(PMID(I,LL).LE.40000.0)THEN
    875           L400=LL
    876           GO TO 330
    877         ENDIF
    878       ENDDO
    879   330 CONTINUE
    880 C
    881       LTROP=LM
    882       DO LL=L400,2,-1
    883         DTHDP=(THMID(I,LL-1)-THMID(I,LL))
    884      1         /(PMID(I,LL-1)-PMID(I,LL))
    885 C
    886         IF(DTHDP.LT.-0.0025.OR.QMID(I,LL).LE.EPSQ1)THEN
    887           LTROP=LL
    888           GOTO 340
    889         ENDIF
    890       ENDDO
    891   340 IF(LTROP.LT.LM)THEN
    892         DO LL=LTROP,1,-1
    893           CSMID(I,LL)=0.
    894         ENDDO
    895       ENDIF
    896   350 CONTINUE
    897 C
    898 C*********************************************************************
    899 C*****************END OF STRATIFORM CLOUD SECTION*****************
    900 C------------------------CONVECTION--------------------------------
    901 C***
    902 C***  CONVECTIVE CLOUD SECTION
    903 C***
    904 C*** THIS PART WAS MODIFIED TO COMPUTE CONVECTIVE CLOUDS AT EACH
    905 C*** MODEL LAYER BASED ON CONVECTIVE PRECIPITATION RATES. CURRENTLY,
    906 C*** CLOUDS ARE SET TO 0.75*CV(I) BELOW 400MB
    907 C*** AND    0.90*CV(I) ABOVE 400MB TO ACCOUNT FOR CIRRUS CAP
    908 C***                                       Q.ZHAO   95-3-22
    909 C
    910 C***
    911 C*** NON-PRECIPITATING CLOUD FRACTION OF 20 PERCENT IS ADDED AT
    912 C*** AT POINTS WHERE THE SHALLOW AND DEEP CONVECTIONS ACCUR.
    913 C***                                        Q. ZHAO  97-5-2
    914 C
    915 C   COMPUTE THE CONVECTIVE CLOUD COVER FOR RADIATION
    916 C
    917 C-----------------------------------------------------------------
    918       IF(CNCLD)THEN
    919 C-----------------------------------------------------------------
    920         DO 375 I=MYIS,MYIE
    921         IF(HBOT(I,J)-HTOP(I,J).GT.1.0)THEN
    922 C       IF(HTOP(I,J).LT.HBOT(I,J))THEN
    923           SV(I)=0.0
    924         ELSE
    925           SV(I)=0.0
    926         ENDIF
    927 C
    928         PMOD=CUPPT(I,J)*24.0*1000.0/CLSTP
    929         NMOD=0
    930 C

Page 13          Source Listing                  RADTN
2022-02-15 16:38                                 RADTN.F

    931         DO NC=1,9
    932           IF(PMOD.GT.PPT(NC)) NMOD=NC
    933         ENDDO
    934 C
    935 C***  CLOUD TOPS AND BOTTOMS COME FROM CUCNVC
    936 C***  ADD LVL TO BE CONSISTENT WITH OTHER WORKING ARRAYS
    937 C
    938         IF(NMOD.EQ.0)THEN
    939           CV(I)=0.
    940         ELSEIF(NMOD.EQ.9)THEN
    941           CV(I)=CC(9)
    942         ELSE
    943           CC1=CC(NMOD)
    944           CC2=CC(NMOD+1)
    945           P1=PPT(NMOD)
    946           P2=PPT(NMOD+1)
    947           CV(I)=CC1+(CC2-CC1)*(PMOD-P1)/(P2-P1)
    948         ENDIF
    949 C
    950         CV(I)=AMAX1(SV(I),CV(I))
    951         CV(I)=AMIN1(1.0,CV(I))
    952 C
    953         IF(CV(I).EQ.0.0)THEN
    954           ICVT(I)=0
    955           ICVB(I)=0
    956         ELSE
    957           ICVT(I)=INT(HTOP(I,J)+0.50)+LVL(I,J)
    958           ICVB(I)=INT(HBOT(I,J)+0.50)+LVL(I,J)
    959         ENDIF
    960   375   CONTINUE
    961 C***
    962 C***  MAKE SURE CLOUDS ARE DEEP ENOUGH
    963 C***
    964         DO I=MYIS,MYIE
    965           BCLD(I)=CV(I).GT.0..AND.
    966      1           (ICVB(I)-ICVT(I)).GE.1
    967           BTEMP1(I)=BCLD(I)
    968         ENDDO
    969 C***
    970 C*** COMPUTE CONVECTIVE CLOUD FRACTION
    971 C***
    972         DO 390 I=MYIS,MYIE
    973         IF(BCLD(I)) THEN
    974           LML=LMH(I,J)
    975           LVLIJ=LVL(I,J)
    976 C
    977           DO L=1,LML
    978             LL=L+LVLIJ
    979             IF(LL.GT.ICVB(I).OR.LL.LT.ICVT(I))THEN
    980               CCMID(I,LL)=0.
    981             ELSE
    982               CCMID(I,LL)=CV(I)
    983             ENDIF
    984             CCMID(I,LL)=AMIN1(1.0,CCMID(I,LL))
    985           ENDDO
    986         ENDIF
    987   390   CONTINUE

Page 14          Source Listing                  RADTN
2022-02-15 16:38                                 RADTN.F

    988 C***
    989 C***  REMOVE HIGH CLOUDS ABOVE THE TROPOPAUSE
    990 C***
    991         L400=LM
    992         DO 425 I=MYIS,MYIE
    993         LML=LMH(I,J)
    994         LVLIJ=LVL(I,J)
    995 C
    996         DO L = 1, LML
    997           LL=LML-L+1+LVLIJ
    998           IF(PMID(I,LL).LE.40000.0)THEN
    999             L400=LL
   1000             GO TO 400
   1001           ENDIF
   1002         ENDDO
   1003   400   CONTINUE
   1004 C
   1005         LTROP=LM
   1006         DO LL=L400,2,-1
   1007           DTHDP=(THMID(I,LL-1)-THMID(I,LL))
   1008      1         /(PMID(I,LL-1)-PMID(I,LL))
   1009           IF(DTHDP.LT.-0.0025.OR.QMID(I,LL).LE.EPSQ1)THEN
   1010             LTROP=LL
   1011             GOTO 410
   1012           ENDIF
   1013         ENDDO
   1014   410   IF(LTROP.LT.LM)THEN
   1015          DO LL=LTROP,1,-1
   1016            CCMID(I,LL)=0.
   1017          ENDDO
   1018         ENDIF
   1019   425   CONTINUE
   1020 C***
   1021 C-----------------------------------------------------------------
   1022       ENDIF
   1023 C------------------------CONVECTION--------------------------------
   1024 C*****************END OF CONVECTIVE CLOUD SECTION*****************
   1025 C*********************************************************************
   1026 C***
   1027 C***  DETERMINE THE FRACTIONAL CLOUD COVERAGE FOR HIGH, MID
   1028 C***  AND LOW OF CLOUDS FROM THE CLOUD COVERAGE AT EACH LEVEL
   1029 C***
   1030 C***  NOTE: THIS IS FOR DIAGNOSTICS ONLY!!!
   1031 C***
   1032 C***
   1033       DO 500 I=MYIS,MYIE
   1034 C
   1035       CSTR(I)=0.0
   1036 C
   1037       DO L=0,LM
   1038         CLDAMT(L)=0.
   1039       ENDDO
   1040 C
   1041 C***  NOW GOES LOW, MIDDLE, HIGH
   1042 C
   1043       DO 480 NLVL=1,3
   1044       CLDMAX=0.

Page 15          Source Listing                  RADTN
2022-02-15 16:38                                 RADTN.F

   1045       MALVL=LM
   1046       LLTOP=LTOP(NLVL)+LVL(I,J)
   1047 C***
   1048 C***  GO TO THE NEXT CLOUD LAYER IF THE TOP OF THE CLOUD-TYPE IN
   1049 C***  QUESTION IS BELOW GROUND OR IS IN THE LOWEST LAYER ABOVE GROUND.
   1050 C***
   1051       IF(LLTOP.GE.LM)GO TO 480
   1052 C
   1053       IF(NLVL.GT.1)THEN
   1054         LLBOT=LTOP(NLVL-1)-1+LVL(I,J)
   1055         LLBOT=MIN(LLBOT,LM1)
   1056       ELSE
   1057         LLBOT=LM1
   1058       ENDIF
   1059 C
   1060       DO 435 L=LLTOP,LLBOT
   1061       CLDAMT(L)=AMAX1(CSMID(I,L),CCMID(I,L))
   1062       IF(CLDAMT(L).GT.CLDMAX)THEN
   1063         MALVL=L
   1064         CLDMAX=CLDAMT(L)
   1065       ENDIF
   1066   435 CONTINUE
   1067 C*********************************************************************
   1068 C NOW, CALCULATE THE TOTAL CLOUD FRACTION IN THIS PRESSURE DOMAIN
   1069 C USING THE METHOD DEVELOPED BY Y.H., K.A.C. AND A.K. (NOV., 1992).
   1070 C IN THIS METHOD, IT IS ASSUMED THAT SEPERATED CLOUD LAYERS ARE
   1071 C RADOMLY OVERLAPPED AND ADJACENT CLOUD LAYERS ARE MAXIMUM OVERLAPPED.
   1072 C VERTICAL LOCATION OF EACH TYPE OF CLOUD IS DETERMINED BY THE THICKEST
   1073 C CONTINUING CLOUD LAYERS IN THE DOMAIN.
   1074 C*********************************************************************
   1075       CL1=0.0
   1076       CL2=0.0
   1077       KBT1=LLBOT
   1078       KBT2=LLBOT
   1079       KTH1=0
   1080       KTH2=0
   1081 C
   1082       DO 450 LL=LLTOP,LLBOT
   1083       L=LLBOT-LL+LLTOP
   1084       BIT1=.FALSE.
   1085       CR1=CLDAMT(L)
   1086       BITX=(PINT(I,L).GE.PTOPC(NLVL+1)).AND.
   1087      1     (PINT(I,L).LT.PTOPC(NLVL)).AND.
   1088      2     (CLDAMT(L).GT.0.0)
   1089       BIT1=BIT1.OR.BITX
   1090       IF(.NOT.BIT1)GO TO 450
   1091 C***
   1092 C***  BITY=T: FIRST CLOUD LAYER; BITZ=T:CONSECUTIVE CLOUD LAYER
   1093 C***  NOTE:  WE ASSUME THAT THE THICKNESS OF EACH CLOUD LAYER IN THE
   1094 C***         DOMAIN IS LESS THAN 200 MB TO AVOID TOO MUCH COOLING OR
   1095 C***         HEATING. SO WE SET CTHK(NLVL)=200*E2. BUT THIS LIMIT MAY
   1096 C***         WORK WELL FOR CONVECTIVE CLOUDS. MODIFICATION MAY BE
   1097 C***         NEEDED IN THE FUTURE.
   1098 C***
   1099       BITY=BITX.AND.(KTH2.LE.0)
   1100       BITZ=BITX.AND.(KTH2.GT.0)
   1101 C

Page 16          Source Listing                  RADTN
2022-02-15 16:38                                 RADTN.F

   1102       IF(BITY)THEN
   1103         KBT2=L
   1104         KTH2=1
   1105       ENDIF
   1106 C
   1107       IF(BITZ)THEN
   1108         KTOP1=KBT2-KTH2+1
   1109         DPCL=PMID(I,KBT2)-PMID(I,KTOP1)
   1110         IF(DPCL.LT.CTHK(NLVL))THEN
   1111           KTH2=KTH2+1
   1112         ELSE
   1113           KBT2=KBT2-1
   1114         ENDIF
   1115       ENDIF
   1116       IF(BITX)CL2=AMAX1(CL2,CR1)
   1117 C***
   1118 C*** AT THE DOMAIN BOUNDARY OR SEPARATED CLD LAYERS, RANDOM OVERLAP.
   1119 C*** CHOOSE THE THICKEST OR THE LARGEST FRACTION AMT AS THE CLD
   1120 C*** LAYER IN THAT DOMAIN.
   1121 C***
   1122       BIT2=.FALSE.
   1123       BITY=BITX.AND.(CLDAMT(L-1).LE.0.0.OR.
   1124      1     PINT(I,L-1).LT.PTOPC(NLVL+1))
   1125       BITZ=BITY.AND.CL1.GT.0.0
   1126       BITW=BITY.AND.CL1.LE.0.0
   1127       BIT2=BIT2.OR.BITY
   1128       IF(.NOT.BIT2)GO TO 450
   1129 C
   1130       IF(BITZ)THEN
   1131         KBT1=INT((CL1*KBT1+CL2*KBT2)/(CL1+CL2))
   1132         KTH1=INT((CL1*KTH1+CL2*KTH2)/(CL1+CL2))+1
   1133         CL1=CL1+CL2-CL1*CL2
   1134       ENDIF
   1135 C
   1136       IF(BITW)THEN
   1137         KBT1=KBT2
   1138         KTH1=KTH2
   1139         CL1=CL2
   1140       ENDIF
   1141 C
   1142       IF(BITY)THEN
   1143         KBT2=LLBOT
   1144         KTH2=0
   1145         CL2=0.0
   1146       ENDIF
   1147   450 CONTINUE
   1148 C***
   1149       CLDCFR(I,NLVL)=AMIN1(1.0,CL1)
   1150       MTOP(I,NLVL)=MIN(KBT1,KBT1-KTH1+1)
   1151       MBOT(I,NLVL)=KBT1
   1152   480 CONTINUE
   1153   500 CONTINUE
   1154 C***
   1155 C***  SET THE UN-NEEDED TAUDAR TO ONE
   1156 C***
   1157       DO I=MYIS,MYIE
   1158         TAUDAR(I)=1.0

Page 17          Source Listing                  RADTN
2022-02-15 16:38                                 RADTN.F

   1159       ENDDO
   1160 C----------------------------------------------------------------------
   1161 C NOW, CALCULATE THE CLOUD RADIATIVE PROPERTIES AFTER DAVIS (1982),
   1162 C HARSHVARDHAN ET AL (1987) AND Y.H., K.A.C. AND A.K. (1993).
   1163 C
   1164 C UPDATE: THE FOLLOWING PARTS ARE MODIFIED, AFTER Y.T.H. (1994), TO
   1165 C         CALCULATE THE RADIATIVE PROPERTIES OF CLOUDS ON EACH MODEL
   1166 C         LAYER. BOTH CONVECTIVE AND STRATIFORM CLOUDS ARE USED
   1167 C         IN THIS CALCULATIONS.
   1168 C
   1169 C                                     QINGYUN ZHAO   95-3-22
   1170 C
   1171 C----------------------------------------------------------------------
   1172 C
   1173 C***
   1174 C*** INITIALIZE ARRAYS FOR USES LATER
   1175 C***
   1176 
   1177       DO 600 I=MYIS,MYIE
   1178       LML=LMH(I,J)
   1179       LVLIJ=LVL(I,J)
   1180 C
   1181 C***
   1182 C*** NOTE: LAYER=1 IS THE SURFACE, AND LAYER=2 IS THE FIRST CLOUD
   1183 C***       LAYER ABOVE THE SURFACE AND SO ON.
   1184 C***
   1185       EMIS(I,1)=1.0
   1186       KTOP(I,1)=LP1
   1187       KBTM(I,1)=LP1
   1188       CAMT(I,1)=1.0
   1189       ITYP(I,1)=0
   1190       KCLD(I)=2
   1191 C
   1192       DO NBAND=1,NB
   1193         RRCL(I,NBAND,1)=0.0
   1194         TTCL(I,NBAND,1)=1.0
   1195       ENDDO
   1196 C
   1197       DO 510 L=2,LP1
   1198       ITYP(I,L)=0
   1199       CAMT(I,L)=0.0
   1200       KTOP(I,L)=1
   1201       KBTM(I,L)=1
   1202       EMIS(I,L)=0.0
   1203 C
   1204       DO NBAND=1,NB
   1205         RRCL(I,NBAND,L)=0.0
   1206         TTCL(I,NBAND,L)=1.0
   1207       ENDDO
   1208   510 CONTINUE
   1209 C***
   1210 C*** NOW CALCULATE THE AMOUNT, TOP, BOTTOM AND TYPE OF EACH CLOUD LAYER
   1211 C*** CLOUD TYPE=1: STRATIFORM CLOUD
   1212 C***       TYPE=2: CONVECTIVE CLOUD
   1213 C*** WHEN BOTH CONVECTIVE AND STRATIFORM CLOUDS EXIST AT THE SAME POINT,
   1214 C*** SELECT CONVECTIVE CLOUD (TYPE=2),IN OTHER WORDS, CONVECTIVE CLOUDS
   1215 C*** HAVE THE HIGHER PRIORITY THAN STRATIFORM CLOUDS.

Page 18          Source Listing                  RADTN
2022-02-15 16:38                                 RADTN.F

   1216 C*** CLOUD LAYERS ARE SEPARATED BY:
   1217 C***       1. NO-CLOUD LAYER
   1218 C***       2. DIFFERENT CLOUD TYPE
   1219 C*** NOTE: THERE IS ONLY ONE CONVECTIVE CLOUD LAYER IN ONE COLUMN.
   1220 C*** KTOP AND KBTM ARE THE TOP AND BOTTOM OF EACH CLOUD LAYER IN TERMS O
   1221 C*** ETA MODEL LEVEL.
   1222 C***
   1223       DO 540 L=2,LML
   1224       LL=LML-L+1+LVLIJ
   1225       BITC=CCMID(I,LL).GT.0.1
   1226       BITS=CSMID(I,LL).GT.0.1
   1227       BITCP1=CCMID(I,LL+1).GT.0.1
   1228       BITSP1=CSMID(I,LL+1).GT.0.1
   1229       BIT1=BITS.OR.BITC
   1230 C-------------------
   1231       IF(BIT1)THEN
   1232 C-------------------
   1233         IF(ITYP(I,KCLD(I)).EQ.0)THEN
   1234           CAMT(I,KCLD(I))=CSMID(I,LL)
   1235           ITYP(I,KCLD(I))=1
   1236           KBTM(I,KCLD(I))=LL
   1237 C
   1238           IF(BITC)THEN
   1239             CAMT(I,KCLD(I))=CCMID(I,LL)
   1240             ITYP(I,KCLD(I))=2
   1241           ENDIF 
   1242         ELSE
   1243           IF(BITC)THEN
   1244             IF(BITCP1)THEN
   1245               CAMT(I,KCLD(I))=AMAX1(CAMT(I,KCLD(I)),CCMID(I,LL))
   1246             ELSE
   1247               KCLD(I)=KCLD(I)+1
   1248               CAMT(I,KCLD(I))=CCMID(I,LL)
   1249               ITYP(I,KCLD(I))=2
   1250               KTOP(I,KCLD(I)-1)=LL+1
   1251               KBTM(I,KCLD(I))=LL
   1252             ENDIF
   1253           ELSE
   1254             IF(BITCP1)THEN
   1255               KCLD(I)=KCLD(I)+1
   1256               CAMT(I,KCLD(I))=CSMID(I,LL)
   1257               ITYP(I,KCLD(I))=1
   1258               KTOP(I,KCLD(I)-1)=LL+1
   1259               KBTM(I,KCLD(I))=LL
   1260             ELSE
   1261               CAMT(I,KCLD(I))=AMAX1(CAMT(I,KCLD(I)),CSMID(I,LL))
   1262             ENDIF
   1263           ENDIF 
   1264         ENDIF 
   1265 C-------------------
   1266       ELSE
   1267 C-------------------
   1268         IF(BITCP1.OR.BITSP1)THEN
   1269           KCLD(I)=KCLD(I)+1
   1270           KTOP(I,KCLD(I)-1)=LL+1
   1271           ITYP(I,KCLD(I))=0
   1272           CAMT(I,KCLD(I))=0.0

Page 19          Source Listing                  RADTN
2022-02-15 16:38                                 RADTN.F

   1273         ENDIF
   1274 C-------------------
   1275       ENDIF
   1276 C-------------------
   1277   540 CONTINUE
   1278 C***
   1279 C*** THE REAL NUMBER OF CLOUD LAYERS IS (THE FIRST IS THE GROUNG;
   1280 C*** THE LAST IS THE SKY):
   1281 C***
   1282       NCLDS(I)=KCLD(I)-2
   1283       NCLD=NCLDS(I)
   1284 C***
   1285 C***  NOW CALCULATE CLOUD RADIATIVE PROPERTIES
   1286 C***
   1287       IF(NCLD.GE.1)THEN
   1288 C***
   1289 C*** NOTE: THE FOLLOWING CALCULATIONS, THE UNIT FOR PRESSURE IS MB!!!
   1290 C***
   1291         DO 580 NC=2,NCLD+1
   1292 C
   1293         TAUC(I)=0.0
   1294         QSUM=0.0
   1295         NKTP=LP1
   1296         NBTM=0
   1297         BITX=CAMT(I,NC).GT.0.1
   1298         NKTP=MIN(NKTP,KTOP(I,NC))
   1299         NBTM=MAX(NBTM,KBTM(I,NC))
   1300 C
   1301         DO 560 LL=NKTP,NBTM
   1302         IF(LL.GE.KTOP(I,NC).AND.LL.LE.KBTM(I,NC).AND.BITX)THEN
   1303           PRS1=PINT(I,LL)*0.01
   1304           PRS2=PINT(I,LL+1)*0.01
   1305           DELP=PRS2-PRS1
   1306           TCLD=TMID(I,LL)-273.16
   1307           QSUM=QSUM+QMID(I,LL)*DELP*(PRS1+PRS2)
   1308      1         /(120.1612*SQRT(TMID(I,LL)))
   1309 C***
   1310 C*** FOR CONVECTIVE CLOUD OR STARTIFORM CLOUD WITH TOP ABOVE 500MB
   1311 C***
   1312           IF(ITYP(I,NC).EQ.2
   1313      1           .OR.PINT(I,KTOP(I,NC)).LE.PTOPC(3))THEN
   1314             IF(TCLD.LE.-10.0)THEN
   1315               TAUC(I)=TAUC(I)+DELP*AMAX1(0.1E-3,
   1316      1                 2.0E-6*(TCLD+82.5)**2)
   1317             ELSE
   1318 	      TAUC(I)=TAUC(I)+DELP*AMIN1(0.08,6.949E-3*TCLD+0.1)
   1319             ENDIF
   1320           ELSE
   1321 C***
   1322 C***  FOR LOW AND MID STRATIFORM CLOUDS
   1323 C***
   1324             IF(TCLD.LE.-20.0)THEN
   1325               TAUC(I)=TAUC(I)+DELP*AMAX1(0.1E-3,2.56E-5*
   1326      1               (TCLD+82.5)**2)
   1327             ELSE
   1328               TAUC(I)=TAUC(I)+DELP*0.1
   1329             ENDIF

Page 20          Source Listing                  RADTN
2022-02-15 16:38                                 RADTN.F

   1330           ENDIF
   1331         ENDIF
   1332   560   CONTINUE
   1333 C
   1334         IF(BITX)EMIS(I,NC)=1.0-EXP(-0.75*TAUC(I))
   1335         IF(QSUM.GE.EPSQ1)THEN
   1336 C
   1337           DO 570 NBAND=1,NB
   1338           IF(BITX)THEN
   1339             PROD=ABCFF(NBAND)*QSUM
   1340             DDX=TAUC(I)/(TAUC(I)+PROD)
   1341             EEX=1.0-DDX
   1342             IF(ABS(EEX).GE.1.E-8)THEN
   1343               DD=DDX
   1344               EE=EEX
   1345               FF=1.0-DD*0.85
   1346               AA=MIN(50.0,SQRT(3.0*EE*FF)*TAUC(I))
   1347               AA=EXP(-AA)
   1348               BB=FF/EE
   1349               GG=SQRT(BB)
   1350               DD=(GG+1.0)*(GG+1.0)-(GG-1.0)*(GG-1.0)*AA*AA
   1351               RRCL(I,NBAND,NC)=MAX(0.1E-5,(BB-1.0)*(1.0-AA*AA)/DD)
   1352               TTCL(I,NBAND,NC)=AMAX1(0.1E-5,4.0*GG*AA/DD)
   1353             ENDIF
   1354           ENDIF
   1355   570     CONTINUE
   1356         ENDIF
   1357   580   CONTINUE
   1358 C
   1359       ENDIF
   1360 C
   1361   600 CONTINUE
   1362 C*********************************************************************
   1363 C******************  COMPUTE OZONE AT MIDLAYERS  *********************
   1364 C*********************************************************************
   1365 C
   1366 C***  MODIFY PRESSURES SO THAT THE ENTIRE COLUMN OF OZONE (TO 0 MB)
   1367 C***  IS INCLUDED IN THE MODEL COLUMN EVEN WHEN PT > 0 MB
   1368 C***
   1369       DO L=1,LM
   1370       DO I=MYIS,MYIE
   1371         DENOM=1./(PINT(I,LP1)-PINT(I,1))
   1372         FCTRA=PINT(I,LP1)*DENOM
   1373         FCTRB=-PINT(I,1)*PINT(I,LP1)*DENOM
   1374         POZN(I,L)=PMID(I,L)*FCTRA+FCTRB
   1375       ENDDO
   1376       ENDDO
   1377 C
   1378       CALL OZON2D(LM,POZN,XLAT,RSIN1,RCOS1,RCOS2,OZN)
   1379 C
   1380 C***
   1381 C***  NOW THE VARIABLES REQUIRED BY RADFS HAVE BEEN CALCULATED.
   1382 C***
   1383 C----------------------------------------------------------------------
   1384 C***
   1385 C***  CALL THE GFDL RADIATION DRIVER
   1386 C***

Page 21          Source Listing                  RADTN
2022-02-15 16:38                                 RADTN.F

   1387 C***
   1388       CALL RADFS
   1389 c     1     (PSFC,PMID,PINT,QMID,TMID,OZN,TSKN,SLMSK,ALBEDO,XLAT
   1390      1     (PSFC,PMID,PINT,QMID,TMID,OZN,TSKN,SLMSK,ALBDO,XLAT
   1391      2,     CAMT,ITYP,KTOP,KBTM,NCLDS,EMIS,RRCL,TTCL 
   1392      3,     COSZ,TAUDAR,1
   1393      4,     1,0 
   1394      5,     ETAD,AETA,ITIMSW,ITIMLW,JD,R1,HOUR,TENDS,TENDL
   1395      6,     FLWUP,FSWUP,FSWDN,FSWDNS,FSWUPS,FLWDNS,FLWUPS)
   1396 C----------------------------------------------------------------------
   1397       DO 650 I=MYIS,MYIE
   1398       PDSLIJ=PDSL(I,J)
   1399       PMOD=CUPPT(I,J)*24.0*1000.0/CLSTP
   1400       CFRACL(I,J)=CLDCFR(I,1)
   1401       CFRACM(I,J)=CLDCFR(I,2)
   1402       CFRACH(I,J)=CLDCFR(I,3)
   1403 C
   1404 C***  ARRAYS ACFRST AND ACFRCV ACCUMULATE AVERAGE STRATIFORM AND
   1405 C***  CONVECTIVE CLOUD FRACTIONS, RESPECTIVELY.  THIS INFORMATION
   1406 C***  IS PASSED TO THE POST PROCESSOR VIA COMMON BLOCK ACMCLD.
   1407 C
   1408       CFRAVG=AMAX1(CFRACL(I,J),AMAX1(CFRACM(I,J),CFRACH(I,J)))
   1409       IF(CNCLD)THEN
   1410         IF(PMOD.LE.PPT(1))THEN
   1411           ACFRST(I,J)=ACFRST(I,J)+CFRAVG
   1412           NCFRST(I,J)=NCFRST(I,J)+1
   1413         ELSE
   1414           ACFRCV(I,J)=ACFRCV(I,J)+CFRAVG
   1415           NCFRCV(I,J)=NCFRCV(I,J)+1
   1416         ENDIF
   1417       ELSE
   1418         ACFRST(I,J)=ACFRST(I,J)+CFRAVG
   1419         NCFRST(I,J)=NCFRST(I,J)+1
   1420       ENDIF
   1421   650 CONTINUE
   1422 C***
   1423 C***  COLLECT ATMOSPHERIC TEMPERATURE TENDENCIES DUE TO RADIATION.
   1424 C***  ALSO COLLECT THE TOTAL SW AND INCOMING LW RADIATION (W/M**2)
   1425 C***  AND CONVERT TO FORM NEEDED FOR PREDICTION OF THS IN SURFCE.
   1426 C***
   1427       DO 660 I=MYIS,MYIE
   1428       DO L=1,LM
   1429         LL=LVL(I,J)+L
   1430         IF(SHORT)RSWTT(I,J,L)=TENDS(I,LL)
   1431         IF(LONG) RLWTT(I,J,L)=TENDL(I,LL)
   1432 c       if(mype.eq.13.and.i.eq.40.and.j.eq.77) then
   1433 c        print*,'l,ll,tendl(i,ll),rlwtt(i,j,l)=',
   1434 c    *    l,ll,tendl(i,ll),rlwtt(i,j,l)
   1435 c       endif
   1436         IF(LL.EQ.LM)GO TO 660
   1437       ENDDO
   1438   660 CONTINUE
   1439 C***
   1440 C***  SUM THE LW INCOMING AND SW RADIATION (W/M**2) FOR RADIN.
   1441 C***
   1442       DO 675 I=MYIS,MYIE
   1443       IF(LONG)THEN

Page 22          Source Listing                  RADTN
2022-02-15 16:38                                 RADTN.F

   1444         SIGT4(I,J)=STBOL*TMID(I,LM)*TMID(I,LM)*
   1445      1             TMID(I,LM)*TMID(I,LM)
   1446       ENDIF
   1447 C
   1448 C***  ACCUMULATE VARIOUS LW AND SW RADIATIVE FLUXES FOR POST
   1449 C***  PROCESSOR.  PASSED VIA COMMON ACMRDL AND ACMRDS.
   1450 C
   1451       IF(LONG)THEN
   1452         RLWIN(I,J) =FLWDNS(I)
   1453         RLWOUT(I,J)=FLWUPS(I)
   1454         RLWTOA(I,J)=FLWUP(I)
   1455       ENDIF
   1456       IF(SHORT)THEN
   1457         RSWIN(I,J) =FSWDNS(I)
   1458         RSWOUT(I,J)=FSWUPS(I)
   1459         RSWTOA(I,J)=FSWUP(I)
   1460       ENDIF
   1461   675 CONTINUE
   1462 C***
   1463 C***  THIS ROW IS FINISHED. GO TO NEXT
   1464 C***
   1465 C                        *********************
   1466   700                          CONTINUE
   1467 C                        *********************
   1468 C----------------------------------------------------------------------
   1469 C***
   1470 C***  CALLS TO RADIATION THIS TIME STEP ARE COMPLETE.
   1471 C***
   1472 C----------------------------------------------------------------------
   1473 C----------------------------------------------------------------------
   1474 C***
   1475 C***  HORIZONTAL SMOOTHING OF TEMPERATURE TENDENCIES
   1476 C***
   1477 C----------------------------------------------------------------------
   1478       IF(SHORT) THEN
   1479         DO 800 L=1,LM
   1480         CALL ZERO2(TL)
   1481         CALL ZERO2(FNE)
   1482         CALL ZERO2(FSE)
   1483 C
   1484         IF(KSMUD.GE.1)THEN
   1485           DO 750 KS=1,KSMUD
   1486 C
   1487           DO J=MYJS,MYJE
   1488           DO I=MYIS,MYIE
   1489             TL(I,J)=RSWTT(I,J,L)*HTM(I,J,L)
   1490           ENDDO
   1491           ENDDO
   1492 C
   1493           DO J=MYJS,MYJE
   1494           DO I=MYIS,MYIE
   1495             FNE(I,J)=(TL(I+IHE(J),J+1)-TL(I,J))
   1496      1               *HTM(I,J,L)*HTM(I+IHE(J),J+1,L)
   1497           ENDDO
   1498           ENDDO
   1499 C
   1500           DO J=MYJS1,MYJE

Page 23          Source Listing                  RADTN
2022-02-15 16:38                                 RADTN.F

   1501           DO I=MYIS,MYIE
   1502             FSE(I,J)=(TL(I+IHE(J),J-1)-TL(I,J))
   1503      1               *HTM(I+IHE(J),J-1,L)*HTM(I,J,L)
   1504           ENDDO
   1505           ENDDO
   1506 C
   1507           DO J=MYJS2,MYJE2
   1508           DO I=MYIS,MYIE
   1509             TL(I,J)=(FNE(I,J)-FNE(I+IHW(J),J-1)
   1510      1              +FSE(I,J)-FSE(I+IHW(J),J+1))
   1511      2              *HBM2(I,J)*0.125+TL(I,J)
   1512           ENDDO
   1513           ENDDO
   1514 C
   1515           DO J=MYJS,MYJE
   1516           DO I=MYIS,MYIE
   1517             RSWTT(I,J,L)=TL(I,J)
   1518           ENDDO
   1519           ENDDO
   1520 C
   1521   750     CONTINUE
   1522         ENDIF
   1523 C
   1524   800   CONTINUE
   1525       ENDIF
   1526 C----------------------------------------------------------------------
   1527 C
   1528       IF(LONG)THEN
   1529 C
   1530         DO 900 L=1,LM
   1531         CALL ZERO2(TL)
   1532         CALL ZERO2(FNE)
   1533         CALL ZERO2(FSE)
   1534 C
   1535         IF(KSMUD.GE.1)THEN
   1536           DO 850 KS=1,KSMUD
   1537 C
   1538           DO J=MYJS,MYJE
   1539           DO I=MYIS,MYIE
   1540             TL(I,J)=RLWTT(I,J,L)*HTM(I,J,L)
   1541           ENDDO
   1542           ENDDO
   1543 C
   1544           DO J=MYJS,MYJE1
   1545           DO I=MYIS,MYIE
   1546             FNE(I,J)=(TL(I+IHE(J),J+1)-TL(I,J))
   1547      1               *HTM(I,J,L)*HTM(I+IHE(J),J+1,L)
   1548           ENDDO
   1549           ENDDO
   1550 C
   1551           DO J=MYJS1,MYJE
   1552           DO I=MYIS,MYIE
   1553             FSE(I,J)=(TL(I+IHE(J),J-1)-TL(I,J))
   1554      1               *HTM(I+IHE(J),J-1,L)*HTM(I,J,L)
   1555           ENDDO
   1556           ENDDO
   1557 C

Page 24          Source Listing                  RADTN
2022-02-15 16:38                                 RADTN.F

   1558           DO J=MYJS2,MYJE2
   1559           DO I=MYIS,MYIE
   1560             TL(I,J)=(FNE(I,J)-FNE(I+IHW(J),J-1)
   1561      1              +FSE(I,J)-FSE(I+IHW(J),J+1))
   1562      2              *HBM2(I,J)*0.125+TL(I,J)
   1563           ENDDO
   1564           ENDDO
   1565 C
   1566           DO J=MYJS,MYJE
   1567           DO I=MYIS,MYIE
   1568             RLWTT(I,J,L)=TL(I,J)
   1569           ENDDO
   1570           ENDDO
   1571 C
   1572   850     CONTINUE
   1573         ENDIF
   1574   900   CONTINUE
   1575       ENDIF
   1576 C-----------------------------------------------------------------------
   1577 C-----------------------------------------------------------------------
   1578                               RETURN
   1579                               END


ENTRY POINTS

  Name              
                    
 radtn_             

Page 25          Source Listing                  RADTN
2022-02-15 16:38 Symbol Table                    RADTN.F



SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 125                        Label  628                                                            613                               
 140                        Label  636                                                            630                               
 200                        Label  681                                                            641                               
 250                        Label  705                                                            687                               
 275                        Label  787                                                            720                               
 280                        Label  788                                                            716                               
 290                        Label  811                                                            808                               
 300                        Label  832                                                            829                               
 310                        Label  850                                                            847                               
 320                        Label  862                                                            859                               
 330                        Label  879                                                            876                               
 340                        Label  891                                                            888                               
 350                        Label  896                                                            797                               
 375                        Label  960                                                            920                               
 390                        Label  987                                                            972                               
 400                        Label  1003                                                           1000                              
 410                        Label  1014                                                           1011                              
 425                        Label  1019                                                           992                               
 435                        Label  1066                                                           1060                              
 450                        Label  1147                                                           1082,1090,1128                    
 480                        Label  1152                                                           1043,1051                         
 500                        Label  1153                                                           1033                              
 510                        Label  1208                                                           1197                              
 540                        Label  1277                                                           1223                              
 560                        Label  1332                                                           1301                              
 570                        Label  1355                                                           1337                              
 580                        Label  1357                                                           1291                              
 600                        Label  1361                                                           1177                              
 650                        Label  1421                                                           1397                              
 660                        Label  1438                                                           1427,1436                         
 675                        Label  1461                                                           1442                              
 700                        Label  1466                                                           610                               
 750                        Label  1521                                                           1485                              
 800                        Label  1524                                                           1479                              
 850                        Label  1572                                                           1536                              
 900                        Label  1574                                                           1530                              
 A1                         Param  209      R(4)            4           scalar                                                      
 A2                         Param  209      R(4)            4           scalar                    737                               
 A3                         Param  209      R(4)            4           scalar                    737                               
 A4                         Param  209      R(4)            4           scalar                    737                               
 AA                         Local  1346     R(4)            4           scalar                    1346,1347,1350,1351,1352          
 ABS                        Func   1342                                 scalar                    1342                              
 ACMCLD                     Common 407                                  101112   SAVE                                               
 ACMRDL                     Common 415                                  1289088  SAVE                                               
 ACMRDS                     Common 425                                  1289088  SAVE                                               
 ADDL                       Local  548      R(4)            4           scalar                    548,549,550                       
 AI                         Local  728      R(4)            4           scalar                    728,732,738                       
 ALBDO                      Local  445      R(4)            4     1     71                        701,1390                          
 AMAX1                      Func   782                                  scalar                    782,950,1061,1116,1245,1261,1315,1
                                                                                                  325,1352,1408                     
 AMIN1                      Func   727                                  scalar                    727,738,779,785,951,984,1149,1318 

Page 26          Source Listing                  RADTN
2022-02-15 16:38 Symbol Table                    RADTN.F

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 APES                       Local  689      R(4)            4           scalar                    689,690,692                       
 ARG                        Local  781      R(4)            4           scalar                    781,782,783                       
 BB                         Local  1348     R(4)            4           scalar                    1348,1349,1351                    
 BCLD                       Local  235      L(4)            4     1     71                        965,967,973                       
 BI                         Local  729      R(4)            4           scalar                    729,733,738                       
 BIT1                       Local  236      L(4)            4           scalar                    1084,1089,1090,1229,1231          
 BIT2                       Local  236      L(4)            4           scalar                    1122,1127,1128                    
 BITC                       Local  236      L(4)            4           scalar                    1225,1229,1238,1243               
 BITCP1                     Local  236      L(4)            4           scalar                    1227,1244,1254,1268               
 BITS                       Local  236      L(4)            4           scalar                    1226,1229                         
 BITSP1                     Local  236      L(4)            4           scalar                    1228,1268                         
 BITW                       Local  236      L(4)            4           scalar                    1126,1136                         
 BITX                       Local  236      L(4)            4           scalar                    1086,1089,1099,1100,1116,1123,1297
                                                                                                  ,1302,1334,1338                   
 BITY                       Local  236      L(4)            4           scalar                    1099,1102,1123,1125,1126,1127,1142
 BITZ                       Local  236      L(4)            4           scalar                    1100,1107,1125,1130               
 BMID                       Local  482      R(4)            4     1     71                        646,722                           
 BTEMP1                     Local  235      L(4)            4     1     71                        967                               
 CALL1                      Local  234      L(4)            4           scalar                                                      
 CAMT                       Local  474      R(4)            4     2     3266                      1188,1199,1234,1239,1245,1248,1256
                                                                                                  ,1261,1272,1297,1391              
 CAPA                       Param  205      R(4)            4           scalar                    652,671,689                       
 CC                         Local  468      R(4)            4     1     9                         490,941,943,944                   
 CC1                        Local  943      R(4)            4           scalar                    943,947                           
 CC2                        Local  944      R(4)            4           scalar                    944,947                           
 CCLIMIT                    Local  713      R(4)            4           scalar                    713                               
 CCMID                      Local  483      R(4)            4     2     3195                      620,980,982,984,1016,1061,1225,122
                                                                                                  7,1239,1245,1248                  
 CCR                        Local  480      R(4)            4     2     3195                      622,779,783,785                   
 CFRAVG                     Local  1408     R(4)            4           scalar                    1408,1411,1414,1418               
 CL1                        Local  1075     R(4)            4           scalar                    1075,1125,1126,1131,1132,1133,1139
                                                                                                  ,1149                             
 CL2                        Local  1076     R(4)            4           scalar                    1076,1116,1131,1132,1133,1139,1145
 CLAPSE                     Param  220      R(4)            4           scalar                    827                               
 CLDAMT                     Local  442      R(4)            4     1     46                        1038,1061,1062,1064,1085,1088,1123
 CLDCFR                     Local  446      R(4)            4     2     213                       632,1149,1400,1401,1402           
 CLDF                       Local  447      R(4)            4     2     3266                                                        
 CLDMAX                     Local  1044     R(4)            4           scalar                    1044,1062,1064                    
 CLDRH0                     Param  218      R(4)            4           scalar                    218                               
 CLDRH2                     Param  219      R(4)            4           scalar                    219                               
 CLDWTR                     Common 377                                  1213608  SAVE                                               
 CLIMIT                     Local  714      R(4)            4           scalar                    714,745,758                       
 CLPFIL                     Local  839      R(4)            4           scalar                    839,841,848                       
 CLPSE                      Param  220      R(4)            4           scalar                    838,839                           
 CLSTP                      Local  522      R(4)            4           scalar                    522,928,1399                      
 CM1                        Param  221      R(4)            4           scalar                                                      
 CM2                        Param  221      R(4)            4           scalar                                                      
 CM3                        Param  221      R(4)            4           scalar                                                      
 CNCLD                      Local  239      L(4)            4           scalar                    494,918,1409                      
 CNVCLD                     Common 386                                  101104   SAVE                                               
 COS                        Func   552                                  scalar                    552,553                           
 COSZ                       Local  445      R(4)            4     1     71                        704,1392                          
 CR1                        Local  1085     R(4)            4           scalar                    1085,1116                         
 CSMID                      Local  480      R(4)            4     2     3195                      618,785,809,836,848,860,893,1061,1
                                                                                                  226,1228,1234,1256,1261           

Page 27          Source Listing                  RADTN
2022-02-15 16:38 Symbol Table                    RADTN.F

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 CSTR                       Local  470      R(4)            4     1     71                        1035                              
 CTLBLK                     Common 246                                  112      SAVE                                               
 CUINIT                     Common 432                                  4                                                           
 CV                         Local  454      R(4)            4     1     71                        939,941,947,950,951,953,965,982   
 CVB                        Local  472      R(4)            4     1     71                                                          
 CVT                        Local  472      R(4)            4     1     71                                                          
 CWMKL                      Local  725      R(4)            4           scalar                    725,745,758,781                   
 DAYI                       Local  546      R(4)            4           scalar                    546,547,550,565                   
 DCLPS                      Param  220      R(4)            4           scalar                    839                               
 DD                         Local  1343     R(4)            4           scalar                    1343,1345,1350,1351,1352          
 DDP                        Local  807      R(4)            4           scalar                    807,808,846,847,858,859           
 DDX                        Local  231      R(8)            8           scalar                    1340,1341,1343                    
 DELP                       Local  1305     R(4)            4           scalar                    1305,1307,1315,1318,1325,1328     
 DENOM                      Local  1371     R(4)            4           scalar                    1371,1372,1373                    
 DPCL                       Local  1109     R(4)            4           scalar                    1109,1110                         
 DTHDP                      Local  825      R(4)            4           scalar                    825,827,838,839,883,886,1007,1009 
 DYNAM                      Common 275                                  259964   SAVE                                               
 EE                         Local  1344     R(4)            4           scalar                    1344,1346,1348                    
 EEX                        Local  231      R(8)            8           scalar                    1341,1342,1344                    
 EMIS                       Local  471      R(4)            4     2     3266                      1185,1202,1334,1391               
 EPS                        Param  221      R(4)            4           scalar                                                      
 EPSO3                      Param  217      R(4)            4           scalar                    624                               
 EPSQ                       Param  217      R(4)            4           scalar                    617                               
 EPSQ1                      Param  217      R(4)            4           scalar                    770,886,1009,1335                 
 EXNER                      Local  652      R(4)            4           scalar                    652,654,671,672                   
 EXP                        Func   737                                  scalar                    737,783,1334,1347                 
 FCTRA                      Local  1372     R(4)            4           scalar                    1372,1374                         
 FCTRB                      Local  1373     R(4)            4           scalar                    1373,1374                         
 FF                         Local  1345     R(4)            4           scalar                    1345,1346,1348                    
 FIQ                        Local  744      R(4)            4           scalar                    744,745                           
 FIW                        Local  765      R(4)            4           scalar                    765,766                           
 FLOAT                      Func   765                                  scalar                    765                               
 FLWDNS                     Local  458      R(4)            4     1     71                        1395,1452                         
 FLWUP                      Local  456      R(4)            4     1     71                        1395,1454                         
 FLWUPS                     Local  458      R(4)            4     1     71                        1395,1453                         
 FNE                        Local  460      R(4)            4     2     6319                      1481,1495,1509,1532,1546,1560     
 FSE                        Local  460      R(4)            4     2     6319                      1482,1502,1510,1533,1553,1561     
 FSWDN                      Local  456      R(4)            4     1     71                        1395                              
 FSWDNS                     Local  457      R(4)            4     1     71                        1395,1457                         
 FSWUP                      Local  456      R(4)            4     1     71                        1395,1459                         
 FSWUPS                     Local  457      R(4)            4     1     71                        1395,1458                         
 GG                         Local  1349     R(4)            4           scalar                    1349,1350,1352                    
 GLB_TABLE                  Common 182                                  336      SAVE                                               
 HH                         Local  722      R(4)            4           scalar                    722,726,727,737                   
 HMID                       Local  481      R(4)            4     2     3195                      623,657,722                       
 HOUR                       Local  546      R(4)            4           scalar                    546,565,1394                      
 HPINC                      Param  217      R(4)            4           scalar                    669,670,679                       
 I                          Local  506      I(4)            4           scalar                    506,507,557,558,559,568,569,570,57
                                                                                                  1,578,579,614,615,616,617,618,619,
                                                                                                  620,621,622,623,624,625,626,631,63
                                                                                                  2,633,634,641,642,643,644,646,647,
                                                                                                  650,651,652,653,654,655,656,657,66
                                                                                                  9,670,671,672,677,679,687,688,689,
                                                                                                  690,691,692,694,701,703,704,716,71
                                                                                                  7,718,722,723,724,725,736,742,746,

Page 28          Source Listing                  RADTN
2022-02-15 16:38 Symbol Table                    RADTN.F

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
                                                                                                  748,753,757,758,761,779,783,785,79
                                                                                                  7,799,800,804,807,809,818,825,826,
                                                                                                  836,846,848,858,860,874,883,884,88
                                                                                                  6,893,920,921,923,925,928,939,941,
                                                                                                  947,950,951,953,954,955,957,958,96
                                                                                                  4,965,966,967,972,973,974,975,979,
                                                                                                  980,982,984,992,993,994,998,1007,1
                                                                                                  008,1009,1016,1033,1035,1046,1054,
                                                                                                  1061,1086,1087,1109,1124,1149,1150
                                                                                                  ,1151,1157,1158,1177,1178,1179,118
                                                                                                  5,1186,1187,1188,1189,1190,1193,11
                                                                                                  94,1198,1199,1200,1201,1202,1205,1
                                                                                                  206,1225,1226,1227,1228,1233,1234,
                                                                                                  1235,1236,1239,1240,1245,1247,1248
                                                                                                  ,1249,1250,1251,1255,1256,1257,125
                                                                                                  8,1259,1261,1269,1270,1271,1272,12
                                                                                                  82,1283,1293,1297,1298,1299,1302,1
                                                                                                  303,1304,1306,1307,1308,1312,1313,
                                                                                                  1315,1318,1325,1328,1334,1340,1346
                                                                                                  ,1351,1352,1370,1371,1372,1373,137
                                                                                                  4,1397,1398,1399,1400,1401,1402,14
                                                                                                  08,1411,1412,1414,1415,1418,1419,1
                                                                                                  427,1429,1430,1431,1442,1444,1445,
                                                                                                  1452,1453,1454,1457,1458,1459,1488
                                                                                                  ,1489,1494,1495,1496,1501,1502,150
                                                                                                  3,1508,1509,1510,1511,1516,1517,15
                                                                                                  39,1540,1545,1546,1547,1552,1553,1
                                                                                                  554,1559,1560,1561,1562,1567,1568 
 ICVB                       Local  453      I(4)            4     1     71                        955,958,966,979                   
 ICVT                       Local  453      I(4)            4     1     71                        954,957,966,979                   
 IDIM1                      Param  132      I(4)            4           scalar                    235,257,264,265,267,268,269,281,28
                                                                                                  2,283,284,285,286,303,304,305,306,
                                                                                                  307,308,309,310,311,312,313,322,32
                                                                                                  4,325,326,333,334,335,336,337,338,
                                                                                                  339,340,341,342,343,344,345,346,34
                                                                                                  7,348,349,351,356,364,365,366,367,
                                                                                                  368,369,370,371,378,380,387,388,39
                                                                                                  7,409,410,417,418,419,420,427,428,
                                                                                                  429,430,439,443,445,446,447,448,45
                                                                                                  0,451,452,453,454,456,457,458,459,
                                                                                                  460,461,463,464,465,466,470,471,47
                                                                                                  2,474,475,476,477,480,481,482,483 
 IDIM2                      Param  132      I(4)            4           scalar                    235,257,264,265,267,268,269,281,28
                                                                                                  2,283,284,285,286,303,304,305,306,
                                                                                                  307,308,309,310,311,312,313,322,32
                                                                                                  4,325,326,333,334,335,336,337,338,
                                                                                                  339,340,341,342,343,344,345,346,34
                                                                                                  7,348,349,351,356,364,365,366,367,
                                                                                                  368,369,370,371,378,380,387,388,39
                                                                                                  7,409,410,417,418,419,420,427,428,
                                                                                                  429,430,439,443,445,446,447,448,45
                                                                                                  0,451,452,453,454,456,457,458,459,
                                                                                                  460,461,463,464,465,466,470,471,47
                                                                                                  2,474,475,476,477,480,481,482,483 
 IGSTL                      Param  127      I(4)            4           scalar                    132                               

Page 29          Source Listing                  RADTN
2022-02-15 16:38 Symbol Table                    RADTN.F

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 IGSTR                      Param  127      I(4)            4           scalar                    132                               
 II                         Local  563      I(4)            4           scalar                    563,564                           
 IM                         Param  115      I(4)            4           scalar                    129,132,188,189,190,191,192,196,19
                                                                                                  7,202,214,401                     
 IMJM                       Param  214      I(4)            4           scalar                                                      
 INDX                       Common 394                                  1708     SAVE                                               
 INDXG                      Common 400                                  8084     SAVE                                               
 INPES                      Param  124      I(4)            4           scalar                    129,132,172,173,174,183,184       
 INT                        Func   547                                  scalar                    547,957,958,1131,1132             
 IR                         Local  615      I(4)            4           scalar                    615,642                           
 ITAIL                      Param  129      I(4)            4           scalar                                                      
 ITB                        Param  137      I(4)            4           scalar                    300,315                           
 ITBQ                       Param  137      I(4)            4           scalar                    301,315                           
 ITIMLW                     Local  532      I(4)            4           scalar                    532,534,1394                      
 ITIMSW                     Local  531      I(4)            4           scalar                    531,533,1394                      
 ITYP                       Local  475      I(4)            4     2     3266                      1189,1198,1233,1235,1240,1249,1257
                                                                                                  ,1271,1312,1391                   
 IW                         Local  480      I(4)            4     2     3195                      621,746,748,753,757,758,761       
 IWKL                       Local  761      I(4)            4           scalar                    761,765                           
 J                          Local  505      I(4)            4           scalar                    505,507,556,558,559,567,569,570,57
                                                                                                  1,577,579,610,616,643,644,646,647,
                                                                                                  650,651,653,654,655,656,657,688,69
                                                                                                  0,691,692,694,701,703,704,717,718,
                                                                                                  799,800,804,818,921,928,957,958,97
                                                                                                  4,975,993,994,1046,1054,1178,1179,
                                                                                                  1398,1399,1400,1401,1402,1408,1411
                                                                                                  ,1412,1414,1415,1418,1419,1429,143
                                                                                                  0,1431,1444,1452,1453,1454,1457,14
                                                                                                  58,1459,1487,1489,1493,1495,1496,1
                                                                                                  500,1502,1503,1507,1509,1510,1511,
                                                                                                  1515,1517,1538,1540,1544,1546,1547
                                                                                                  ,1551,1553,1554,1558,1560,1561,156
                                                                                                  2,1566,1568                       
 JAM                        Param  214      I(4)            4           scalar                    256,279                           
 JD                         Local  547      I(4)            4           scalar                    547,1394                          
 JDIM1                      Param  133      I(4)            4           scalar                    257,264,265,267,268,269,281,282,28
                                                                                                  3,284,285,286,303,304,305,306,307,
                                                                                                  308,309,310,311,312,313,322,324,32
                                                                                                  5,326,333,334,335,336,337,338,339,
                                                                                                  340,341,342,343,344,345,346,347,34
                                                                                                  8,349,351,356,364,365,366,367,368,
                                                                                                  369,370,371,378,380,387,388,395,39
                                                                                                  6,409,410,417,418,419,420,427,428,
                                                                                                  429,430,439,459,460,461,463,464,46
                                                                                                  5,466                             
 JDIM2                      Param  133      I(4)            4           scalar                    257,264,265,267,268,269,281,282,28
                                                                                                  3,284,285,286,303,304,305,306,307,
                                                                                                  308,309,310,311,312,313,322,324,32
                                                                                                  5,326,333,334,335,336,337,338,339,
                                                                                                  340,341,342,343,344,345,346,347,34
                                                                                                  8,349,351,356,364,365,366,367,368,
                                                                                                  369,370,371,378,380,387,388,395,39
                                                                                                  6,409,410,417,418,419,420,427,428,
                                                                                                  429,430,439,459,460,461,463,464,46
                                                                                                  5,466                             

Page 30          Source Listing                  RADTN
2022-02-15 16:38 Symbol Table                    RADTN.F

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 JGSTL                      Param  128      I(4)            4           scalar                    133                               
 JGSTR                      Param  128      I(4)            4           scalar                    133                               
 JM                         Param  115      I(4)            4           scalar                    130,133,188,189,190,191,192,196,19
                                                                                                  7,202,214,401                     
 JNPES                      Param  124      I(4)            4           scalar                    130,133,172,173,174,183,184       
 JTAIL                      Param  130      I(4)            4           scalar                                                      
 JTB                        Param  137      I(4)            4           scalar                    300,315                           
 JTBQ                       Param  137      I(4)            4           scalar                    315                               
 K15                        Param  228      I(4)            4           scalar                    231                               
 KBT1                       Local  1077     I(4)            4           scalar                    1077,1131,1137,1150,1151          
 KBT2                       Local  1078     I(4)            4           scalar                    1078,1103,1108,1109,1113,1131,1137
                                                                                                  ,1143                             
 KBTM                       Local  476      I(4)            4     2     3266                      1187,1201,1236,1251,1259,1299,1302
                                                                                                  ,1391                             
 KCLD                       Local  477      I(4)            4     1     71                        1190,1233,1234,1235,1236,1239,1240
                                                                                                  ,1245,1247,1248,1249,1250,1251,125
                                                                                                  5,1256,1257,1258,1259,1261,1269,12
                                                                                                  70,1271,1272,1282                 
 KNTLYR                     Local  665      I(4)            4           scalar                    665,668,669                       
 KS                         Local  1485     I(4)            4           scalar                    1485,1536                         
 KSMUD                      Param  206      I(4)            4           scalar                    1484,1485,1535,1536               
 KTH1                       Local  1079     I(4)            4           scalar                    1079,1132,1138,1150               
 KTH2                       Local  1080     I(4)            4           scalar                    1080,1099,1100,1104,1108,1111,1132
                                                                                                  ,1138,1144                        
 KTOP                       Local  475      I(4)            4     2     3266                      1186,1200,1250,1258,1270,1298,1302
                                                                                                  ,1313,1391                        
 KTOP1                      Local  1108     I(4)            4           scalar                    1108,1109                         
 L                          Local  613      I(4)            4           scalar                    613,616,617,618,619,620,621,622,62
                                                                                                  3,624,625,626,649,650,651,652,653,
                                                                                                  654,655,656,657,667,669,670,671,67
                                                                                                  2,720,721,742,805,806,823,824,844,
                                                                                                  845,856,857,872,873,977,978,996,99
                                                                                                  7,1037,1038,1060,1061,1062,1063,10
                                                                                                  64,1083,1085,1086,1087,1088,1103,1
                                                                                                  123,1124,1197,1198,1199,1200,1201,
                                                                                                  1202,1205,1206,1223,1224,1369,1374
                                                                                                  ,1428,1429,1430,1431,1479,1489,149
                                                                                                  6,1503,1517,1530,1540,1547,1554,15
                                                                                                  68                                
 L400                       Local  871      I(4)            4           scalar                    871,875,882,991,999,1006          
 LBASE                      Local  822      I(4)            4           scalar                    822,828,836,837                   
 LL                         Local  721      I(4)            4           scalar                    721,722,723,724,725,736,746,748,75
                                                                                                  3,757,758,761,779,783,785,806,807,
                                                                                                  809,824,825,826,828,845,846,848,85
                                                                                                  7,858,860,873,874,875,882,883,884,
                                                                                                  886,887,892,893,978,979,980,982,98
                                                                                                  4,997,998,999,1006,1007,1008,1009,
                                                                                                  1010,1015,1016,1082,1083,1224,1225
                                                                                                  ,1226,1227,1228,1234,1236,1239,124
                                                                                                  5,1248,1250,1251,1256,1258,1259,12
                                                                                                  61,1270,1301,1302,1303,1304,1306,1
                                                                                                  307,1308,1429,1430,1431,1436      
 LLBOT                      Local  1054     I(4)            4           scalar                    1054,1055,1057,1060,1077,1078,1082
                                                                                                  ,1083,1143                        
 LLTOP                      Local  1046     I(4)            4           scalar                    1046,1051,1060,1082,1083          

Page 31          Source Listing                  RADTN
2022-02-15 16:38 Symbol Table                    RADTN.F

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 LM                         Param  115      I(4)            4           scalar                    197,214,267,268,277,299,324,325,35
                                                                                                  1,378,379,420,430,442,448,450,451,
                                                                                                  452,480,481,483,613,822,837,871,88
                                                                                                  1,891,991,1005,1014,1037,1045,1051
                                                                                                  ,1369,1378,1428,1436,1444,1445,147
                                                                                                  9,1530                            
 LM1                        Param  214      I(4)            4           scalar                    1055,1057                         
 LML                        Local  643      I(4)            4           scalar                    643,649,717,720,799,805,806,823,82
                                                                                                  4,844,845,856,857,872,873,974,977,
                                                                                                  993,996,997,1178,1223,1224        
 LONG                       Local  234      L(4)            4           scalar                    528,530,534,1431,1443,1451,1528   
 LOOPS                      Common 255                                  65752    SAVE                                               
 LP1                        Param  214      I(4)            4           scalar                    277,299,447,470,471,474,475,476,47
                                                                                                  7,1186,1187,1197,1295,1371,1372,13
                                                                                                  73                                
 LSM                        Param  115      I(4)            4           scalar                                                      
 LTROP                      Local  881      I(4)            4           scalar                    881,887,891,892,1005,1010,1014,101
                                                                                                  5                                 
 LVLIJ                      Local  644      I(4)            4           scalar                    644,650,651,652,653,654,655,656,65
                                                                                                  7,664,667,676,718,721,800,806,824,
                                                                                                  845,857,873,975,978,994,997,1179,1
                                                                                                  224                               
 MALVL                      Local  1045     I(4)            4           scalar                    1045,1063                         
 MAPPINGS                   Common 201                                  5024     SAVE                                               
 MASKS                      Common 263                                  2426496  SAVE                                               
 MAX                        Func   1299                                 scalar                    1299,1351                         
 MBOT                       Local  446      I(4)            4     2     213                       634,1151                          
 MIN                        Func   521                                  scalar                    521,1055,1150,1298,1346           
 MOD                        Func   529                                  scalar                    529,530,539,549                   
 MPPCOM                     Common 146                                  1724     SAVE                                               
 MTOP                       Local  453      I(4)            4     2     213                       633,1150                          
 N                          Local  630      I(4)            4           scalar                    630,632,633,634                   
 NB                         Param  225      I(4)            4           scalar                    436,476,477,1192,1204,1337        
 NBAND                      Local  1192     I(4)            4           scalar                    1192,1193,1194,1204,1205,1206,1337
                                                                                                  ,1339,1351,1352                   
 NBTM                       Local  1296     I(4)            4           scalar                    1296,1299,1301                    
 NC                         Local  931      I(4)            4           scalar                    931,932,1291,1297,1298,1299,1302,1
                                                                                                  312,1313,1334,1351,1352           
 NCLD                       Local  1283     I(4)            4           scalar                    1283,1287,1291                    
 NCLDS                      Local  474      I(4)            4     1     71                        1282,1283,1391                    
 NFILE                      Local  489      I(4)            4           scalar                    489                               
 NINT                       Func   520                                  scalar                    520                               
 NKTP                       Local  1295     I(4)            4           scalar                    1295,1298,1301                    
 NLVL                       Local  1043     I(4)            4           scalar                    1043,1046,1053,1054,1086,1087,1110
                                                                                                  ,1124,1149,1150,1151              
 NMOD                       Local  929      I(4)            4           scalar                    929,932,938,940,943,944,945,946   
 NRADPP                     Local  521      I(4)            4           scalar                    521,522,539                       
 NROOT                      Param  139      I(4)            4           scalar                                                      
 NSOIL                      Param  139      I(4)            4           scalar                    369,370,371                       
 NTSPH                      Local  520      I(4)            4           scalar                    520,522                           
 OZN                        Local  452      R(4)            4     2     3195                      624,1378,1390                     
 OZON2D                     Subr   1378                                                           1378                              
 P1                         Local  945      R(4)            4           scalar                    945,947                           
 P2                         Local  946      R(4)            4           scalar                    946,947                           
 P400                       Local  486      R(4)            4           scalar                    486                               

Page 32          Source Listing                  RADTN
2022-02-15 16:38 Symbol Table                    RADTN.F

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 PBOT                       Param  221      R(4)            4           scalar                    808,847,859                       
 PBOTH                      Local  465      R(4)            4     2     6319                                                        
 PBOTL                      Local  463      R(4)            4     2     6319                                                        
 PBOTM                      Local  464      R(4)            4     2     6319                                                        
 PDSL                       Local  459      R(4)            4     2     6319                      507,650,651,1398                  
 PDSLIJ                     Local  1398     R(4)            4           scalar                    1398                              
 PHALF                      Local  470      R(4)            4     1     46                                                          
 PHITP                      Local  486      R(4)            4           scalar                    486,501                           
 PHYS                       Common 294                                  858036   SAVE                                               
 PI2                        Param  222      R(4)            4           scalar                    550                               
 PINT                       Local  470      R(4)            4     2     3266                      651,670,677,679,1086,1087,1124,130
                                                                                                  3,1304,1313,1371,1372,1373,1390   
 PLBTM                      Local  487      R(4)            4           scalar                    487,498                           
 PLOMD                      Local  486      R(4)            4           scalar                    486,499                           
 PMDHI                      Local  486      R(4)            4           scalar                    486,500                           
 PMID                       Local  450      R(4)            4     2     3195                      650,652,669,670,671,679,736,807,82
                                                                                                  6,846,858,874,884,998,1008,1109,13
                                                                                                  74,1390                           
 PMOD                       Local  928      R(4)            4           scalar                    928,932,947,1399,1410             
 POZN                       Local  452      R(4)            4     2     3195                      1374,1378                         
 PP                         Local  736      R(4)            4           scalar                    736,737                           
 PPT                        Local  468      R(4)            4     1     9                         491,932,945,946,1410              
 PQ0                        Param  211      R(4)            4           scalar                    737                               
 PROD                       Local  231      R(8)            8           scalar                    1339,1340                         
 PRS1                       Local  1303     R(4)            4           scalar                    1303,1305,1307                    
 PRS2                       Local  1304     R(4)            4           scalar                    1304,1305,1307                    
 PSFC                       Local  443      R(4)            4     1     71                        688,689,807,846,858,1390          
 PTOPH                      Local  465      R(4)            4     2     6319                                                        
 PTOPL                      Local  463      R(4)            4     2     6319                                                        
 PTOPM                      Local  464      R(4)            4     2     6319                                                        
 PVRBLS                     Common 332                                  1946252  SAVE                                               
 QC                         Local  766      R(4)            4           scalar                    766,770,773                       
 QI                         Local  738      R(4)            4           scalar                    738,740,744,766                   
 QINT                       Local  739      R(4)            4           scalar                    739,740,766                       
 QKL                        Local  724      R(4)            4           scalar                    724,744,770,773                   
 QMID                       Local  451      R(4)            4     2     3195                      617,655,724,886,1009,1307,1390    
 QSUM                       Local  1294     R(4)            4           scalar                    1294,1307,1335,1339               
 QW                         Local  737      R(4)            4           scalar                    737,738,739                       
 RADFS                      Subr   1388                                                           1388                              
 RADTN                      Subr   3                                                                                                
 RANG                       Local  550      R(4)            4           scalar                    550,551,552,553                   
 RCOS1                      Local  552      R(4)            4           scalar                    552,1378                          
 RCOS2                      Local  553      R(4)            4           scalar                    553,1378                          
 RD1TIM                     Common 438                                  25336                                                       
 REAL                       Func   669                                  scalar                    669                               
 RLAG                       Param  222      R(4)            4           scalar                    550                               
 RNRM                       Param  218      R(4)            4           scalar                                                      
 RNRM2                      Param  219      R(4)            4           scalar                                                      
 RQKL                       Local  771      R(4)            4           scalar                    771,773,778,779,781,783           
 RRCL                       Local  476      R(4)            4     3     39192                     1193,1205,1351,1391               
 RSIN1                      Local  551      R(4)            4           scalar                    551,1378                          
 RTD                        Param  205      R(4)            4           scalar                    703                               
 SELECTED_REAL_KIND         Func   228                                  scalar                    228                               
 SHORT                      Local  234      L(4)            4           scalar                    527,529,533,554,1430,1456,1478    
 SIN                        Func   551                                  scalar                    551                               

Page 33          Source Listing                  RADTN
2022-02-15 16:38 Symbol Table                    RADTN.F

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 SINGLRST                   Local  244      L(4)            4           scalar                                                      
 SLMSK                      Local  447      R(4)            4     1     71                        694,1390                          
 SLPM                       Param  217      R(4)            4           scalar                                                      
 SOIL                       Common 363                                  581380   SAVE                                               
 SQRT                       Func   1308                                 scalar                    1308,1346,1349                    
 STBOL                      Param  222      R(4)            4           scalar                    1444                              
 SV                         Local  454      R(4)            4     1     71                        923,925,950                       
 SWRSAV                     Common 436                                  112                                                         
 TAUC                       Local  471      R(4)            4     1     71                        1293,1315,1318,1325,1328,1334,1340
                                                                                                  ,1346                             
 TAUDAR                     Local  472      R(4)            4     1     71                        1158,1392                         
 TCLD                       Local  1306     R(4)            4           scalar                    1306,1314,1316,1318,1324,1326     
 TEMPCOM                    Common 187                                  6603768  SAVE                                               
 TENDK                      Local  442      R(4)            4     1     45                                                          
 TENDL                      Local  448      R(4)            4     2     3195                      626,1394,1431                     
 TENDS                      Local  448      R(4)            4     2     3195                      625,1394,1430                     
 THMID                      Local  451      R(4)            4     2     3195                      654,672,825,883,1007              
 TIME                       Local  545      R(4)            4           scalar                    545,546                           
 TIMES                      Local  564      R(4)            4           scalar                    564,565                           
 TKL                        Local  723      R(4)            4           scalar                    723,726,737                       
 TL                         Local  461      R(4)            4     2     6319                      1480,1489,1495,1502,1509,1511,1517
                                                                                                  ,1531,1540,1546,1553,1560,1562,156
                                                                                                  8                                 
 TMID                       Local  450      R(4)            4     2     3195                      616,653,672,723,1306,1308,1390,144
                                                                                                  4,1445                            
 TMT0                       Local  726      R(4)            4           scalar                    726,727,731,738,740,743,752,756   
 TMT15                      Local  727      R(4)            4           scalar                    727,739                           
 TOPO                       Common 195                                  17478548 SAVE                                               
 TOT                        Local  466      R(4)            4     2     6319                      559,571,579                       
 TRESH                      Param  218      R(4)            4           scalar                    218                               
 TRESH2                     Param  219      R(4)            4           scalar                    219                               
 TSKN                       Local  443      R(4)            4     1     71                        690,1390                          
 TTCL                       Local  477      R(4)            4     3     39192                     1194,1206,1352,1391               
 U00KL                      Local  742      R(4)            4           scalar                    742,744                           
 UMID                       Local  482      R(4)            4     1     71                        647,742                           
 US                         Local  712      R(4)            4           scalar                    712,779,781,785                   
 UTIM                       Local  493      R(4)            4           scalar                    493,742                           
 VRBLS                      Common 321                                  4625508  SAVE                                               
 WA                         Param  206      R(4)            4           scalar                    206                               
 WG                         Param  206      R(4)            4           scalar                                                      
 WMID                       Local  481      R(4)            4     2     3195                      619,656,725                       
 XLAT                       Local  445      R(4)            4     1     71                        703,1378,1390                     
 ZENITH                     Subr   546                                                            546,565                           
 ZERO2                      Subr   1480                                                           1480,1481,1482,1531,1532,1533     



Page 34          Source Listing                  RADTN
2022-02-15 16:38 Symbol Table                    RADTN.F

TYPE COMPONENTS/COMMON VARIABLES

 Name                       Type            Bytes Offset   Dimen Elements Attributes       References                         
                                                                                                                              
 ABCFF                      R(4)            4     0        1     12       COM              1339                               
 ACCLIQ                     R(4)            4     454968   2     6319     COM                                                 
 ACFRCV                     R(4)            4     8        2     6319     COM              1414                               
 ACFRST                     R(4)            4     50560    2     6319     COM              1411,1418                          
 ACPREC                     R(4)            4     429692   2     6319     COM                                                 
 AETA                       R(4)            4     264      1     45       COM              650,1394                           
 AETAD                      R(4)            4     396      1     45       COM                                                 
 AFSI                       R(4)            4     1920976  2     6319     COM                                                 
 AKHS                       R(4)            4     227484   2     6319     COM                                                 
 AKMS                       R(4)            4     202208   2     6319     COM                                                 
 ALBASE                     R(4)            4     357388   2     6319     COM                                                 
 ALBEDO                     R(4)            4     382664   2     6319     COM              701                                
 ALWIN                      R(4)            4     75840    2     6319     COM                                                 
 ALWOUT                     R(4)            4     101116   2     6319     COM                                                 
 ALWTOA                     R(4)            4     126392   2     6319     COM                                                 
 ARDLW                      R(4)            4     8              scalar   COM                                                 
 ARDSW                      R(4)            4     8              scalar   COM                                                 
 ASWIN                      R(4)            4     75840    2     6319     COM                                                 
 ASWOUT                     R(4)            4     101116   2     6319     COM                                                 
 ASWTOA                     R(4)            4     126392   2     6319     COM                                                 
 CFCO2                      R(4)            4     96             scalar   COM                                                 
 CFO3                       R(4)            4     100            scalar   COM                                                 
 CFRACH                     R(4)            4     75828    2     6319     COM              1402,1408                          
 CFRACL                     R(4)            4     25276    2     6319     COM              1400,1408                          
 CFRACM                     R(4)            4     50552    2     6319     COM              1401,1408                          
 CI                         R(4)            4     40             scalar   COM                                                 
 CLDEFI                     R(4)            4     379140   2     6319     COM                                                 
 CMC                        R(4)            4     252760   2     6319     COM                                                 
 CNVBOT                     R(4)            4     256284   2     6319     COM                                                 
 CNVTOP                     R(4)            4     231008   2     6319     COM                                                 
 CPGFUX                     R(4)            4     57756    2     6319     COM                                                 
 CPGFV                      R(4)            4     4              scalar   COM                                                 
 CS                         R(4)            4     28             scalar   COM                                                 
 CTHK                       R(4)            4     4        1     3        COM              1110                               
 CUPPT                      R(4)            4     0        2     6319     COM              928,1399                           
 CUPREC                     R(4)            4     480244   2     6319     COM                                                 
 CURAD                      L(4)            4     0              scalar   COM              539                                
 CURVX                      R(4)            4     83032    2     6319     COM                                                 
 CWM                        R(4)            4     0        3     284355   COM              656                                
 CZEN                       R(4)            4     155180   2     6319     COM              569,570                            
 CZMEAN                     R(4)            4     458492   2     6319     COM              558,570,579,704                    
 DDMPUX                     R(4)            4     184136   2     6319     COM                                                 
 DDMPVX                     R(4)            4     209412   2     6319     COM                                                 
 DETA                       R(4)            4     84       1     45       COM                                                 
 DETAD                      R(4)            4     36       1     45       COM                                                 
 DFL                        R(4)            4     940      1     46       COM                                                 
 DFRLG                      R(4)            4     444      1     46       COM                                                 
 DI                         R(4)            4     44             scalar   COM                                                 
 DS                         R(4)            4     32             scalar   COM                                                 
 DT                         R(4)            4     48             scalar   COM              520,545,564                        
 DTD                        R(4)            4     16             scalar   COM                                                 
 DTQ2                       R(4)            4     8              scalar   COM                                                 
 DXX                        R(4)            4     7204     2     6319     COM                                                 

Page 35          Source Listing                  RADTN
2022-02-15 16:38 Symbol Table                    RADTN.F

 Name                       Type            Bytes Offset   Dimen Elements Attributes       References                         
                                                                                                                              
 DY                         R(4)            4     0              scalar   COM                                                 
 EF4T                       R(4)            4     32             scalar   COM                                                 
 EM                         R(4)            4     1124     1     760      COM                                                 
 EMT                        R(4)            4     4164     1     760      COM                                                 
 EN                         R(4)            4     8              scalar   COM                                                 
 ENT                        R(4)            4     12             scalar   COM                                                 
 EPSR                       R(4)            4     28800    2     6319     COM                                                 
 ETAD                       R(4)            4     756      1     46       COM              651,1394                           
 F4D                        R(4)            4     24             scalar   COM                                                 
 F4Q                        R(4)            4     28             scalar   COM                                                 
 F4Q2                       R(4)            4     576      1     45       COM                                                 
 FADX                       R(4)            4     234688   2     6319     COM                                                 
 FCP                        R(4)            4     108308   2     6319     COM                                                 
 FDIVX                      R(4)            4     133584   2     6319     COM                                                 
 FIRST                      L(4)            4     24             scalar   COM                                                 
 FIS                        R(4)            4     4574956  2     6319     COM                                                 
 FX                         R(4)            4     158860   2     6319     COM                                                 
 G2LI                       I(4)            4     0        1     239      COM                                                 
 G2LJ                       I(4)            4     1912     1     389      COM                                                 
 GFFC                       R(4)            4     306836   2     6319     COM                                                 
 GLAT                       R(4)            4     104628   2     6319     COM              703                                
 GLON                       R(4)            4     129904   2     6319     COM                                                 
 GRNFLX                     R(4)            4     101104   2     6319     COM                                                 
 HBM2                       R(4)            4     2375944  2     6319     COM              646,1511,1562                      
 HBM3                       R(4)            4     2401220  2     6319     COM                                                 
 HBOT                       R(4)            4     205732   2     6319     COM              921,958                            
 HDAC                       R(4)            4     407940   2     6319     COM                                                 
 HDACV                      R(4)            4     433216   2     6319     COM                                                 
 HTM                        R(4)            4     101104   3     284355   COM              657,1489,1496,1503,1540,1547,1554  
 HTMG                       R(4)            4     743768   3     4183695  COM                                                 
 HTOP                       R(4)            4     180456   2     6319     COM              921,957                            
 IBROW                      I(4)            4     404            scalar   COM                                                 
 ICHUNKTAB                  I(4)            4     828      1     21       COM                                                 
 IDAT                       I(4)            4     8        1     3        COM              549                                
 IDTAD                      I(4)            4     72             scalar   COM                                                 
 IE_GLB_TABLE               I(4)            4     84       1     21       COM                                                 
 IE_LOC_TABLE               I(4)            4     660      1     21       COM                                                 
 IHE                        I(4)            4     0        1     89       COM              1495,1496,1502,1503,1546,1547,1553 
                                                                                           ,1554                              
 IHEG                       I(4)            4     0        1     387      COM                                                 
 IHHA                       I(4)            4     3040     1     760      COM                                                 
 IHLA                       I(4)            4     0        1     760      COM                                                 
 IHRST                      I(4)            4     20             scalar   COM                                                 
 IHW                        I(4)            4     356      1     89       COM              1509,1510,1560,1561                
 IHWG                       I(4)            4     1548     1     387      COM                                                 
 ILCOL                      I(4)            4     396            scalar   COM                                                 
 ILPAD1                     I(4)            4     412            scalar   COM                                                 
 ILPAD2                     I(4)            4     416            scalar   COM                                                 
 ILPAD3                     I(4)            4     420            scalar   COM                                                 
 ILPAD4                     I(4)            4     424            scalar   COM                                                 
 ILPAD5                     I(4)            4     428            scalar   COM                                                 
 INUMQ                      I(4)            4     1324     1     100      COM                                                 
 IOUT                       I(4)            4     44             scalar   COM                                                 
 IQUILT_GROUP               I(4)            4     1320           scalar   COM                                                 
 IRAD                       I(4)            4     1424     1     71       COM              615,642                            

Page 36          Source Listing                  RADTN
2022-02-15 16:38 Symbol Table                    RADTN.F

 Name                       Type            Bytes Offset   Dimen Elements Attributes       References                         
                                                                                                                              
 IRADG                      I(4)            4     6192     1     473      COM                                                 
 IRCOL                      I(4)            4     400            scalar   COM                                                 
 IRPAD1                     I(4)            4     432            scalar   COM                                                 
 IRPAD2                     I(4)            4     436            scalar   COM                                                 
 IRPAD3                     I(4)            4     440            scalar   COM                                                 
 IRPAD4                     I(4)            4     444            scalar   COM                                                 
 IRPAD5                     I(4)            4     448            scalar   COM                                                 
 ISLOPE                     I(4)            4     202208   2     6319     COM                                                 
 ISLTYP                     I(4)            4     176932   2     6319     COM                                                 
 IS_GLB_TABLE               I(4)            4     0        1     21       COM                                                 
 IS_LOC_TABLE               I(4)            4     492      1     21       COM                                                 
 ITEMP                      I(4)            4     5870016  2     91719    COM                                                 
 ITEMP2                     I(4)            4     6236892  2     91719    COM                                                 
 ITROW                      I(4)            4     408            scalar   COM                                                 
 IVE                        I(4)            4     712      1     89       COM                                                 
 IVEG                       I(4)            4     3096     1     387      COM                                                 
 IVGTYP                     I(4)            4     151656   2     6319     COM                                                 
 IVHA                       I(4)            4     9120     1     760      COM                                                 
 IVLA                       I(4)            4     6080     1     760      COM                                                 
 IVW                        I(4)            4     1068     1     89       COM                                                 
 IVWG                       I(4)            4     4644     1     387      COM                                                 
 JBPAD1                     I(4)            4     452            scalar   COM                                                 
 JBPAD2                     I(4)            4     456            scalar   COM                                                 
 JBPAD3                     I(4)            4     460            scalar   COM                                                 
 JBPAD4                     I(4)            4     464            scalar   COM                                                 
 JBPAD5                     I(4)            4     468            scalar   COM                                                 
 JE_GLB_TABLE               I(4)            4     252      1     21       COM                                                 
 JE_LOC_TABLE               I(4)            4     744      1     21       COM                                                 
 JRA                        I(4)            4     12160    1     760      COM                                                 
 JS_GLB_TABLE               I(4)            4     168      1     21       COM                                                 
 JS_LOC_TABLE               I(4)            4     576      1     21       COM                                                 
 JTPAD1                     I(4)            4     472            scalar   COM                                                 
 JTPAD2                     I(4)            4     476            scalar   COM                                                 
 JTPAD3                     I(4)            4     480            scalar   COM                                                 
 JTPAD4                     I(4)            4     484            scalar   COM                                                 
 JTPAD5                     I(4)            4     488            scalar   COM                                                 
 K400                       I(4)            4     0              scalar   COM                                                 
 KTM                        I(4)            4     0              scalar   COM                                                 
 L2GI                       I(4)            4     956      1     239      COM                                                 
 L2GJ                       I(4)            4     3468     1     389      COM                                                 
 LC                         I(4)            4     1163056  2     6319     COM                                                 
 LIST                       I(4)            4     40             scalar   COM                                                 
 LMH                        I(4)            4     15200    2     6319     COM              643,717,799,974,993,1178           
 LMV                        I(4)            4     40476    2     6319     COM                                                 
 LTOP                       I(4)            4     16       1     3        COM              1046,1054                          
 LVL                        I(4)            4     60       2     6319     COM              644,718,800,957,958,975,994,1046,1 
                                                                                           054,1179,1429                      
 MPI_COMM_COMP              I(4)            4     912            scalar   COM                                                 
 MPI_COMM_INTER             I(4)            4     916            scalar   COM                                                 
 MPI_COMM_INTER_ARRAY       I(4)            4     920      1     100      COM                                                 
 MXSNAL                     R(4)            4     3524     2     6319     COM                                                 
 MYIE                       I(4)            4     52             scalar   COM              506,557,568,578,614,631,641,687,71 
                                                                                           6,797,920,964,972,992,1033,1157,11 
                                                                                           77,1370,1397,1427,1442,1488,1494,1 
                                                                                           501,1508,1516,1539,1545,1552,1559, 

Page 37          Source Listing                  RADTN
2022-02-15 16:38 Symbol Table                    RADTN.F

 Name                       Type            Bytes Offset   Dimen Elements Attributes       References                         
                                                                                                                              
                                                                                           1567                               
 MYIE1                      I(4)            4     56             scalar   COM                                                 
 MYIE1_P1                   I(4)            4     120            scalar   COM                                                 
 MYIE1_P2                   I(4)            4     124            scalar   COM                                                 
 MYIE1_P3                   I(4)            4     128            scalar   COM                                                 
 MYIE1_P4                   I(4)            4     132            scalar   COM                                                 
 MYIE2                      I(4)            4     60             scalar   COM                                                 
 MYIE2_P1                   I(4)            4     136            scalar   COM                                                 
 MYIE_P1                    I(4)            4     100            scalar   COM                                                 
 MYIE_P2                    I(4)            4     104            scalar   COM                                                 
 MYIE_P3                    I(4)            4     108            scalar   COM                                                 
 MYIE_P4                    I(4)            4     112            scalar   COM                                                 
 MYIE_P5                    I(4)            4     116            scalar   COM                                                 
 MYIS                       I(4)            4     40             scalar   COM              506,557,568,578,614,631,641,687,71 
                                                                                           6,797,920,964,972,992,1033,1157,11 
                                                                                           77,1370,1397,1427,1442,1488,1494,1 
                                                                                           501,1508,1516,1539,1545,1552,1559, 
                                                                                           1567                               
 MYIS1                      I(4)            4     44             scalar   COM                                                 
 MYIS1_P1                   I(4)            4     84             scalar   COM                                                 
 MYIS1_P2                   I(4)            4     88             scalar   COM                                                 
 MYIS1_P3                   I(4)            4     92             scalar   COM                                                 
 MYIS1_P4                   I(4)            4     96             scalar   COM                                                 
 MYIS2                      I(4)            4     48             scalar   COM                                                 
 MYIS_P1                    I(4)            4     64             scalar   COM                                                 
 MYIS_P2                    I(4)            4     68             scalar   COM                                                 
 MYIS_P3                    I(4)            4     72             scalar   COM                                                 
 MYIS_P4                    I(4)            4     76             scalar   COM                                                 
 MYIS_P5                    I(4)            4     80             scalar   COM                                                 
 MYJE                       I(4)            4     236            scalar   COM              505,556,567,577,610,1487,1493,1500 
                                                                                           ,1515,1538,1551,1566               
 MYJE1                      I(4)            4     240            scalar   COM              1544                               
 MYJE1_P1                   I(4)            4     280            scalar   COM                                                 
 MYJE1_P2                   I(4)            4     284            scalar   COM                                                 
 MYJE1_P3                   I(4)            4     288            scalar   COM                                                 
 MYJE1_P4                   I(4)            4     292            scalar   COM                                                 
 MYJE2                      I(4)            4     244            scalar   COM              1507,1558                          
 MYJE2_P1                   I(4)            4     296            scalar   COM                                                 
 MYJE2_P2                   I(4)            4     300            scalar   COM                                                 
 MYJE2_P3                   I(4)            4     304            scalar   COM                                                 
 MYJE2_P4                   I(4)            4     308            scalar   COM                                                 
 MYJE3                      I(4)            4     248            scalar   COM                                                 
 MYJE3_P4                   I(4)            4     312            scalar   COM                                                 
 MYJE4                      I(4)            4     252            scalar   COM                                                 
 MYJE4_P1                   I(4)            4     316            scalar   COM                                                 
 MYJE4_P4                   I(4)            4     320            scalar   COM                                                 
 MYJE5                      I(4)            4     256            scalar   COM                                                 
 MYJE5_P1                   I(4)            4     324            scalar   COM                                                 
 MYJE5_P2                   I(4)            4     328            scalar   COM                                                 
 MYJE_P1                    I(4)            4     260            scalar   COM                                                 
 MYJE_P2                    I(4)            4     264            scalar   COM                                                 
 MYJE_P3                    I(4)            4     268            scalar   COM                                                 
 MYJE_P4                    I(4)            4     272            scalar   COM                                                 
 MYJE_P5                    I(4)            4     276            scalar   COM                                                 
 MYJS                       I(4)            4     140            scalar   COM              505,556,567,577,610,1487,1493,1515 

Page 38          Source Listing                  RADTN
2022-02-15 16:38 Symbol Table                    RADTN.F

 Name                       Type            Bytes Offset   Dimen Elements Attributes       References                         
                                                                                                                              
                                                                                           ,1538,1544,1566                    
 MYJS1                      I(4)            4     144            scalar   COM              1500,1551                          
 MYJS1_P1                   I(4)            4     184            scalar   COM                                                 
 MYJS1_P2                   I(4)            4     188            scalar   COM                                                 
 MYJS1_P3                   I(4)            4     192            scalar   COM                                                 
 MYJS1_P4                   I(4)            4     196            scalar   COM                                                 
 MYJS2                      I(4)            4     148            scalar   COM              1507,1558                          
 MYJS2_P1                   I(4)            4     200            scalar   COM                                                 
 MYJS2_P2                   I(4)            4     204            scalar   COM                                                 
 MYJS2_P3                   I(4)            4     208            scalar   COM                                                 
 MYJS2_P4                   I(4)            4     212            scalar   COM                                                 
 MYJS3                      I(4)            4     152            scalar   COM                                                 
 MYJS3_P4                   I(4)            4     216            scalar   COM                                                 
 MYJS4                      I(4)            4     156            scalar   COM                                                 
 MYJS4_P1                   I(4)            4     220            scalar   COM                                                 
 MYJS4_P4                   I(4)            4     224            scalar   COM                                                 
 MYJS5                      I(4)            4     160            scalar   COM                                                 
 MYJS5_P1                   I(4)            4     228            scalar   COM                                                 
 MYJS5_P2                   I(4)            4     232            scalar   COM                                                 
 MYJS_P1                    I(4)            4     164            scalar   COM                                                 
 MYJS_P2                    I(4)            4     168            scalar   COM                                                 
 MYJS_P3                    I(4)            4     172            scalar   COM                                                 
 MYJS_P4                    I(4)            4     176            scalar   COM                                                 
 MYJS_P5                    I(4)            4     180            scalar   COM                                                 
 MYPE                       I(4)            4     0              scalar   COM              691                                
 MY_E                       I(4)            4     336            scalar   COM                                                 
 MY_IE_GLB                  I(4)            4     12             scalar   COM                                                 
 MY_IE_LOC                  I(4)            4     28             scalar   COM                                                 
 MY_IS_GLB                  I(4)            4     8              scalar   COM                                                 
 MY_IS_LOC                  I(4)            4     24             scalar   COM                                                 
 MY_JE_GLB                  I(4)            4     20             scalar   COM                                                 
 MY_JE_LOC                  I(4)            4     36             scalar   COM                                                 
 MY_JS_GLB                  I(4)            4     16             scalar   COM                                                 
 MY_JS_LOC                  I(4)            4     32             scalar   COM                                                 
 MY_N                       I(4)            4     332            scalar   COM                                                 
 MY_NE                      I(4)            4     348            scalar   COM                                                 
 MY_NEB                     I(4)            4     364      1     8        COM                                                 
 MY_NW                      I(4)            4     360            scalar   COM                                                 
 MY_S                       I(4)            4     340            scalar   COM                                                 
 MY_SE                      I(4)            4     352            scalar   COM                                                 
 MY_SW                      I(4)            4     356            scalar   COM                                                 
 MY_W                       I(4)            4     344            scalar   COM                                                 
 NBC                        I(4)            4     36             scalar   COM                                                 
 NBOCO                      I(4)            4     76             scalar   COM                                                 
 NCFRCV                     I(4)            4     25284    2     6319     COM              1415                               
 NCFRST                     I(4)            4     75836    2     6319     COM              1412,1419                          
 NCLOD                      I(4)            4     4              scalar   COM                                                 
 NCNVC                      I(4)            4     92             scalar   COM                                                 
 NCP                        I(4)            4     84             scalar   COM                                                 
 NEST                       I(4)            4     108            scalar   COM                                                 
 NFCST                      I(4)            4     32             scalar   COM                                                 
 NPES                       I(4)            4     4              scalar   COM                                                 
 NPHS                       I(4)            4     88             scalar   COM              563                                
 NPREC                      I(4)            4     68             scalar   COM                                                 
 NRADL                      I(4)            4     100            scalar   COM              521,530                            

Page 39          Source Listing                  RADTN
2022-02-15 16:38 Symbol Table                    RADTN.F

 Name                       Type            Bytes Offset   Dimen Elements Attributes       References                         
                                                                                                                              
 NRADS                      I(4)            4     96             scalar   COM              521,529,563                        
 NRDLW                      I(4)            4     4              scalar   COM                                                 
 NRDSW                      I(4)            4     4              scalar   COM                                                 
 NSHDE                      I(4)            4     80             scalar   COM                                                 
 NSTART                     I(4)            4     60             scalar   COM                                                 
 NTDDMP                     I(4)            4     64             scalar   COM                                                 
 NTSD                       I(4)            4     52             scalar   COM              529,530,539,545,564                
 NTSTM                      I(4)            4     56             scalar   COM                                                 
 PCTSNO                     R(4)            4     126380   2     6319     COM                                                 
 PD                         R(4)            4     0        2     6319     COM              507,688                            
 PL                         R(4)            4     48             scalar   COM                                                 
 PLQ                        R(4)            4     72             scalar   COM                                                 
 PREC                       R(4)            4     404416   2     6319     COM                                                 
 PSHLTR                     R(4)            4     758280   2     6319     COM                                                 
 PT                         R(4)            4     4              scalar   COM              650,651,669,677,688                
 PTBL                       R(4)            4     509044   2     10184    COM                                                 
 PTDYN                      R(4)            4     20             scalar   COM                                                 
 PTOPC                      R(4)            4     28       1     4        COM              498,499,500,501,1086,1087,1124,131 
                                                                                           3                                  
 PWTS                       R(4)            4     48       1     12       COM                                                 
 Q                          R(4)            4     3437536  3     284355   COM              655                                
 Q10                        R(4)            4     631900   2     6319     COM                                                 
 Q2                         R(4)            4     783556   3     284355   COM                                                 
 Q30                        R(4)            4     530796   2     6319     COM                                                 
 QS                         R(4)            4     176932   2     6319     COM                                                 
 QS0                        R(4)            4     628      1     134      COM                                                 
 QSHLTR                     R(4)            4     733004   2     6319     COM                                                 
 QWBS                       R(4)            4     303312   2     6319     COM                                                 
 QZ0                        R(4)            4     126380   2     6319     COM                                                 
 R1                         R(4)            4     56             scalar   COM              1394                               
 RADIN                      R(4)            4     54076    2     6319     COM                                                 
 RADOT                      R(4)            4     79352    2     6319     COM                                                 
 RDETA                      R(4)            4     216      1     45       COM                                                 
 RDP                        R(4)            4     64             scalar   COM                                                 
 RDPQ                       R(4)            4     76             scalar   COM                                                 
 RDQ                        R(4)            4     56             scalar   COM                                                 
 RDTH                       R(4)            4     60             scalar   COM                                                 
 RDTHE                      R(4)            4     68             scalar   COM                                                 
 RDTHEQ                     R(4)            4     80             scalar   COM                                                 
 RDYN                       R(4)            4     16             scalar   COM                                                 
 REFLO3                     R(4)            4     104            scalar   COM                                                 
 RES                        R(4)            4     4600232  2     6319     COM              507                                
 RESTRT                     L(4)            4     28             scalar   COM              529,530                            
 RF                         R(4)            4     252760   2     6319     COM                                                 
 RLWIN                      R(4)            4     12       2     6319     COM              1452                               
 RLWOUT                     R(4)            4     25288    2     6319     COM              1453                               
 RLWTOA                     R(4)            4     50564    2     6319     COM              1454                               
 RLWTT                      R(4)            4     151668   3     284355   COM              1431,1540,1568                     
 ROI                        R(4)            4     36             scalar   COM                                                 
 ROS                        R(4)            4     24             scalar   COM                                                 
 RRAYAV                     R(4)            4     108            scalar   COM                                                 
 RSWIN                      R(4)            4     12       2     6319     COM              1457                               
 RSWOUT                     R(4)            4     25288    2     6319     COM              1458                               
 RSWTOA                     R(4)            4     50564    2     6319     COM              1459                               
 RSWTT                      R(4)            4     151668   3     284355   COM              1430,1489,1517                     

Page 40          Source Listing                  RADTN
2022-02-15 16:38 Symbol Table                    RADTN.F

 Name                       Type            Bytes Offset   Dimen Elements Attributes       References                         
                                                                                                                              
 RTDPTH                     R(4)            4     480260   1     4        COM                                                 
 RUN                        L(4)            4     4              scalar   COM                                                 
 SFCEXC                     R(4)            4     25276    2     6319     COM                                                 
 SH2O                       R(4)            4     480276   3     25276    COM                                                 
 SI                         R(4)            4     353864   2     6319     COM                                                 
 SICE                       R(4)            4     75828    2     6319     COM                                                 
 SIGMA                      L(4)            4     0              scalar   COM                                                 
 SIGT4                      R(4)            4     483768   2     6319     COM              1444                               
 SLDPTH                     R(4)            4     480244   1     4        COM                                                 
 SM                         R(4)            4     50552    2     6319     COM              690,692,694,804,818                
 SMC                        R(4)            4     278036   3     25276    COM                                                 
 SMSTAV                     R(4)            4     50552    2     6319     COM                                                 
 SMSTOT                     R(4)            4     75828    2     6319     COM                                                 
 SNO                        R(4)            4     328588   2     6319     COM                                                 
 SOILTB                     R(4)            4     0        2     6319     COM                                                 
 SQS                        R(4)            4     1164     1     134      COM                                                 
 SR                         R(4)            4     1188332  2     6319     COM                                                 
 SST                        R(4)            4     332112   2     6319     COM                                                 
 STC                        R(4)            4     379140   3     25276    COM                                                 
 STHE                       R(4)            4     2004     1     76       COM                                                 
 STHEQ                      R(4)            4     2916     1     152      COM                                                 
 SUBPOST                    L(4)            4     104            scalar   COM                                                 
 T                          R(4)            4     25276    3     284355   COM              616,653,654                        
 TAUCV                      R(4)            4     44       1     3        COM                                                 
 TCLOD                      R(4)            4     0              scalar   COM                                                 
 TDTD                       R(4)            4     20             scalar   COM                                                 
 TDTQ2                      R(4)            4     12             scalar   COM                                                 
 TEMP1                      R(4)            4     0        2     91719    COM                                                 
 TEMP10                     R(4)            4     3301884  2     91719    COM                                                 
 TEMP11                     R(4)            4     3668760  2     91719    COM                                                 
 TEMP12                     R(4)            4     4035636  2     91719    COM                                                 
 TEMP13                     R(4)            4     4402512  2     91719    COM                                                 
 TEMP14                     R(4)            4     4769388  2     91719    COM                                                 
 TEMP15                     R(4)            4     5136264  2     91719    COM                                                 
 TEMP16                     R(4)            4     5503140  2     91719    COM                                                 
 TEMP2                      R(4)            4     366876   2     91719    COM                                                 
 TEMP2X                     R(4)            4     0        2     92971    COM                                                 
 TEMP3                      R(4)            4     733752   2     91719    COM                                                 
 TEMP4                      R(4)            4     1100628  2     91719    COM                                                 
 TEMP5                      R(4)            4     1467504  2     91719    COM                                                 
 TEMP6                      R(4)            4     1834380  2     91719    COM                                                 
 TEMP7                      R(4)            4     2201256  2     91719    COM                                                 
 TEMP8                      R(4)            4     2568132  2     91719    COM                                                 
 TEMP9                      R(4)            4     2935008  2     91719    COM                                                 
 TG                         R(4)            4     281560   2     6319     COM                                                 
 TH10                       R(4)            4     606624   2     6319     COM                                                 
 TH30                       R(4)            4     505520   2     6319     COM                                                 
 THE0                       R(4)            4     1700     1     76       COM                                                 
 THE0Q                      R(4)            4     2308     1     152      COM                                                 
 THL                        R(4)            4     52             scalar   COM                                                 
 THS                        R(4)            4     151656   2     6319     COM              690,692                            
 THZ0                       R(4)            4     101104   2     6319     COM                                                 
 TRDLW                      R(4)            4     0              scalar   COM                                                 
 TRDSW                      R(4)            4     0              scalar   COM                                                 
 TSHLTR                     R(4)            4     707728   2     6319     COM                                                 

Page 41          Source Listing                  RADTN
2022-02-15 16:38 Symbol Table                    RADTN.F

 Name                       Type            Bytes Offset   Dimen Elements Attributes       References                         
                                                                                                                              
 TTBL                       R(4)            4     549780   2     10184    COM                                                 
 TTBLQ                      R(4)            4     590516   2     66880    COM                                                 
 TTVG                       R(4)            4     371884   2     92971    COM                                                 
 TWBS                       R(4)            4     278036   2     6319     COM                                                 
 U                          R(4)            4     1162696  3     284355   COM                                                 
 U00                        R(4)            4     1137420  2     6319     COM              647                                
 U10                        R(4)            4     657176   2     6319     COM                                                 
 U30                        R(4)            4     556072   2     6319     COM                                                 
 UL                         R(4)            4     1162696  1     90       COM              742                                
 USTAR                      R(4)            4     25276    2     6319     COM                                                 
 UZ0                        R(4)            4     50552    2     6319     COM                                                 
 V                          R(4)            4     2300116  3     284355   COM                                                 
 V10                        R(4)            4     682452   2     6319     COM                                                 
 V30                        R(4)            4     581348   2     6319     COM                                                 
 VBM2                       R(4)            4     0        2     6319     COM                                                 
 VBM3                       R(4)            4     25276    2     6319     COM                                                 
 VEGFRC                     R(4)            4     227484   2     6319     COM                                                 
 VTM                        R(4)            4     1238524  3     284355   COM                                                 
 VZ0                        R(4)            4     75828    2     6319     COM                                                 
 WPDARX                     R(4)            4     32480    2     6319     COM                                                 
 Z0                         R(4)            4     0        2     6319     COM                                                 

Page 42          Source Listing                  RADTN
2022-02-15 16:38 Subprograms/Common Blocks       RADTN.F



SUBPROGRAMS/COMMON BLOCKS

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 ACMCLD                     Common 407                                  101112   SAVE                                               
 ACMRDL                     Common 415                                  1289088  SAVE                                               
 ACMRDS                     Common 425                                  1289088  SAVE                                               
 CLDWTR                     Common 377                                  1213608  SAVE                                               
 CNVCLD                     Common 386                                  101104   SAVE                                               
 CTLBLK                     Common 246                                  112      SAVE                                               
 CUINIT                     Common 432                                  4                                                           
 DYNAM                      Common 275                                  259964   SAVE                                               
 GLB_TABLE                  Common 182                                  336      SAVE                                               
 INDX                       Common 394                                  1708     SAVE                                               
 INDXG                      Common 400                                  8084     SAVE                                               
 LOOPS                      Common 255                                  65752    SAVE                                               
 MAPPINGS                   Common 201                                  5024     SAVE                                               
 MASKS                      Common 263                                  2426496  SAVE                                               
 MPPCOM                     Common 146                                  1724     SAVE                                               
 PHYS                       Common 294                                  858036   SAVE                                               
 PVRBLS                     Common 332                                  1946252  SAVE                                               
 RADTN                      Subr   3                                                                                                
 RD1TIM                     Common 438                                  25336                                                       
 SOIL                       Common 363                                  581380   SAVE                                               
 SWRSAV                     Common 436                                  112                                                         
 TEMPCOM                    Common 187                                  6603768  SAVE                                               
 TOPO                       Common 195                                  17478548 SAVE                                               
 VRBLS                      Common 321                                  4625508  SAVE                                               

COMPILER OPTIONS BEING USED

       -align noall                          -align nonone
       -align nocommons                      -align nodcommons
       -align noqcommons                     -align nozcommons
       -align records                        -align nosequence
       -align norec1byte                     -align norec2byte
       -align norec4byte                     -align norec8byte
       -align norec16byte                    -align norec32byte
       -align norec64byte                    -align noarray8byte
       -align noarray16byte                  -align noarray32byte
       -align noarray64byte                  -align noarray128byte
       -align noarray256byte                 -altparam
       -assume accuracy_sensitive            -assume nobscc
       -assume nobuffered_io                 -assume nobuffered_stdout
       -assume byterecl                      -assume nocontiguous_assumed_shape
       -assume nocontiguous_pointer          -assume nocc_omp
       -assume nocstring                     -assume nodummy_aliases
       -assume nofpe_summary                 -assume noieee_fpe_flags
       -assume nominus0                      -assume noold_boz
       -assume old_complex_align             -assume old_unit_star
       -assume old_inquire_recl              -assume old_ldout_format
       -assume old_ldout_zero                -assume noold_logical_assign
       -assume noold_logical_ldio            -assume old_maxminloc
       -assume old_xor                       -assume noprotect_allocates
       -assume protect_constants             -assume noprotect_parens

Page 43          Source Listing                  RADTN
2022-02-15 16:38                                 RADTN.F

       -assume split_common                  -assume source_include
       -assume nostd_intent_in               -assume std_minus0_rounding
       -assume nostd_mod_proc_name           -assume std_value
       -assume realloc_lhs                   -assume underscore
       -assume no2underscores                -assume norecursion
  no   -auto                                 -auto_scalar
  no   -bintext                              -ccdefault default
       -check noarg_temp_created             -check noassume
       -check nobounds                       -check nocontiguous
       -check noformat                       -check nooutput_conversion
       -check nooverflow                     -check nopointers
       -check noshape                        -check nostack
       -check nouninitialized                -check noudio_iostat
       -coarray-num-procs 0             no   -coarray-config-file
       -convert big_endian                   -cross_reference
       -D __INTEL_COMPILER=1910              -D __INTEL_COMPILER_UPDATE=3
       -D __unix__                           -D __unix
       -D __linux__                          -D __linux
       -D __gnu_linux__                      -D unix
       -D linux                              -D __ELF__
       -D __x86_64                           -D __x86_64__
       -D __amd64                            -D __amd64__
       -D __INTEL_COMPILER_BUILD_DATE=20200925       -D __INTEL_OFFLOAD
       -D __MMX__                            -D __SSE__
       -D __SSE_MATH__                       -D __SSE2__
       -D __SSE2_MATH__                      -D __SSE3__
       -D __SSSE3__                          -D __SSE4_1__
       -D __SSE4_2__                         -D __POPCNT__
       -D __PCLMUL__                         -D __AES__
       -D __AVX__                            -D __F16C__
       -D __AVX_I__                          -D __RDRND__
       -D __FMA__                            -D __FP_FAST_FMA
       -D __FP_FAST_FMAF                     -D __BMI__
       -D __LZCNT__                          -D __AVX2__
       -D __haswell                          -D __haswell__
       -D __tune_haswell__                   -D __core_avx2
       -D __core_avx2__                      -D __tune_core_avx2__
       -D __CRAY_X86_ROME                    -D __CRAYXT_COMPUTE_LINUX_TARGET
       -double_size 64                  no   -d_lines
  no   -Qdyncom                              -error_limit 30
  no   -f66                             no   -f77rtl
  no   -fast                                 -fpscomp nofilesfromcmd
       -fpscomp nogeneral                    -fpscomp noioformat
       -fpscomp noldio_spacing               -fpscomp nologicals
       -fixed                           no   -fpconstant
       -fpe3                                 -fprm nearest
  no   -ftz                                  -fp_model precise
       -fp_model nofast                      -fp_model nostrict
       -fp_model nosource                    -fp_model nodouble
       -fp_model noextended                  -fp_model novery_fast
       -fp_model noexcept                    -fp_model nono_except
       -fp_modbits nofp_contract             -fp_modbits nono_fp_contract
       -fp_modbits nofenv_access             -fp_modbits nono_fenv_access
       -fp_modbits nocx_limited_range        -fp_modbits nono_cx_limited_range
       -fp_modbits noprec_div                -fp_modbits nono_prec_div
       -fp_modbits noprec_sqrt               -fp_modbits nono_prec_sqrt
       -fp_modbits noftz                     -fp_modbits no_ftz

Page 44          Source Listing                  RADTN
2022-02-15 16:38                                 RADTN.F

       -fp_modbits nointrin_limited_range       -fp_modbits nono_intrin_limited_range
       -fp_modbits notrunc_compares          -fp_modbits nono_trunc_compares
       -fp_modbits noieee_nan_compares       -fp_modbits nono_ieee_nan_compares
       -fp_modbits nohonor_f32_conversion       -fp_modbits nono_honor_f32_conversion
       -fp_modbits nohonor_f64_conversion       -fp_modbits nono_honor_f64_conversion
       -fp_modbits nono_x87_copy             -fp_modbits nono_no_x87_copy
       -fp_modbits noexception_semantics       -fp_modbits nono_exception_semantics
       -fp_modbits noprecise_libm_functions       -fp_modbits nono_precise_libm_functions
       -heap_arrays 0                   no   -threadprivate_compat
       -g2                                   -iface nomixed_str_len_arg
       -iface nono_mixed_str_len_arg         -init noarrays
       -init nohuge                          -init noinfinity
       -init nominus_huge                    -init nominus_infinity
       -init nominus_tiny                    -init nonan
       -init nosnan                          -init notiny
       -init nozero                     no   -intconstant
       -integer_size 32                 no   -mixed_str_len_arg
  no   -module                               -names lowercase
  no   -noinclude                       no   -o
       -offload-build=host                   -openmp-simd
       -O2                              no   -pad_source
       -real_size 32                    no   -recursive
       -reentrancy threaded                  -vec=simd
       -show nofullpath                      -show noinclude
       -show map                             -show options
  no   -syntax_only                     no   -threadcom
  no   -U                               no   -vms
       -w noall                              -w nonone
       -w alignments                         -w nodeclarations
       -w noexternals                        -w general
       -w noignore_bounds                    -w noignore_loc
       -w nointerfaces                       -w noshape
       -w notruncated_source                 -w uncalled
       -w uninitialized                      -w nounused
       -w usage                         no   -wrap-margins

       -includepath : /pe/intel/compilers_and_libraries_2020.4.304/linux/pstl/include/,/pe/intel/compilers_and_libraries_2020.4.304/linux/compiler/include/,
           .f90,./.f90,/opt/cray/pe/mpich/8.1.9/ofi/intel/19.0/include/.f90,/pe/intel/compilers_and_libraries_2020.4.304/linux/ipp/include/.f90,
           /pe/intel/compilers_and_libraries_2020.4.304/linux/mkl/include/.f90,/pe/intel/compilers_and_libraries_2020.4.304/linux/pstl/include/.f90,
           /pe/intel/compilers_and_libraries_2020.4.304/linux/pstl/stdlib/.f90,/pe/intel/compilers_and_libraries_2020.4.304/linux/tbb/include/.f90,
           /pe/intel/compilers_and_libraries_2020.4.304/linux/compiler/include/intel64/.f90,/pe/intel/compilers_and_libraries_2020.4.304/linux/compiler/include/icc/.f90,
           /pe/intel/compilers_and_libraries_2020.4.304/linux/compiler/include/.f90,/usr/lib64/gcc/x86_64-suse-linux/7/include/.f90,
           /usr/lib64/gcc/x86_64-suse-linux/7/include-fixed/.f90,/usr/include/.f90,/usr/include/.f90,/usr/include/.f90
       -list filename : RADTN.lst
  no   -o

COMPILER: Intel(R) Fortran 19.1-1655
