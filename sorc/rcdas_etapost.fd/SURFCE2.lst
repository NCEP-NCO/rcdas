Page 1           Source Listing                  SURFCE2
2022-02-15 16:39                                 SURFCE2.f

      1       SUBROUTINE SURFCE2(IMOUT,JMOUT)
      2 C$$$  SUBPROGRAM DOCUMENTATION BLOCK
      3 C                .      .    .     
      4 C SUBPROGRAM:    SURFCE2     POST SURFACE BASED FIELDS
      5 C   PRGRMMR: TREADON         ORG: W/NP2      DATE: 92-12-21       
      6 C     
      7 C ABSTRACT:
      8 C     THIS ROUTINE POSTS SURFACE BASED FIELDS.
      9 C   .     
     10 C     
     11 C PROGRAM HISTORY LOG:
     12 C   92-12-21  RUSS TREADON
     13 C   94-08-04  MICHAEL BALDWIN - ADDED OUTPUT OF SFC FLUXES OF
     14 C                               SENS AND LATENT HEAT AND THETA AT Z0
     15 C   94-11-04  MICHAEL BALDWIN - ADDED INSTANTANEOUS PRECIP TYPE
     16 C   96-03-19  MICHAEL BALDWIN - CHANGE SOIL PARAMETERS
     17 C   96-09-25  MICHAEL BALDWIN - ADDED SNOW RATIO FROM EXPLICIT SCHEME
     18 C   96-10-17  MICHAEL BALDWIN - CHANGED SFCEVP,POTEVP TO ACCUM.  TOOK
     19 C                               OUT -PTRACE FOR ACSNOW,SSROFF,BGROFF.
     20 C   97-04-23  MICHAEL BALDWIN - TOOK OUT -PTRACE FOR ALL PRECIP FIELDS
     21 C   98-06-12  T BLACK         - CONVERSION FROM 1-D TO 2-D
     22 C   98-07-17  MIKE BALDWIN - REMOVED LABL84
     23 C   98-08-18  MIKE BALDWIN - COMPUTE RH OVER ICE
     24 C   98-12-22  MIKE BALDWIN - BACK OUT RH OVER ICE
     25 C   00-01-04  JIM TUCCILLO - MPI VERSION
     26 C   03-01-15  H CHUANG     - ADDED VEG AND SOIL TYPES
     27 C   03-01-17  CHUANG AND EK- ADDED CANOPY CONDUCTANCE, SNOW COVER AND DEPTH,
     28 C                            AND OTHER LAND SURFACE VARIABLES
     29 C   03-02-20  DUSAN JOVIC - ADDED 30m T,Q,WIND AND INTEGRATED MOISTURE FLUXES
     30 C     
     31 C USAGE:    CALL SURFCE2(IMOUT,JMOUT)
     32 C   INPUT ARGUMENT LIST:
     33 C     IMOUT    - FIRST DIMENSION OF OUTPUT GRID.
     34 C     JMOUT    - SECOND DIMENSION OF OUTPUT GRID.
     35 C
     36 C   OUTPUT ARGUMENT LIST: 
     37 C     
     38 C   OUTPUT FILES:
     39 C     NONE
     40 C     
     41 C   SUBPROGRAMS CALLED:
     42 C     UTILITIES:
     43 C       E2OUT    - INTERPOLATION/SMOOTHING ROUTINE.
     44 C       OUTPUT   - DRIVER FOR OUTPUT ROUTINES.
     45 C       BOUND    - ENFORCE LOWER AND UPPER LIMITS ON ARRAY ELEMENTS.
     46 C       SCLFLD   - SCALE ARRAY ELEMENTS BY CONSTANT.
     47 C       SHELTR2  - COMPUTE 2M TEMPERATURE AND SPECIFIC HUMIDITY.
     48 C       ANEMLV6  - COMPUTE 10M U AND V WINDS.
     49 C       DEWPOINT - COMPUTE DEWPOINT TEMPERATURE.
     50 C       CALDRG   - COMPUTE SURFACE LAYER DRAG COEFFICENT
     51 C       CALTAU   - COMPUTE SURFACE LAYER U AND V WIND STRESSES.
     52 C
     53 C     LIBRARY:
     54 C       COMMON   - CTLBLK
     55 C                  RQSTFLD
     56 C                  EXTRA
     57 C                  VRBLS

Page 2           Source Listing                  SURFCE2
2022-02-15 16:39                                 SURFCE2.f

     58 C                  MAPOT
     59 C                  MASKS
     60 C                  PVRBLS
     61 C                  CLDWTR
     62 C                  LOOPS
     63 C                  PHYS2
     64 C                  SRFDSP
     65 C                  CNVCLD
     66 C                  LLGRDS
     67 C                  SOIL
     68 C                  ACMSFC
     69 C                  ACMPRE
     70 C                  IOUNIT
     71 C     
     72 C   ATTRIBUTES:
     73 C     LANGUAGE: FORTRAN
     74 C     MACHINE : CRAY C-90
     75 C$$$  
     76 C
     77 C     
     78 C     INCLUDE GRID DIMENSIONS.  SET/DERIVE OTHER PARAMETERS.
     79 C     
     80       INCLUDE "parmeta"
     98       INCLUDE "parmout"
    102       INCLUDE "params"
    144       INCLUDE "parm.tbl"
    146       INCLUDE "parmsoil"
    147 C     
    148 C     IN NGM SUBROUTINE OUTPUT WE FIND THE FOLLOWING COMMENT.
    149 C     "IF THE FOLLOWING THRESHOLD VALUES ARE CHANGED, CONTACT
    150 C     TDL/SYNOPTIC-SCALE TECHNIQUES BRANCH (PAUL DALLAVALLE
    151 C     AND JOHN JENSENIUS).  THEY MAY BE USING IT IN ONE OF 
    152 C     THEIR PACKING CODES."  THE THRESHOLD VALUE IS 0.01 INCH
    153 C     OR 2.54E-4 METER.  PRECIPITATION VALUES LESS THAN THIS
    154 C     THRESHOLD ARE SET TO MINUS ONE TIMES THIS THRESHOLD.
    156       PARAMETER (PTRACE = 0.000254E0)
    157 C     
    158 C     SET CELCIUS TO KELVIN AND SECOND TO HOUR CONVERSION.
    159       PARAMETER (C2K    = 273.15)
    160       PARAMETER (SEC2HR = 1./3600.)
    161 C     
    162 C     DECLARE VARIABLES.
    163 C     
    164       LOGICAL RUN,FIRST,RESTRT,SIGMA,OLDRD,STDRD
    165       INTEGER IWX1(IM,JM),NROOTS(IM,JM)
    166       REAL PSFC(IM,JM),TSFC(IM,JM),QSFC(IM,JM),RHSFC(IM,JM)
    167       REAL ZSFC(IM,JM),THSFC(IM,JM),DWPSFC(IM,JM),EVP(IM,JM)
    168       REAL ANCPRC(IM,JM),P1D(IM,JM),T1D(IM,JM),Q1D(IM,JM)
    169       REAL EGRID1(IM,JM),EGRID2(IM,JM),UA(IM,JM),VA(IM,JM)
    170       REAL GC(IM,JM)
    171       REAL GRID1(IMOUT,JMOUT),GRID2(IMOUT,JMOUT),IW(IM,JM),IWM1
    172       REAL SLEET(IM,JM),RAIN(IM,JM),FREEZR(IM,JM),SNOW(IM,JM)
    173       REAL ECAN(IM,JM),EDIR(IM,JM),ETRANS(IM,JM),ESNOW(IM,JM)
    174      &,SMCDRY(IM,JM),SMCMAX(IM,JM)
    175       REAL RSMIN(IM,JM),SMCWLT(IM,JM),SMCREF(IM,JM)
    176      & ,RCS(IM,JM),RCQ(IM,JM),RCT(IM,JM),RCSOIL(IM,JM)
    177       REAL P10(IM,JM),P30(IM,JM),T10(IM,JM),T30(IM,JM)

Page 3           Source Listing                  SURFCE2
2022-02-15 16:39                                 SURFCE2.f

    178 C     
    179 C     INCLUDE COMMON BLOCKS.
    180       INCLUDE "CTLBLK.comm"
    195       INCLUDE "RQSTFLD.comm"
    208       INCLUDE "EXTRA.comm"
    220       INCLUDE "VRBLS.comm"
    227       INCLUDE "MAPOT.comm"
    240       INCLUDE "MASKS.comm"
    248       INCLUDE "PVRBLS.comm"
    260       INCLUDE "CLDWTR.comm"
    266       INCLUDE "LOOPS.comm"
    274       INCLUDE "PHYS2.comm"
    295       INCLUDE "SRFDSP.comm"
    301       INCLUDE "CNVCLD.comm"
    307       INCLUDE "LLGRDS.comm"
    321       INCLUDE "SOIL.comm"
    330       INCLUDE "ACMSFC.comm"
    337       INCLUDE "ACMPRE.comm"
    343       INCLUDE "IOUNIT.comm"
    351       INCLUDE "ACMRDS.comm"
    357       INCLUDE "QFLX.comm"
    380       INCLUDE "PPTASM.comm"
    381 C     
    382 C****************************************************************************
    383 C
    384 C     START SURFCE.
    385 C
    386 C     COMPUTE IW AT SFC FOR SFC AND 2M RH
    387 C
    410       IF ( (IGET(076).GT.0).OR.(IGET(114).GT.0) ) THEN
    411         CLIMIT =1.0E-20
    412         IW=0.
    413 C
    414         DO L=2,LM 
    415         DO J=JSTA,JEND
    416         DO I=1,IM
    417          IF (L.LE.LMH(I,J)) THEN
    418            IWM1=IW(I,J)
    419            IF(CWM(I,J,L).GT.CLIMIT) THEN
    420              IF(T(I,J,L).LT.258.15)THEN
    421                IW(I,J)=1.
    422              ELSEIF(T(I,J,L).GE.273.15)THEN
    423                IW(I,J)=0.
    424              ELSE
    425                IF(IWM1.EQ.1.0)IW(I,J)=1.
    426              ENDIF
    427            ELSE
    428              IW(I,J)=0.
    429            ENDIF
    430          ENDIF
    431         ENDDO
    432         ENDDO
    433         ENDDO
    434 C
    435       ENDIF
    436 C     
    437 C***  BLOCK 1.  SURFACE BASED FIELDS.

Page 4           Source Listing                  SURFCE2
2022-02-15 16:39                                 SURFCE2.f

    438 C
    439 C     IF ANY OF THE FOLLOWING "SURFACE" FIELDS ARE REQUESTED,
    440 C     WE NEED TO COMPUTE THE FIELDS FIRST.
    441 C     
    442       IF ( (IGET(024).GT.0).OR.(IGET(025).GT.0).OR.
    443      X     (IGET(026).GT.0).OR.(IGET(027).GT.0).OR.
    444      X     (IGET(028).GT.0).OR.(IGET(029).GT.0).OR.
    445      X     (IGET(154).GT.0).OR.
    446      X     (IGET(034).GT.0).OR.(IGET(076).GT.0) ) THEN
    447 C     
    448          DO 40 J=JSTA,JEND
    449          DO 40 I=1,IM
    450 C
    451 C           PRESSURE AND TEMPERATURE AT 10 AND 30 M.
    452             LMHK=LMH(I,J)
    453             P10(I,J)=(PD(I,J)+PT)*EXP(-10.0*G/(287.04*T(I,J,LMHK)))
    454             P30(I,J)=(PD(I,J)+PT)*EXP(-30.0*G/(287.04*T(I,J,LMHK)))
    455             T10(I,J)=TH10(I,J)*(P10(I,J)/P1000)**CAPA
    456             T30(I,J)=TH30(I,J)*(P30(I,J)/P1000)**CAPA
    457 C
    458 C           SCALE ARRAY FIS BY GI TO GET SURFACE HEIGHT.
    459             ZSFC(I,J)=FIS(I,J)*GI
    460 C
    461 C           SURFACE PRESSURE.
    462             PSFC(I,J)=PD(I,J)+PT
    463 C     
    464 C           SURFACE (SKIN) POTENTIAL TEMPERATURE AND TEMPERATURE.
    465             THSFC(I,J)=THS(I,J)
    466             TSFC(I,J) =THSFC(I,J)*(PSFC(I,J)/P1000)**CAPA 
    467 C     
    468 C           SURFACE SPECIFIC HUMIDITY, RELATIVE HUMIDITY,
    469 C           AND DEWPOINT.  ADJUST SPECIFIC HUMIDITY IF
    470 C           RELATIVE HUMIDITY EXCEEDS 0.1 OR 1.0.
    471 C
    472             QSFC(I,J)=QS(I,J)
    473             QSFC(I,J)=AMAX1(H1M12,QSFC(I,J))
    474             TSFCK    =TSFC(I,J)
    475 C     
    476             TMT0=TSFCK-273.16
    477             TMT15=AMIN1(TMT0,-15.)
    478             AI=0.008855
    479             BI=1.
    480             IF(TMT0.LT.-20.)THEN
    481               AI=0.007225
    482               BI=0.9674
    483             ENDIF
    484             QW=PQ0/PSFC(I,J)
    485      1          *EXP(A2*(TSFCK-A3)/(TSFCK-A4))
    486             QI=QW*(BI+AI*AMIN1(TMT0,0.))
    487             QINT=QW*(1.-0.00032*TMT15*(TMT15+15.))
    488             IF(TMT0.LT.-15.)THEN
    489                 QSAT=QI
    490             ELSEIF(TMT0.GE.0.)THEN
    491                 QSAT=QINT
    492             ELSE
    493               IF(IW(I,J).GT.0.0) THEN
    494                 QSAT=QI

Page 5           Source Listing                  SURFCE2
2022-02-15 16:39                                 SURFCE2.f

    495               ELSE
    496                 QSAT=QINT
    497               ENDIF
    498             ENDIF
    499 CMEB 12/22/98 SWITCH TO RH VS WATER NO MATTER WHAT
    500 C             DELETE THIS LINE TO SWITCH BACK TO RH VS ICE
    501             QSAT=QW
    502 CMEB 12/22/98 SWITCH TO RH VS WATER NO MATTER WHAT
    503 C
    504             RHSFC(I,J)=QSFC(I,J)/QSAT
    505 
    506             IF (RHSFC(I,J).GT.H1 ) RHSFC(I,J) = H1
    507             IF (RHSFC(I,J).LT.D00) RHSFC(I,J) = D01
    508             QSFC(I,J)  = RHSFC(I,J)*QSAT
    509             EVP(I,J)   = PSFC(I,J)*QSFC(I,J)/(EPS+ONEPS*QSFC(I,J))
    510             EVP(I,J)   = EVP(I,J)*D001
    511 C     
    512 C           ACCUMULATED NON-CONVECTIVE PRECIP.
    513             IF(IGET(034).GT.0)THEN
    514               IF(LVLS(1,IGET(034)).GT.0)THEN
    515                  ANCPRC(I,J)=ACPREC(I,J)-CUPREC(I,J)
    516               ENDIF
    517             ENDIF
    518 
    519  40      CONTINUE
    520 C     
    521 C        INTERPOLATE/OUTPUT REQUESTED SURFACE FIELDS.
    522 C     
    523 C        SURFACE PRESSURE.
    524          IF (IGET(024).GT.0) THEN
    525             CALL E2OUT(024,000,PSFC,EGRID2,GRID1,GRID2,IMOUT,JMOUT)
    526             ID(1:25) = 0
    527             CALL OUTPUT(IOUTYP,IGET(024),LVLS(1,IGET(024)),
    528      X           GRID1,IMOUT,JMOUT)
    529          ENDIF
    530 C
    531 C        SURFACE PRESSURE NN.
    532          IF (IGET(247).GT.0) THEN
    533             CALL E2OUT(247,000,PSFC,EGRID2,GRID1,GRID2,IMOUT,JMOUT)
    534             ID(1:25) = 0
    535             CALL OUTPUT(IOUTYP,IGET(247),LVLS(1,IGET(247)),
    536      X           GRID1,IMOUT,JMOUT)
    537          ENDIF
    538 C     
    539 C        SURFACE HEIGHT.
    540          IF (IGET(025).GT.0) THEN
    541             CALL E2OUT(025,000,ZSFC,EGRID2,GRID1,GRID2,IMOUT,JMOUT)
    542             CALL BOUND(GRID1,D00,H99999,IMOUT,JMOUT)
    543             ID(1:25) = 0
    544             CALL OUTPUT(IOUTYP,IGET(025),LVLS(1,IGET(025)),
    545      X           GRID1,IMOUT,JMOUT)
    546          ENDIF
    547 C
    548 C        SURFACE HEIGHT NN.
    549          IF (IGET(245).GT.0) THEN
    550             CALL E2OUT(245,000,ZSFC,EGRID2,GRID1,GRID2,IMOUT,JMOUT)
    551             CALL BOUND(GRID1,D00,H99999,IMOUT,JMOUT)

Page 6           Source Listing                  SURFCE2
2022-02-15 16:39                                 SURFCE2.f

    552             ID(1:25) = 0
    553             CALL OUTPUT(IOUTYP,IGET(245),LVLS(1,IGET(245)),
    554      X           GRID1,IMOUT,JMOUT)
    555          ENDIF
    556 C     
    557 C        SURFACE (SKIN) TEMPERATURE.
    558          IF (IGET(026).GT.0) THEN
    559             CALL E2OUT(026,000,TSFC,EGRID2,GRID1,GRID2,IMOUT,JMOUT)
    560             ID(1:25) = 0
    561             CALL OUTPUT(IOUTYP,IGET(026),LVLS(1,IGET(026)),
    562      X           GRID1,IMOUT,JMOUT)
    563          ENDIF
    564 C     
    565 C        SURFACE (SKIN) POTENTIAL TEMPERATURE.
    566          IF (IGET(027).GT.0) THEN
    567             CALL E2OUT(027,000,THSFC,EGRID2,GRID1,GRID2,IMOUT,JMOUT)
    568             ID(1:25) = 0
    569             CALL OUTPUT(IOUTYP,IGET(027),LVLS(1,IGET(027)),
    570      X           GRID1,IMOUT,JMOUT)
    571          ENDIF
    572 C     
    573 C        SURFACE SPECIFIC HUMIDITY.
    574          IF (IGET(028).GT.0) THEN
    575             CALL E2OUT(028,000,QSFC,EGRID2,GRID1,GRID2,IMOUT,JMOUT)
    576             CALL BOUND(GRID1,H1M12,H99999,IMOUT,JMOUT)
    577             ID(1:25) = 0
    578             CALL OUTPUT(IOUTYP,IGET(028),LVLS(1,IGET(028)),
    579      X           GRID1,IMOUT,JMOUT)
    580          ENDIF
    581 C     
    582 C        SURFACE DEWPOINT TEMPERATURE.
    583          IF (IGET(029).GT.0) THEN
    584             CALL DEWPOINT(EVP,DWPSFC,IM,JM)
    585             CALL E2OUT(029,000,DWPSFC,EGRID2,GRID1,GRID2,IMOUT,JMOUT)
    586             ID(1:25) = 0
    587             CALL OUTPUT(IOUTYP,IGET(029),LVLS(1,IGET(029)),
    588      X           GRID1,IMOUT,JMOUT)
    589          ENDIF
    590 C     
    591 C        SURFACE RELATIVE HUMIDITY.
    592          IF (IGET(076).GT.0) THEN
    593             CALL E2OUT(076,000,RHSFC,EGRID2,GRID1,GRID2,IMOUT,JMOUT)
    594             CALL SCLFLD(GRID1,H100,IMOUT,JMOUT)
    595             CALL BOUND(GRID1,H1,H100,IMOUT,JMOUT)
    596             ID(1:25) = 0
    597             CALL OUTPUT(IOUTYP,IGET(076),LVLS(1,IGET(076)),
    598      X           GRID1,IMOUT,JMOUT)
    599          ENDIF
    600 C     
    601       ENDIF
    602 C
    603 C     ADDITIONAL SURFACE-SOIL LEVEL FIELDS.
    604 C
    605 
    606       DO L=1,NSOIL
    607 C     SOIL TEMPERATURE.
    608       IF (IGET(116).GT.0) THEN

Page 7           Source Listing                  SURFCE2
2022-02-15 16:39                                 SURFCE2.f

    609         IF (LVLS(L,IGET(116)).GT.0) THEN
    610          DO J=JSTA,JEND
    611          DO I=1,IM
    612            EGRID1(I,J)=STC(I,J,L)
    613          ENDDO
    614          ENDDO
    615          CALL E2OUT(116,000,EGRID1,EGRID2,GRID1,GRID2,IMOUT,JMOUT)
    616          ID(1:25) = 0
    617           DTOP=0.
    618           DO LS=1,L-1
    619            DTOP=DTOP+SLDPTH(LS)
    620           ENDDO
    621           DBOT=DTOP+SLDPTH(L)
    622             ID(10) = NINT(DTOP*100.)
    623             ID(11) = NINT(DBOT*100.)
    624          CALL OUTPUT(IOUTYP,IGET(116),L,GRID1,IMOUT,JMOUT)
    625         ENDIF
    626       ENDIF
    627 C
    628 C     SOIL MOISTURE.
    629       IF (IGET(117).GT.0) THEN
    630         IF (LVLS(L,IGET(117)).GT.0) THEN
    631          DO J=JSTA,JEND
    632          DO I=1,IM
    633            EGRID1(I,J)=SMC(I,J,L)
    634          ENDDO
    635          ENDDO
    636          CALL E2OUT(117,000,EGRID1,EGRID2,GRID1,GRID2,IMOUT,JMOUT)
    637          ID(1:25) = 0
    638           DTOP=0.
    639           DO LS=1,L-1
    640            DTOP=DTOP+SLDPTH(LS)
    641           ENDDO
    642           DBOT=DTOP+SLDPTH(L)
    643             ID(10) = NINT(DTOP*100.)
    644             ID(11) = NINT(DBOT*100.)
    645          CALL OUTPUT(IOUTYP,IGET(117),L,GRID1,IMOUT,JMOUT)
    646         ENDIF
    647       ENDIF
    648 ! ADD LIQUID SOIL MOISTURE
    649       IF (IGET(225).GT.0) THEN
    650         IF (LVLS(L,IGET(225)).GT.0) THEN
    651          DO J=JSTA,JEND
    652          DO I=1,IM
    653            EGRID1(I,J)=SH2O(I,J,L)
    654          ENDDO
    655          ENDDO
    656          CALL E2OUT(225,000,EGRID1,EGRID2,GRID1,GRID2,IMOUT,JMOUT)
    657          ID(1:25) = 0
    658           DTOP=0.
    659           DO LS=1,L-1
    660            DTOP=DTOP+SLDPTH(LS)
    661           ENDDO
    662           DBOT=DTOP+SLDPTH(L)
    663             ID(10) = NINT(DTOP*100.)
    664             ID(11) = NINT(DBOT*100.)
    665             ID(02) = 130

Page 8           Source Listing                  SURFCE2
2022-02-15 16:39                                 SURFCE2.f

    666          CALL OUTPUT(IOUTYP,IGET(225),L,GRID1,IMOUT,JMOUT)
    667         ENDIF
    668       ENDIF
    669 ! END OF NSOIL LOOP
    670       ENDDO
    671 C
    672 C     BOTTOM SOIL TEMPERATURE.
    673       IF (IGET(115).GT.0) THEN
    674          CALL E2OUT(115,000,SOILTB,EGRID2,GRID1,GRID2,IMOUT,JMOUT)
    675          ID(1:25) = 0
    676          ISVALUE     = 800
    677          ID(11) = ISVALUE
    678          CALL OUTPUT(IOUTYP,IGET(115),LVLS(1,IGET(115)),
    679      X        GRID1,IMOUT,JMOUT)
    680       ENDIF
    681 C
    682 C     SOIL MOISTURE AVAILABILITY
    683       IF (IGET(171).GT.0) THEN
    684          CALL E2OUT(171,000,SMSTAV,EGRID2,GRID1,GRID2,IMOUT,JMOUT)
    685          ID(1:25) = 0
    686          ID(10) = 0
    687          ID(11) = 100
    688          CALL SCLFLD(GRID1,100.,IMOUT,JMOUT)
    689          CALL OUTPUT(IOUTYP,IGET(171),LVLS(1,IGET(171)),
    690      X        GRID1,IMOUT,JMOUT)
    691       ENDIF
    692 C
    693 C     TOTAL SOIL MOISTURE
    694       IF (IGET(036).GT.0) THEN
    695          CALL E2OUT(036,000,SMSTOT,EGRID2,GRID1,GRID2,IMOUT,JMOUT)
    696          ID(1:25) = 0
    697          ID(10) = 0
    698          ID(11) = 200
    699          CALL SCLFLD(GRID1,1000.,IMOUT,JMOUT)
    700          CALL OUTPUT(IOUTYP,IGET(036),LVLS(1,IGET(036)),
    701      X        GRID1,IMOUT,JMOUT)
    702       ENDIF
    703 C
    704 C     PLANT CANOPY SURFACE WATER.
    705       IF ( IGET(118).GT.0 ) THEN
    706          CALL E2OUT(118,000,CMC,EGRID2,GRID1,GRID2,IMOUT,JMOUT)
    707          ID(1:25) = 0
    708          CALL SCLFLD(GRID1,1000.,IMOUT,JMOUT)
    709          CALL OUTPUT(IOUTYP,IGET(118),LVLS(1,IGET(118)),
    710      X        GRID1,IMOUT,JMOUT)
    711       ENDIF
    712 C
    713 C     SNOW WATER EQUIVALENT.
    714       IF ( IGET(119).GT.0 ) THEN
    715          CALL E2OUT(119,000,SNO,EGRID2,GRID1,GRID2,IMOUT,JMOUT)
    716          ID(1:25) = 0
    717          CALL SCLFLD(GRID1,1000.,IMOUT,JMOUT)
    718          CALL OUTPUT(IOUTYP,IGET(119),LVLS(1,IGET(119)),
    719      X        GRID1,IMOUT,JMOUT)
    720       ENDIF
    721 C
    722 C     PERCENT SNOW COVER.

Page 9           Source Listing                  SURFCE2
2022-02-15 16:39                                 SURFCE2.f

    723       IF ( IGET(120).GT.0 ) THEN
    724          DO J=JSTA,JEND
    725           DO I=1,IM
    726            SNEQV=SNO(I,J)
    727            IVEG=IVGTYP(I,J)
    728            CALL SNFRAC (SNEQV,IVEG,SNCOVR)
    729            PCTSNO(I,J)=SNCOVR
    730           END DO
    731          END DO
    732          CALL E2OUT(120,000,PCTSNO,EGRID2,GRID1,GRID2,IMOUT,JMOUT)
    733          CALL BOUND(GRID1,D00,H1,IMOUT,JMOUT)
    734          ID(1:25) = 0
    735          CALL OUTPUT(IOUTYP,IGET(120),LVLS(1,IGET(120)),
    736      X        GRID1,IMOUT,JMOUT)
    737       ENDIF
    738 ! ADD SNOW DEPTH
    739       IF ( IGET(224).GT.0 ) THEN
    740          CALL E2OUT(224,000,SI,EGRID2,GRID1,GRID2,IMOUT,JMOUT)
    741          ID(1:25) = 0
    742          CALL OUTPUT(IOUTYP,IGET(224),LVLS(1,IGET(224)),
    743      X        GRID1,IMOUT,JMOUT)
    744       ENDIF
    745 ! ADD POTENTIAL EVAPORATION
    746 C      IF ( IGET(242).GT.0 ) THEN
    747 C         CALL E2OUT(242,000,POTEVP,EGRID2,GRID1,GRID2,IMOUT,JMOUT)
    748 C         ID(1:25) = 0
    749 C         CALL OUTPUT(IOUTYP,IGET(242),LVLS(1,IGET(242)),
    750 C     X        GRID1,IMOUT,JMOUT)
    751 C      END IF
    752 ! ADD EC,EDIR,ETRANS,ESNOW,SMCDRY,SMCMAX
    753       IF ( IGET(228).GT.0 .OR. IGET(229).GT.0
    754      + .OR.IGET(230).GT.0 .OR. IGET(231).GT.0
    755      + .OR.IGET(232).GT.0 .OR. IGET(233).GT.0) THEN
    756         DO J=JSTA,JEND
    757          DO I=1,IM
    758 C ----------------------------------------------------------------------
    759 !          IF(QWBS(I,J).gt.0.001)print*,'NONZERO QWBS',i,j,QWBS(I,J)
    760 !          IF(abs(SM(I,J)-0.).lt.1.0E-5)THEN
    761           IF( (abs(SM(I,J)-0.)   .lt. 1.0E-5) .AND.
    762      &        (abs(SICE(I,J)-0.) .lt. 1.0E-5) ) THEN
    763            CALL ETCALC(QWBS(I,J),POTEVP(I,J),SNO(I,J),VEGFRC(I,J)
    764      &  ,  ISLTYP(I,J),SH2O(I,J,1:1),CMC(I,J)
    765      &  ,  ECAN(I,J),EDIR(I,J),ETRANS(I,J),ESNOW(I,J),SMCDRY(I,J)
    766      &  ,  SMCMAX(I,J) )
    767           ELSE
    768            ECAN(I,J)=0.
    769            EDIR(I,J)=0.
    770            ETRANS(I,J)=0.
    771            ESNOW(I,J)=0.
    772            SMCDRY(I,J)=0.
    773            SMCMAX(I,J)=0.
    774           END IF
    775          END DO
    776         END DO
    777         IF ( IGET(228).GT.0 )THEN
    778          CALL E2OUT(228,000,ECAN,EGRID2,GRID1,GRID2,IMOUT,JMOUT)
    779          ID(1:25) = 0

Page 10          Source Listing                  SURFCE2
2022-02-15 16:39                                 SURFCE2.f

    780          CALL OUTPUT(IOUTYP,IGET(228),LVLS(1,IGET(228)),
    781      X        GRID1,IMOUT,JMOUT)
    782         END IF
    783 !
    784         IF ( IGET(229).GT.0 )THEN
    785          CALL E2OUT(229,000,EDIR,EGRID2,GRID1,GRID2,IMOUT,JMOUT)
    786          ID(1:25) = 0
    787          CALL OUTPUT(IOUTYP,IGET(229),LVLS(1,IGET(229)),
    788      X        GRID1,IMOUT,JMOUT)
    789         END IF
    790 !
    791         IF ( IGET(230).GT.0 )THEN
    792          CALL E2OUT(230,000,ETRANS,EGRID2,GRID1,GRID2,IMOUT,JMOUT)
    793          ID(1:25) = 0
    794          CALL OUTPUT(IOUTYP,IGET(230),LVLS(1,IGET(230)),
    795      X        GRID1,IMOUT,JMOUT)
    796         END IF
    797 !
    798         IF ( IGET(231).GT.0 )THEN
    799          CALL E2OUT(231,000,ESNOW,EGRID2,GRID1,GRID2,IMOUT,JMOUT)
    800          ID(1:25) = 0
    801          ID(02)= 130
    802          CALL OUTPUT(IOUTYP,IGET(231),LVLS(1,IGET(231)),
    803      X        GRID1,IMOUT,JMOUT)
    804         END IF
    805 !
    806         IF ( IGET(232).GT.0 )THEN
    807          CALL E2OUT(232,000,SMCDRY,EGRID2,GRID1,GRID2,IMOUT,JMOUT)
    808          ID(1:25) = 0
    809          ID(02)= 130
    810          CALL OUTPUT(IOUTYP,IGET(232),LVLS(1,IGET(232)),
    811      X        GRID1,IMOUT,JMOUT)
    812         END IF
    813 !
    814         IF ( IGET(233).GT.0 )THEN
    815          CALL E2OUT(233,000,SMCMAX,EGRID2,GRID1,GRID2,IMOUT,JMOUT)
    816          ID(1:25) = 0
    817          ID(02)= 130
    818          CALL OUTPUT(IOUTYP,IGET(233),LVLS(1,IGET(233)),
    819      X        GRID1,IMOUT,JMOUT)
    820         END IF
    821 !
    822       ENDIF
    823 C
    824 C     
    825 C
    826 C***  BLOCK 2.  SHELTER (2M) LEVEL FIELDS.
    827 C     
    828 C     COMPUTE/POST SHELTER LEVEL FIELDS.
    829 C     
    830       IF ( (IGET(106).GT.0).OR.(IGET(112).GT.0).OR.
    831      X     (IGET(113).GT.0).OR.(IGET(114).GT.0).OR.
    832      X     (IGET(138).GT.0) ) THEN
    833 C
    834 C        CALL SHELTR2(PSHLTR,QSHLTR,TSHLTR)
    835 C
    836 C        SHELTER LEVEL TEMPERATURE

Page 11          Source Listing                  SURFCE2
2022-02-15 16:39                                 SURFCE2.f

    837          IF (IGET(106).GT.0) THEN
    838             CALL E2OUT(106,000,TSHLTR,EGRID2,GRID1,GRID2,IMOUT,JMOUT)
    839             ID(1:25) = 0
    840             ISVALUE = 2
    841             ID(10) = MOD(ISVALUE/256,256)
    842             ID(11) = MOD(ISVALUE,256)
    843             CALL OUTPUT(IOUTYP,IGET(106),LVLS(1,IGET(106)),
    844      X           GRID1,IMOUT,JMOUT)
    845          ENDIF
    846 C
    847 C        SHELTER LEVEL SPECIFIC HUMIDITY.
    848          IF (IGET(112).GT.0) THEN       
    849             CALL E2OUT(112,000,QSHLTR,EGRID1,GRID1,GRID2,IMOUT,JMOUT)
    850             CALL BOUND (GRID1,H1M12,H99999,IMOUT,JMOUT)
    851             ID(1:25) = 0
    852             ISVALUE = 2
    853             ID(10) = MOD(ISVALUE/256,256)
    854             ID(11) = MOD(ISVALUE,256)
    855             CALL OUTPUT(IOUTYP,IGET(112),LVLS(1,IGET(112)),
    856      X           GRID1,IMOUT,JMOUT)
    857          ENDIF
    858 C     
    859 C        SHELTER LEVEL DEWPOINT.
    860          IF (IGET(113).GT.0) THEN
    861             DO J=JSTA,JEND
    862             DO I=1,IM
    863               EVP(I,J)=PSHLTR(I,J)*QSHLTR(I,J)/(EPS+ONEPS*QSHLTR(I,J))
    864 	      EVP(I,J)=EVP(I,J)*D001
    865             ENDDO
    866             ENDDO
    867             CALL DEWPOINT(EVP,EGRID1,IM,JM)
    868             CALL E2OUT(113,000,EGRID1,EGRID2,GRID1,GRID2,IMOUT,JMOUT)
    869             ID(1:25) = 0
    870             ISVALUE = 2
    871             ID(10) = MOD(ISVALUE/256,256)
    872             ID(11) = MOD(ISVALUE,256)
    873             CALL OUTPUT(IOUTYP,IGET(113),LVLS(1,IGET(113)),
    874      X           GRID1,IMOUT,JMOUT)
    875          ENDIF
    876 C     
    877 C        SHELTER LEVEL RELATIVE HUMIDITY.
    878          IF (IGET(114).GT.0) THEN
    879             CALL CALRH2(PSHLTR,TSHLTR,QSHLTR,IW,EGRID1,IM,JM)
    880             CALL E2OUT(114,000,EGRID1,EGRID2,GRID1,GRID2,IMOUT,JMOUT)
    881             CALL SCLFLD(GRID1,H100,IMOUT,JMOUT)
    882             CALL BOUND(GRID1,H1,H100,IMOUT,JMOUT)
    883             ID(1:25) = 0
    884             ISVALUE = 2
    885             ID(10) = MOD(ISVALUE/256,256)
    886             ID(11) = MOD(ISVALUE,256)
    887             CALL OUTPUT(IOUTYP,IGET(114),LVLS(1,IGET(114)),
    888      X           GRID1,IMOUT,JMOUT)
    889          ENDIF
    890 C     
    891 C        SHELTER LEVEL PRESSURE.
    892          IF (IGET(138).GT.0) THEN
    893             CALL E2OUT(138,000,PSHLTR,EGRID1,GRID1,GRID2,IMOUT,JMOUT)

Page 12          Source Listing                  SURFCE2
2022-02-15 16:39                                 SURFCE2.f

    894             ID(1:25) = 0
    895             ISVALUE = 2
    896             ID(10) = MOD(ISVALUE/256,256)
    897             ID(11) = MOD(ISVALUE,256)
    898             CALL OUTPUT(IOUTYP,IGET(138),LVLS(1,IGET(138)),
    899      X           GRID1,IMOUT,JMOUT)
    900          ENDIF
    901 C
    902       ENDIF
    903 C
    904 C
    905 C     BLOCK 3.  ANEMOMETER LEVEL (10M) WINDS, THETA, AND Q.
    906 C
    907       IF ( (IGET(064).GT.0).OR.(IGET(065).GT.0) ) THEN
    908 C        CALL ANEMLV6(UA,VA)
    909          ID(1:25) = 0
    910          ISVALUE = 10
    911          ID(10) = MOD(ISVALUE/256,256)
    912          ID(11) = MOD(ISVALUE,256)
    913 C
    914 C        ANEMOMETER LEVEL U WIND AND/OR V WIND.
    915          IF ((IGET(064).GT.0).OR.(IGET(065).GT.0)) THEN
    916             CALL E2OUT(064,065,U10,V10,GRID1,GRID2,IMOUT,JMOUT)
    917             IF (IGET(064).GT.0) CALL OUTPUT(IOUTYP,IGET(064),
    918      X           LVLS(1,IGET(064)),GRID1,IMOUT,JMOUT)
    919             IF (IGET(065).GT.0) CALL OUTPUT(IOUTYP,IGET(065),
    920      X           LVLS(1,IGET(065)),GRID2,IMOUT,JMOUT)
    921          ENDIF
    922       ENDIF
    923 C
    924 C        ANEMOMETER LEVEL (10 M) POTENTIAL TEMPERATURE.
    925 C
    926       IF (IGET(158).GT.0) THEN
    927          ID(1:25) = 0
    928          ISVALUE = 10
    929          ID(10) = MOD(ISVALUE/256,256)
    930          ID(11) = MOD(ISVALUE,256)
    931          CALL E2OUT(158,000,TH10,EGRID2,GRID1,GRID2,IMOUT,JMOUT)
    932          CALL OUTPUT(IOUTYP,IGET(158),
    933      X        LVLS(1,IGET(158)),GRID1,IMOUT,JMOUT)
    934        ENDIF
    935 C
    936 C        ANEMOMETER LEVEL (10 M) TEMPERATURE.
    937 C
    938       IF (IGET(185).GT.0) THEN
    939          ID(1:25) = 0
    940          ISVALUE = 10
    941          ID(10) = MOD(ISVALUE/256,256)
    942          ID(11) = MOD(ISVALUE,256)
    943          CALL E2OUT(185,000,T10,EGRID2,GRID1,GRID2,IMOUT,JMOUT)
    944          CALL OUTPUT(IOUTYP,IGET(185),
    945      X        LVLS(1,IGET(185)),GRID1,IMOUT,JMOUT)
    946        ENDIF
    947 C
    948 C        ANEMOMETER LEVEL (10 M) PRESSURE.
    949 C
    950       IF (IGET(186).GT.0) THEN

Page 13          Source Listing                  SURFCE2
2022-02-15 16:39                                 SURFCE2.f

    951          ID(1:25) = 0
    952          ISVALUE = 10
    953          ID(10) = MOD(ISVALUE/256,256)
    954          ID(11) = MOD(ISVALUE,256)
    955          CALL E2OUT(186,000,P10,EGRID2,GRID1,GRID2,IMOUT,JMOUT)
    956          CALL OUTPUT(IOUTYP,IGET(186),
    957      X        LVLS(1,IGET(186)),GRID1,IMOUT,JMOUT)
    958        ENDIF
    959 C
    960 C        ANEMOMETER LEVEL (10 M) SPECIFIC HUMIDITY.
    961 C
    962       IF (IGET(159).GT.0) THEN
    963          ID(1:25) = 0
    964          ISVALUE = 10
    965          ID(10) = MOD(ISVALUE/256,256)
    966          ID(11) = MOD(ISVALUE,256)
    967          CALL E2OUT(159,000,Q10,EGRID2,GRID1,GRID2,IMOUT,JMOUT)
    968          CALL OUTPUT(IOUTYP,IGET(159),
    969      X        LVLS(1,IGET(159)),GRID1,IMOUT,JMOUT)
    970        ENDIF
    971 C
    972 C
    973 C     BLOCK 3.1 30M WINDS, THETA, AND Q.
    974 C
    975       IF ( (IGET(193).GT.0).OR.(IGET(194).GT.0) ) THEN
    976 C        CALL ANEMLV6(UA,VA)
    977          ID(1:25) = 0
    978          ISVALUE = 30
    979          ID(10) = MOD(ISVALUE/256,256)
    980          ID(11) = MOD(ISVALUE,256)
    981 C
    982 C        ANEMOMETER LEVEL U WIND AND/OR V WIND.
    983          IF ((IGET(193).GT.0).OR.(IGET(194).GT.0)) THEN
    984             CALL E2OUT(193,194,U30,V30,GRID1,GRID2,IMOUT,JMOUT)
    985             IF (IGET(193).GT.0) CALL OUTPUT(IOUTYP,IGET(193),
    986      X           LVLS(1,IGET(193)),GRID1,IMOUT,JMOUT)
    987             IF (IGET(194).GT.0) CALL OUTPUT(IOUTYP,IGET(194),
    988      X           LVLS(1,IGET(194)),GRID2,IMOUT,JMOUT)
    989          ENDIF
    990       ENDIF
    991 C
    992 C        30 M POTENTIAL TEMPERATURE.
    993 C
    994       IF (IGET(191).GT.0) THEN
    995          ID(1:25) = 0
    996          ISVALUE = 30
    997          ID(10) = MOD(ISVALUE/256,256)
    998          ID(11) = MOD(ISVALUE,256)
    999          CALL E2OUT(191,000,TH30,EGRID2,GRID1,GRID2,IMOUT,JMOUT)
   1000          CALL OUTPUT(IOUTYP,IGET(191),
   1001      X        LVLS(1,IGET(191)),GRID1,IMOUT,JMOUT)
   1002        ENDIF
   1003 C
   1004 C        30 M TEMPERATURE.
   1005 C
   1006       IF (IGET(189).GT.0) THEN
   1007          ID(1:25) = 0

Page 14          Source Listing                  SURFCE2
2022-02-15 16:39                                 SURFCE2.f

   1008          ISVALUE = 30
   1009          ID(10) = MOD(ISVALUE/256,256)
   1010          ID(11) = MOD(ISVALUE,256)
   1011          CALL E2OUT(189,000,T30,EGRID2,GRID1,GRID2,IMOUT,JMOUT)
   1012          CALL OUTPUT(IOUTYP,IGET(189),
   1013      X        LVLS(1,IGET(189)),GRID1,IMOUT,JMOUT)
   1014        ENDIF
   1015 C
   1016 C        30 M PRESSURE.
   1017 C
   1018       IF (IGET(190).GT.0) THEN
   1019          ID(1:25) = 0
   1020          ISVALUE = 30
   1021          ID(10) = MOD(ISVALUE/256,256)
   1022          ID(11) = MOD(ISVALUE,256)
   1023          CALL E2OUT(190,000,P30,EGRID2,GRID1,GRID2,IMOUT,JMOUT)
   1024          CALL OUTPUT(IOUTYP,IGET(190),
   1025      X        LVLS(1,IGET(190)),GRID1,IMOUT,JMOUT)
   1026        ENDIF
   1027 C
   1028 C        30 M SPECIFIC HUMIDITY.
   1029 C
   1030       IF (IGET(192).GT.0) THEN
   1031          ID(1:25) = 0
   1032          ISVALUE = 30
   1033          ID(10) = MOD(ISVALUE/256,256)
   1034          ID(11) = MOD(ISVALUE,256)
   1035          CALL E2OUT(192,000,Q30,EGRID2,GRID1,GRID2,IMOUT,JMOUT)
   1036          CALL OUTPUT(IOUTYP,IGET(192),
   1037      X        LVLS(1,IGET(192)),GRID1,IMOUT,JMOUT)
   1038        ENDIF
   1039 C
   1040 C
   1041 C
   1042 C***  BLOCK 4.  PRECIPITATION RELATED FIELDS.
   1043 C     
   1044 C     SNOW FRACTION FROM EXPLICIT CLOUD SCHEME.  LABELLED AS
   1045 C      'PROB OF FROZEN PRECIP' IN GRIB, 
   1046 C      DIDN'T KNOW WHAT ELSE TO CALL IT
   1047       IF (IGET(172).GT.0) THEN
   1048          DO J=JSTA,JEND
   1049          DO I=1,IM
   1050            EGRID1(I,J)=SR(I,J)*100.
   1051          ENDDO
   1052          ENDDO
   1053          CALL E2OUT(172,000,EGRID1,EGRID2,GRID1,GRID2,IMOUT,JMOUT)
   1054          ID(1:25) = 0
   1055          CALL OUTPUT(IOUTYP,IGET(172),LVLS(1,IGET(172)),
   1056      X        GRID1,IMOUT,JMOUT)
   1057       ENDIF
   1058 C     INSTANTANEOUS PRECIPITATION RATE.
   1059       IF (IGET(167).GT.0) THEN
   1060          RDTPHS=1./DTQ2
   1061 	write(*,*) 'prdgen surface2 prate'
   1062          DO J=JSTA,JEND
   1063          DO I=1,IM
   1064            EGRID1(I,J)=PREC(I,J)*RDTPHS

Page 15          Source Listing                  SURFCE2
2022-02-15 16:39                                 SURFCE2.f

   1065 	if (egrid1(i,j).lt.0.0) write(*,*) 'neg prate ij=',i,j,egrid1(i,j)
   1066          ENDDO
   1067          ENDDO
   1068 	write(*,*) '>>e2out'
   1069          CALL E2OUT(167,000,EGRID1,EGRID2,GRID1,GRID2,IMOUT,JMOUT)
   1070          ID(1:25) = 0
   1071          CALL SCLFLD(GRID1,1000.,IMOUT,JMOUT)
   1072          CALL OUTPUT(IOUTYP,IGET(167),LVLS(1,IGET(167)),
   1073      X        GRID1,IMOUT,JMOUT)
   1074       ENDIF
   1075 C     
   1076 C     ACCUMULATED TOTAL PRECIPITATION.
   1077       IF (IGET(087).GT.0) THEN
   1078          CALL E2OUT(087,000,ACPREC,EGRID2,GRID1,GRID2,IMOUT,JMOUT)
   1079          ID(1:25) = 0
   1080          IFHR       = NTSD/TSPH + 0.5
   1081          ITPREC     = INT(TPREC)
   1082          IFINCR     = MOD(IFHR,ITPREC)
   1083          ID(19)     = IFHR
   1084          ID(20)     = 4
   1085          IF (IFINCR.EQ.0) THEN
   1086             ID(18) = IFHR-ITPREC
   1087          ELSE
   1088             ID(18) = IFHR-IFINCR
   1089          ENDIF
   1090          IF (ID(18).LT.0) ID(18) = 0
   1091          CALL SCLFLD(GRID1,1000.,IMOUT,JMOUT)
   1092          CALL OUTPUT(IOUTYP,IGET(087),LVLS(1,IGET(087)),
   1093      X        GRID1,IMOUT,JMOUT)
   1094       ENDIF
   1095 C
   1096 C     ACCUMULATED TOTAL PRECIPITATION NN - NEAREST NEIGHBOR.
   1097       IF (IGET(246).GT.0) THEN
   1098          CALL E2OUT(246,000,ACPREC,EGRID2,GRID1,GRID2,IMOUT,JMOUT)
   1099          ID(1:25) = 0
   1100          IFHR       = NTSD/TSPH + 0.5
   1101          ITPREC     = INT(TPREC)
   1102          IFINCR     = MOD(IFHR,ITPREC)
   1103          ID(19)     = IFHR
   1104          ID(20)     = 4
   1105          IF (IFINCR.EQ.0) THEN
   1106             ID(18) = IFHR-ITPREC
   1107          ELSE
   1108             ID(18) = IFHR-IFINCR
   1109          ENDIF
   1110          IF (ID(18).LT.0) ID(18) = 0
   1111          CALL SCLFLD(GRID1,1000.,IMOUT,JMOUT)
   1112          CALL OUTPUT(IOUTYP,IGET(246),LVLS(1,IGET(246)),
   1113      X        GRID1,IMOUT,JMOUT)
   1114       ENDIF
   1115 C     
   1116 C     ACCUMULATED CONVECTIVE PRECIPITATION.
   1117       IF (IGET(033).GT.0) THEN
   1118          CALL E2OUT(033,000,CUPREC,EGRID2,GRID1,GRID2,IMOUT,JMOUT)
   1119          ID(1:25) = 0
   1120          IFHR       = NTSD/TSPH + 0.5
   1121          ITPREC     = INT(TPREC)

Page 16          Source Listing                  SURFCE2
2022-02-15 16:39                                 SURFCE2.f

   1122          IFINCR     = MOD(IFHR,ITPREC)
   1123          ID(19)     = IFHR
   1124          ID(20)     = 4
   1125          IF (IFINCR.EQ.0) THEN
   1126             ID(18) = IFHR-ITPREC
   1127          ELSE
   1128             ID(18) = IFHR-IFINCR
   1129          ENDIF
   1130          IF (ID(18).LT.0) ID(18) = 0
   1131          CALL SCLFLD(GRID1,1000.,IMOUT,JMOUT)
   1132          CALL OUTPUT(IOUTYP,IGET(033),LVLS(1,IGET(033)),
   1133      X        GRID1,IMOUT,JMOUT)
   1134       ENDIF
   1135 C     
   1136 C     ACCUMULATED GRID-SCALE PRECIPITATION.
   1137       IF (IGET(034).GT.0) THEN
   1138          CALL E2OUT(034,000,ANCPRC,EGRID2,GRID1,GRID2,IMOUT,JMOUT)
   1139          ID(1:25) = 0
   1140          IFHR       = NTSD/TSPH + 0.5
   1141          ITPREC     = INT(TPREC)
   1142          IFINCR     = MOD(IFHR,ITPREC)
   1143          ID(19)     = IFHR
   1144          ID(20)     = 4
   1145          IF (IFINCR.EQ.0) THEN
   1146             ID(18) = IFHR-ITPREC
   1147          ELSE
   1148             ID(18) = IFHR-IFINCR
   1149          ENDIF
   1150          IF (ID(18).LT.0) ID(18) = 0
   1151          CALL SCLFLD(GRID1,1000.,IMOUT,JMOUT)
   1152          CALL OUTPUT(IOUTYP,IGET(034),LVLS(1,IGET(034)),
   1153      X        GRID1,IMOUT,JMOUT)
   1154       ENDIF
   1155 C     
   1156 C     ACCUMULATED SNOWFALL.
   1157          IF (IGET(035).GT.0) THEN
   1158             CALL E2OUT(035,000,ACSNOW,EGRID2,
   1159      x           GRID1,GRID2,IMOUT,JMOUT)
   1160             ID(1:25) = 0
   1161             IFHR       = NTSD/TSPH + 0.5
   1162             ITPREC     = INT(TPREC)
   1163             IFINCR     = MOD(IFHR,ITPREC)
   1164             ID(19)     = IFHR
   1165             ID(20)     = 4
   1166             IF (IFINCR.EQ.0) THEN
   1167                ID(18) = IFHR-ITPREC
   1168             ELSE
   1169                ID(18) = IFHR-IFINCR
   1170             ENDIF
   1171             IF (ID(18).LT.0) ID(18) = 0
   1172             CALL SCLFLD(GRID1,1000.,IMOUT,JMOUT)
   1173             CALL OUTPUT(IOUTYP,IGET(035),LVLS(1,IGET(035)),
   1174      X           GRID1,IMOUT,JMOUT)
   1175          ENDIF
   1176 C     
   1177 C     ACCUMULATED SNOW MELT.
   1178          IF (IGET(121).GT.0) THEN

Page 17          Source Listing                  SURFCE2
2022-02-15 16:39                                 SURFCE2.f

   1179             CALL E2OUT(121,000,ACSNOM,EGRID2,
   1180      x           GRID1,GRID2,IMOUT,JMOUT)
   1181             ID(1:25) = 0
   1182             IFHR       = NTSD/TSPH + 0.5
   1183             ITPREC     = INT(TPREC)
   1184             IFINCR     = MOD(IFHR,ITPREC)
   1185             ID(19)     = IFHR
   1186             ID(20)     = 4
   1187             IF (IFINCR.EQ.0) THEN
   1188                ID(18) = IFHR-ITPREC
   1189             ELSE
   1190                ID(18) = IFHR-IFINCR
   1191             ENDIF
   1192             IF (ID(18).LT.0) ID(18) = 0
   1193             CALL SCLFLD(GRID1,1000.,IMOUT,JMOUT)
   1194             CALL OUTPUT(IOUTYP,IGET(121),LVLS(1,IGET(121)),
   1195      X           GRID1,IMOUT,JMOUT)
   1196          ENDIF
   1197 C     
   1198 C     ACCUMULATED STORM SURFACE RUNOFF.
   1199          IF (IGET(122).GT.0) THEN
   1200             CALL E2OUT(122,000,SSROFF,EGRID2,
   1201      x           GRID1,GRID2,IMOUT,JMOUT)
   1202             ID(1:25) = 0
   1203             IFHR       = NTSD/TSPH + 0.5
   1204             ITPREC     = INT(TPREC)
   1205             IFINCR     = MOD(IFHR,ITPREC)
   1206             ID(19)     = IFHR
   1207             ID(20)     = 4
   1208             IF (IFINCR.EQ.0) THEN
   1209                ID(18) = IFHR-ITPREC
   1210             ELSE
   1211                ID(18) = IFHR-IFINCR
   1212             ENDIF
   1213             IF (ID(18).LT.0) ID(18) = 0
   1214             CALL SCLFLD(GRID1,1000.,IMOUT,JMOUT)
   1215             CALL OUTPUT(IOUTYP,IGET(122),LVLS(1,IGET(122)),
   1216      X           GRID1,IMOUT,JMOUT)
   1217          ENDIF
   1218 C     
   1219 C     ACCUMULATED BASEFLOW-GROUNDWATER RUNOFF.
   1220          IF (IGET(123).GT.0) THEN
   1221             CALL E2OUT(123,000,BGROFF,EGRID2,
   1222      x           GRID1,GRID2,IMOUT,JMOUT)
   1223             ID(1:25) = 0
   1224             IFHR       = NTSD/TSPH + 0.5
   1225             ITPREC     = INT(TPREC)
   1226             IFINCR     = MOD(IFHR,ITPREC)
   1227             ID(19)     = IFHR
   1228             ID(20)     = 4
   1229             IF (IFINCR.EQ.0) THEN
   1230                ID(18) = IFHR-ITPREC
   1231             ELSE
   1232                ID(18) = IFHR-IFINCR
   1233             ENDIF
   1234             IF (ID(18).LT.0) ID(18) = 0
   1235             CALL SCLFLD(GRID1,1000.,IMOUT,JMOUT)

Page 18          Source Listing                  SURFCE2
2022-02-15 16:39                                 SURFCE2.f

   1236             CALL OUTPUT(IOUTYP,IGET(123),LVLS(1,IGET(123)),
   1237      X           GRID1,IMOUT,JMOUT)
   1238          ENDIF
   1239 C     
   1240 C     INSTANTANEOUS PRECIPITATION TYPE.
   1241          IF (IGET(160).GT.0) THEN
   1242             CALL CALWXT(T,Q,RES,PD,HTM,LMH,PREC,PT,AETA,ETA,IWX1)
   1243             ID(1:25) = 0
   1244 C     
   1245 C     DECOMPOSE IWX1 ARRAY
   1246 C
   1247             DO J=JSTA,JEND
   1248             DO I=1,IM
   1249               IWX=IWX1(I,J)
   1250               ISNO=MOD(IWX,2)
   1251               IIP=MOD(IWX,4)/2
   1252               IZR=MOD(IWX,8)/4
   1253               IRAIN=IWX/8
   1254               SNOW(I,J)   = ISNO*1.0
   1255               SLEET(I,J)  = IIP*1.0
   1256               FREEZR(I,J) = IZR*1.0
   1257               RAIN(I,J)   = IRAIN*1.0
   1258             ENDDO
   1259             ENDDO
   1260 C     
   1261 C     INTERPOLATE/OUTPUT REQUESTED SURFACE FIELDS.
   1262 C     
   1263 C     SNOW.
   1264             ID(8) = 143
   1265             CALL E2OUT(160,000,SNOW,EGRID2,GRID1,GRID2,IMOUT,JMOUT)
   1266             CALL OUTPUT(IOUTYP,IGET(160),LVLS(1,IGET(160)),
   1267      X           GRID1,IMOUT,JMOUT)
   1268 C     ICE PELLETS.
   1269             ID(8) = 142
   1270             CALL E2OUT(160,000,SLEET,EGRID2,GRID1,GRID2,IMOUT,JMOUT)
   1271             CALL OUTPUT(IOUTYP,IGET(160),LVLS(1,IGET(160)),
   1272      X           GRID1,IMOUT,JMOUT)
   1273 C     FREEZING RAIN.
   1274             ID(8) = 141
   1275             CALL E2OUT(160,000,FREEZR,EGRID2,GRID1,GRID2,IMOUT,JMOUT)
   1276             CALL OUTPUT(IOUTYP,IGET(160),LVLS(1,IGET(160)),
   1277      X           GRID1,IMOUT,JMOUT)
   1278 C     RAIN.
   1279             ID(8) = 140
   1280             CALL E2OUT(160,000,RAIN,EGRID2,GRID1,GRID2,IMOUT,JMOUT)
   1281             CALL OUTPUT(IOUTYP,IGET(160),LVLS(1,IGET(160)),
   1282      X           GRID1,IMOUT,JMOUT)
   1283          ENDIF
   1284 C     
   1285 C
   1286 C
   1287 C***  BLOCK 5.  SURFACE EXCHANGE FIELDS.
   1288 C     
   1289 C     TIME AVERAGED SURFACE LATENT HEAT FLUX.
   1290          IF (IGET(042).GT.0) THEN
   1291             IF(ASRFC.GT.0.)THEN
   1292               RRNUM=1./ASRFC

Page 19          Source Listing                  SURFCE2
2022-02-15 16:39                                 SURFCE2.f

   1293             ELSE
   1294               RRNUM=0.
   1295             ENDIF
   1296             DO J=JSTA,JEND
   1297             DO I=1,IM
   1298               EGRID1(I,J) = SFCLHX(I,J)*RRNUM
   1299             ENDDO
   1300             ENDDO
   1301             CALL E2OUT(042,000,EGRID1,EGRID2,
   1302      X           GRID1,GRID2,IMOUT,JMOUT)
   1303             ID(1:25) = 0
   1304             IFHR       = NTSD/TSPH + 0.5
   1305             ITSRFC     = INT(TSRFC)
   1306             IFINCR     = MOD(IFHR,ITSRFC)
   1307             ID(19)     = IFHR
   1308             ID(20)     = 3
   1309             IF (IFINCR.EQ.0) THEN
   1310                ID(18) = IFHR-ITSRFC
   1311             ELSE
   1312                ID(18) = IFHR-IFINCR
   1313             ENDIF
   1314             IF (ID(18).LT.0) ID(18) = 0
   1315             CALL OUTPUT(IOUTYP,IGET(042),LVLS(1,IGET(042)),
   1316      X           GRID1,IMOUT,JMOUT)
   1317          ENDIF
   1318 C
   1319 C     TIME AVERAGED SURFACE SENSIBLE HEAT FLUX.
   1320          IF (IGET(043).GT.0) THEN
   1321             IF(ASRFC.GT.0.)THEN
   1322               RRNUM=1./ASRFC
   1323             ELSE
   1324               RRNUM=0.
   1325             ENDIF
   1326             DO J=JSTA,JEND
   1327             DO I=1,IM
   1328               EGRID1(I,J) = SFCSHX(I,J)*RRNUM
   1329             ENDDO
   1330             ENDDO
   1331             CALL E2OUT(043,000,EGRID1,EGRID2,
   1332      X           GRID1,GRID2,IMOUT,JMOUT)
   1333             ID(1:25) = 0
   1334             IFHR       = NTSD/TSPH + 0.5
   1335             ITSRFC     = INT(TSRFC)
   1336             IFINCR     = MOD(IFHR,ITSRFC)
   1337             ID(19)     = IFHR
   1338             ID(20)     = 3
   1339             IF (IFINCR.EQ.0) THEN
   1340                ID(18) = IFHR-ITSRFC
   1341             ELSE
   1342                ID(18) = IFHR-IFINCR
   1343             ENDIF
   1344             IF (ID(18).LT.0) ID(18) = 0
   1345             CALL OUTPUT(IOUTYP,IGET(043),LVLS(1,IGET(043)),
   1346      X           GRID1,IMOUT,JMOUT)
   1347          ENDIF
   1348 C     
   1349 C     TIME AVERAGED SUB-SURFACE SENSIBLE HEAT FLUX.

Page 20          Source Listing                  SURFCE2
2022-02-15 16:39                                 SURFCE2.f

   1350          IF (IGET(135).GT.0) THEN
   1351             IF(ASRFC.GT.0.)THEN
   1352               RRNUM=1./ASRFC
   1353             ELSE
   1354               RRNUM=0.
   1355             ENDIF
   1356             DO J=JSTA,JEND
   1357             DO I=1,IM
   1358               EGRID1(I,J) = SUBSHX(I,J)*RRNUM
   1359             ENDDO
   1360             ENDDO
   1361             CALL E2OUT(135,000,EGRID1,EGRID2,
   1362      X           GRID1,GRID2,IMOUT,JMOUT)
   1363             ID(1:25) = 0
   1364             IFHR       = NTSD/TSPH + 0.5
   1365             ITSRFC     = INT(TSRFC)
   1366             IFINCR     = MOD(IFHR,ITSRFC)
   1367             ID(19)     = IFHR
   1368             ID(20)     = 3
   1369             IF (IFINCR.EQ.0) THEN
   1370                ID(18) = IFHR-ITSRFC
   1371             ELSE
   1372                ID(18) = IFHR-IFINCR
   1373             ENDIF
   1374             IF (ID(18).LT.0) ID(18) = 0
   1375             CALL OUTPUT(IOUTYP,IGET(135),LVLS(1,IGET(135)),
   1376      X           GRID1,IMOUT,JMOUT)
   1377          ENDIF
   1378 C     
   1379 C     TIME AVERAGED SNOW PHASE CHANGE HEAT FLUX.
   1380          IF (IGET(136).GT.0) THEN
   1381             IF(ASRFC.GT.0.)THEN
   1382               RRNUM=1./ASRFC
   1383             ELSE
   1384               RRNUM=0.
   1385             ENDIF
   1386             DO J=JSTA,JEND
   1387             DO I=1,IM
   1388               EGRID1(I,J) = SNOPCX(I,J)*RRNUM
   1389             ENDDO
   1390             ENDDO
   1391             CALL E2OUT(136,000,EGRID1,EGRID2,
   1392      X           GRID1,GRID2,IMOUT,JMOUT)
   1393             ID(1:25) = 0
   1394             IFHR       = NTSD/TSPH + 0.5
   1395             ITSRFC     = INT(TSRFC)
   1396             IFINCR     = MOD(IFHR,ITSRFC)
   1397             ID(19)     = IFHR
   1398             ID(20)     = 3
   1399             IF (IFINCR.EQ.0) THEN
   1400                ID(18) = IFHR-ITSRFC
   1401             ELSE
   1402                ID(18) = IFHR-IFINCR
   1403             ENDIF
   1404             IF (ID(18).LT.0) ID(18) = 0
   1405             CALL OUTPUT(IOUTYP,IGET(136),LVLS(1,IGET(136)),
   1406      X           GRID1,IMOUT,JMOUT)

Page 21          Source Listing                  SURFCE2
2022-02-15 16:39                                 SURFCE2.f

   1407          ENDIF
   1408 C     
   1409 C     TIME AVERAGED SURFACE MOMENTUM FLUX.
   1410          IF (IGET(046).GT.0) THEN
   1411             IF(ASRFC.GT.0.)THEN
   1412               RRNUM=1./ASRFC
   1413             ELSE
   1414               RRNUM=0.
   1415             ENDIF
   1416             DO J=JSTA,JEND
   1417             DO I=1,IM
   1418               EGRID1(I,J) = SFCUVX(I,J)*RRNUM
   1419             ENDDO
   1420             ENDDO
   1421             CALL E2OUT(046,000,EGRID1,EGRID2,
   1422      X           GRID1,GRID2,IMOUT,JMOUT)
   1423             ID(1:25) = 0
   1424             IFHR       = NTSD/TSPH + 0.5
   1425             ITSRFC     = INT(TSRFC)
   1426             IFINCR     = MOD(IFHR,ITSRFC)
   1427             ID(19)     = IFHR
   1428             ID(20)     = 3
   1429             IF (IFINCR.EQ.0) THEN
   1430                ID(18) = IFHR-ITSRFC
   1431             ELSE
   1432                ID(18) = IFHR-IFINCR
   1433             ENDIF
   1434             IF (ID(18).LT.0) ID(18) = 0
   1435             CALL OUTPUT(IOUTYP,IGET(046),LVLS(1,IGET(046)),
   1436      X           GRID1,IMOUT,JMOUT)
   1437          ENDIF
   1438 C     
   1439 C     ACCUMULATED SURFACE EVAPORATION
   1440          IF (IGET(047).GT.0) THEN
   1441             DO J=JSTA,JEND
   1442             DO I=1,IM
   1443               EGRID1(I,J) = SFCEVP(I,J)
   1444             ENDDO
   1445             ENDDO
   1446             CALL E2OUT(047,000,EGRID1,EGRID2,
   1447      X           GRID1,GRID2,IMOUT,JMOUT)
   1448             ID(1:25) = 0
   1449             IFHR       = NTSD/TSPH + 0.5
   1450             ITPREC     = INT(TPREC)
   1451             IFINCR     = MOD(IFHR,ITPREC)
   1452             ID(19)     = IFHR
   1453             ID(20)     = 4
   1454             IF (IFINCR.EQ.0) THEN
   1455                ID(18) = IFHR-ITPREC
   1456             ELSE
   1457                ID(18) = IFHR-IFINCR
   1458             ENDIF
   1459             IF (ID(18).LT.0) ID(18) = 0
   1460             CALL SCLFLD(GRID1,1000.,IMOUT,JMOUT)
   1461             CALL OUTPUT(IOUTYP,IGET(047),LVLS(1,IGET(047)),
   1462      X           GRID1,IMOUT,JMOUT)
   1463          ENDIF

Page 22          Source Listing                  SURFCE2
2022-02-15 16:39                                 SURFCE2.f

   1464 C     
   1465 C     ACCUMULATED POTENTIAL EVAPORATION
   1466          IF (IGET(137).GT.0) THEN
   1467             DO J=JSTA,JEND
   1468             DO I=1,IM
   1469               EGRID1(I,J) = POTEVP(I,J)
   1470             ENDDO
   1471             ENDDO
   1472             CALL E2OUT(137,000,EGRID1,EGRID2,
   1473      X           GRID1,GRID2,IMOUT,JMOUT)
   1474             ID(1:25) = 0
   1475             IFHR       = NTSD/TSPH + 0.5
   1476             ITPREC     = INT(TPREC)
   1477             IFINCR     = MOD(IFHR,ITPREC)
   1478             ID(19)     = IFHR
   1479             ID(20)     = 4
   1480             IF (IFINCR.EQ.0) THEN
   1481                ID(18) = IFHR-ITPREC
   1482             ELSE
   1483                ID(18) = IFHR-IFINCR
   1484             ENDIF
   1485             IF (ID(18).LT.0) ID(18) = 0
   1486             CALL SCLFLD(GRID1,1000.,IMOUT,JMOUT)
   1487             CALL OUTPUT(IOUTYP,IGET(137),LVLS(1,IGET(137)),
   1488      X           GRID1,IMOUT,JMOUT)
   1489          ENDIF
   1490 C     
   1491 C     ROUGHNESS LENGTH.
   1492       IF (IGET(044).GT.0) THEN
   1493          CALL E2OUT(044,000,Z0,EGRID2,GRID1,GRID2,IMOUT,JMOUT)
   1494          ID(1:25) = 0
   1495          CALL OUTPUT(IOUTYP,IGET(044),LVLS(1,IGET(044)),
   1496      X        GRID1,IMOUT,JMOUT)
   1497       ENDIF
   1498 C     
   1499 C     FRICTION VELOCITY.
   1500       IF (IGET(045).GT.0) THEN
   1501          CALL E2OUT(045,000,USTAR,EGRID2,GRID1,GRID2,IMOUT,JMOUT)
   1502          ID(1:25) = 0
   1503          CALL OUTPUT(IOUTYP,IGET(045),LVLS(1,IGET(045)),
   1504      X        GRID1,IMOUT,JMOUT)
   1505       ENDIF
   1506 C     
   1507 C     SURFACE DRAG COEFFICIENT.
   1508       IF (IGET(132).GT.0) THEN
   1509          CALL CALDRG(EGRID1)
   1510          CALL E2OUT(132,000,EGRID1,EGRID2,GRID1,GRID2,IMOUT,JMOUT)
   1511          ID(1:25) = 0
   1512          CALL OUTPUT(IOUTYP,IGET(132),LVLS(1,IGET(132)),
   1513      X        GRID1,IMOUT,JMOUT)
   1514       ENDIF
   1515 C     
   1516 C     SURFACE U AND/OR V COMPONENT WIND STRESS
   1517       IF ( (IGET(133).GT.0) .OR. (IGET(134).GT.0) ) THEN
   1518          CALL CALTAU(EGRID1,EGRID2)
   1519 C     
   1520 C        SURFACE U COMPONENT WIND STRESS.

Page 23          Source Listing                  SURFCE2
2022-02-15 16:39                                 SURFCE2.f

   1521          IF (IGET(133).GT.0) THEN
   1522             CALL E2OUT(133,000,EGRID1,EGRID2,
   1523      X           GRID1,GRID2,IMOUT,JMOUT)
   1524             ID(1:25) = 0
   1525             CALL OUTPUT(IOUTYP,IGET(133),LVLS(1,IGET(133)),
   1526      X           GRID1,IMOUT,JMOUT)
   1527          ENDIF
   1528 C     
   1529 C        SURFACE V COMPONENT WIND STRESS
   1530          IF (IGET(134).GT.0) THEN
   1531             CALL E2OUT(134,000,EGRID2,EGRID1,
   1532      X           GRID1,GRID2,IMOUT,JMOUT)
   1533             ID(1:25) = 0
   1534             CALL OUTPUT(IOUTYP,IGET(134),LVLS(1,IGET(134)),
   1535      X           GRID1,IMOUT,JMOUT)
   1536          ENDIF
   1537       ENDIF
   1538 C     
   1539 C     INSTANTANEOUS SENSIBLE HEAT FLUX
   1540       IF (IGET(154).GT.0) THEN
   1541          CALL E2OUT(154,000,TWBS,EGRID2,GRID1,GRID2,IMOUT,JMOUT)
   1542          ID(1:25) = 0
   1543          CALL OUTPUT(IOUTYP,IGET(154),LVLS(1,IGET(154)),
   1544      X        GRID1,IMOUT,JMOUT)
   1545       ENDIF
   1546 C     
   1547 C     INSTANTANEOUS LATENT HEAT FLUX
   1548       IF (IGET(155).GT.0) THEN
   1549          CALL E2OUT(155,000,QWBS,EGRID2,GRID1,GRID2,IMOUT,JMOUT)
   1550          ID(1:25) = 0
   1551          CALL OUTPUT(IOUTYP,IGET(155),LVLS(1,IGET(155)),
   1552      X        GRID1,IMOUT,JMOUT)
   1553       ENDIF
   1554 C     
   1555 C     SURFACE EXCHANGE COEFF
   1556       IF (IGET(169).GT.0) THEN
   1557          CALL E2OUT(169,000,SFCEXC,EGRID2,GRID1,GRID2,IMOUT,JMOUT)
   1558          ID(1:25) = 0
   1559          CALL OUTPUT(IOUTYP,IGET(169),LVLS(1,IGET(169)),
   1560      X        GRID1,IMOUT,JMOUT)
   1561       ENDIF
   1562 C     
   1563 C     GREEN VEG FRACTION
   1564       IF (IGET(170).GT.0) THEN
   1565          CALL E2OUT(170,000,VEGFRC,EGRID2,GRID1,GRID2,IMOUT,JMOUT)
   1566          ID(1:25) = 0
   1567          CALL SCLFLD(GRID1,100.,IMOUT,JMOUT)
   1568          CALL OUTPUT(IOUTYP,IGET(170),LVLS(1,IGET(170)),
   1569      X        GRID1,IMOUT,JMOUT)
   1570       ENDIF
   1571 C     
   1572 C     INSTANTANEOUS GROUND HEAT FLUX
   1573       IF (IGET(152).GT.0) THEN
   1574          CALL E2OUT(152,000,GRNFLX,EGRID2,GRID1,GRID2,IMOUT,JMOUT)
   1575          ID(1:25) = 0
   1576          CALL OUTPUT(IOUTYP,IGET(152),LVLS(1,IGET(152)),
   1577      X        GRID1,IMOUT,JMOUT)

Page 24          Source Listing                  SURFCE2
2022-02-15 16:39                                 SURFCE2.f

   1578       ENDIF
   1579 !
   1580 !    VEGETATION TYPE
   1581       IF (IGET(218).GT.0) THEN
   1582          DO J=JSTA,JEND
   1583            DO I=1,IM
   1584              EGRID1(I,J) = FLOAT(IVGTYP(I,J))
   1585            ENDDO
   1586          ENDDO
   1587          CALL E2OUT(218,000,EGRID1,EGRID2,GRID1,GRID2,IMOUT,JMOUT)
   1588          ID(1:25) = 0
   1589          CALL OUTPUT(IOUTYP,IGET(218),LVLS(1,IGET(218)),
   1590      X        GRID1,IMOUT,JMOUT)
   1591       ENDIF
   1592 !
   1593 !    SOIL TYPE
   1594       IF (IGET(219).GT.0) THEN
   1595          DO J=JSTA,JEND
   1596            DO I=1,IM
   1597              EGRID1(I,J) = FLOAT(ISLTYP(I,J))
   1598            ENDDO
   1599          ENDDO
   1600          CALL E2OUT(219,000,EGRID1,EGRID2,GRID1,GRID2,IMOUT,JMOUT)
   1601          ID(1:25) = 0
   1602          CALL OUTPUT(IOUTYP,IGET(219),LVLS(1,IGET(219)),
   1603      X        GRID1,IMOUT,JMOUT)
   1604       ENDIF
   1605 !
   1606 !    SLOPE TYPE
   1607       IF (IGET(223).GT.0) THEN
   1608          DO J=JSTA,JEND
   1609            DO I=1,IM
   1610              EGRID1(I,J) = FLOAT(ISLOPE(I,J))
   1611            ENDDO
   1612          ENDDO
   1613          CALL E2OUT(223,000,EGRID1,EGRID2,GRID1,GRID2,IMOUT,JMOUT)
   1614          ID(1:25) = 0
   1615          ID(02)= 130
   1616          CALL OUTPUT(IOUTYP,IGET(223),LVLS(1,IGET(223)),
   1617      X        GRID1,IMOUT,JMOUT)
   1618       ENDIF
   1619 !
   1620 ! CANOPY CONDUCTANCE
   1621       IF (IGET(220).GT.0 .OR. IGET(234).GT.0
   1622      & .OR. IGET(235).GT.0 .OR. IGET(236).GT.0
   1623      & .OR. IGET(237).GT.0 .OR. IGET(238).GT.0
   1624      & .OR. IGET(239).GT.0 .OR. IGET(240).GT.0
   1625      & .OR. IGET(241).GT.0) THEN
   1626          DO J=JSTA,JEND
   1627            DO I=1,IM
   1628 !             IF(abs(SM(I,J)-0.).lt.1.0E-5)THEN
   1629              IF( (abs(SM(I,J)-0.)   .lt. 1.0E-5) .AND.
   1630      &           (abs(SICE(I,J)-0.) .lt. 1.0E-5) ) THEN
   1631               IF(CZMEAN(I,J).GT.1.E-6) THEN
   1632                FACTRS=CZEN(I,J)/CZMEAN(I,J)
   1633               ELSE
   1634                FACTRS=0.0

Page 25          Source Listing                  SURFCE2
2022-02-15 16:39                                 SURFCE2.f

   1635               ENDIF
   1636               SOLAR=HBM2(I,J)*RSWIN(I,J)*FACTRS
   1637               SFCTMP=T(I,J,LMH(I,J))
   1638               SFCQ=Q(I,J,LMH(I,J))
   1639               SFCPRS=PT+PDSL(I,J)*AETA(LMH(I,J))
   1640 !              IF(IVGTYP(I,J).EQ.0)PRINT*,'IVGTYP ZERO AT ',I,J
   1641 !     &        ,SM(I,J)
   1642               IVG=IVGTYP(I,J)
   1643 !              IF(IVGTYP(I,J).EQ.0)IVG=7
   1644 !              CALL CANRES(SOLAR,SFCTMP,SFCQ,SFCPRS
   1645 !     &        ,SMC(I,J,1:NSOIL),GC(I,J),RC,IVG,ISLTYP(I,J))
   1646 !
   1647               CALL CANRES(SOLAR,SFCTMP,SFCQ,SFCPRS
   1648      &        ,SH2O(I,J,1:NSOIL),GC(I,J),RC,IVG,ISLTYP(I,J)
   1649      &        ,RSMIN(I,J),NROOTS(I,J),SMCWLT(I,J),SMCREF(I,J)
   1650      &        ,RCS(I,J),RCQ(I,J),RCT(I,J),RCSOIL(I,J))
   1651                IF(abs(SMCWLT(I,J)-0.5).lt.1.e-5)print*,
   1652      &       'LARGE SMCWLT',i,j,SM(I,J),ISLTYP(I,J),SMCWLT(I,J)
   1653              ELSE
   1654               GC(I,J)=0.
   1655               RSMIN(I,J)=0.
   1656               NROOTS(I,J)=0
   1657               SMCWLT(I,J)=0.
   1658               SMCREF(I,J)=0.
   1659               RCS(I,J)=0.
   1660               RCQ(I,J)=0.
   1661               RCT(I,J)=0.
   1662               RCSOIL(I,J)=0.
   1663              END IF
   1664            ENDDO
   1665          ENDDO
   1666          IF (IGET(220).GT.0 )THEN
   1667           CALL E2OUT(220,000,GC,EGRID2,GRID1,GRID2,IMOUT,JMOUT)
   1668           ID(1:25) = 0
   1669           ID(02)= 130
   1670           CALL OUTPUT(IOUTYP,IGET(220),LVLS(1,IGET(220)),
   1671      X        GRID1,IMOUT,JMOUT)
   1672          END IF
   1673 !
   1674          IF (IGET(234).GT.0 )THEN
   1675           CALL E2OUT(234,000,RSMIN,EGRID2,GRID1,GRID2,IMOUT,JMOUT)
   1676           ID(1:25) = 0
   1677           ID(02)= 130
   1678           CALL OUTPUT(IOUTYP,IGET(234),LVLS(1,IGET(234)),
   1679      X        GRID1,IMOUT,JMOUT)
   1680          END IF
   1681 !
   1682 !    NO OF ROOT LAYERS
   1683       IF (IGET(235).GT.0) THEN
   1684          DO J=JSTA,JEND
   1685            DO I=1,IM
   1686              EGRID1(I,J) = FLOAT(NROOTS(I,J))
   1687            ENDDO
   1688          ENDDO
   1689          CALL E2OUT(235,000,EGRID1,EGRID2,GRID1,GRID2,IMOUT,JMOUT)
   1690          ID(1:25) = 0
   1691          ID(02)= 130

Page 26          Source Listing                  SURFCE2
2022-02-15 16:39                                 SURFCE2.f

   1692          CALL OUTPUT(IOUTYP,IGET(235),LVLS(1,IGET(235)),
   1693      X        GRID1,IMOUT,JMOUT)
   1694       ENDIF
   1695 !
   1696          IF (IGET(236).GT.0 )THEN
   1697           CALL E2OUT(236,000,SMCWLT,EGRID2,GRID1,GRID2,IMOUT,JMOUT)
   1698           ID(1:25) = 0
   1699           ID(02)= 130
   1700           CALL OUTPUT(IOUTYP,IGET(236),LVLS(1,IGET(236)),
   1701      X        GRID1,IMOUT,JMOUT)
   1702          END IF
   1703 !
   1704          IF (IGET(237).GT.0 )THEN
   1705           CALL E2OUT(237,000,SMCREF,EGRID2,GRID1,GRID2,IMOUT,JMOUT)
   1706           ID(1:25) = 0
   1707           ID(02)= 130
   1708           CALL OUTPUT(IOUTYP,IGET(237),LVLS(1,IGET(237)),
   1709      X        GRID1,IMOUT,JMOUT)
   1710          END IF
   1711 !
   1712          IF (IGET(238).GT.0 )THEN
   1713           CALL E2OUT(238,000,RCS,EGRID2,GRID1,GRID2,IMOUT,JMOUT)
   1714           ID(1:25) = 0
   1715           ID(02)= 130
   1716           CALL OUTPUT(IOUTYP,IGET(238),LVLS(1,IGET(238)),
   1717      X        GRID1,IMOUT,JMOUT)
   1718          END IF
   1719 !
   1720          IF (IGET(239).GT.0 )THEN
   1721           CALL E2OUT(239,000,RCT,EGRID2,GRID1,GRID2,IMOUT,JMOUT)
   1722           ID(1:25) = 0
   1723           ID(02)= 130
   1724           CALL OUTPUT(IOUTYP,IGET(239),LVLS(1,IGET(239)),
   1725      X        GRID1,IMOUT,JMOUT)
   1726          END IF
   1727 !
   1728          IF (IGET(240).GT.0 )THEN
   1729           CALL E2OUT(240,000,RCQ,EGRID2,GRID1,GRID2,IMOUT,JMOUT)
   1730           ID(1:25) = 0
   1731           ID(02)= 130
   1732           CALL OUTPUT(IOUTYP,IGET(240),LVLS(1,IGET(240)),
   1733      X        GRID1,IMOUT,JMOUT)
   1734          END IF
   1735 !
   1736          IF (IGET(241).GT.0 )THEN
   1737           CALL E2OUT(241,000,RCSOIL,EGRID2,GRID1,GRID2,IMOUT,JMOUT)
   1738           ID(1:25) = 0
   1739           ID(02)= 130
   1740           CALL OUTPUT(IOUTYP,IGET(241),LVLS(1,IGET(241)),
   1741      X        GRID1,IMOUT,JMOUT)
   1742          END IF
   1743 !
   1744       ENDIF
   1745 C     
   1746 C     DQADV
   1747       IF (IGET(200).GT.0) THEN
   1748          CALL E2OUT(200,000,DQADV,EGRID2,GRID1,GRID2,IMOUT,JMOUT)

Page 27          Source Listing                  SURFCE2
2022-02-15 16:39                                 SURFCE2.f

   1749          ID(1:25) = 0
   1750          CALL OUTPUT(IOUTYP,IGET(200),LVLS(1,IGET(200)),
   1751      X        GRID1,IMOUT,JMOUT)
   1752       ENDIF
   1753 C
   1754 C     DQFLX / WVCONV
   1755       IF (IGET(201).GT.0) THEN
   1756          CALL E2OUT(201,000,DQFLX,EGRID2,GRID1,GRID2,IMOUT,JMOUT)
   1757          ID(1:25) = 0
   1758          IFHR       = NTSD/TSPH + 0.5
   1759          ITPREC     = INT(TPREC)
   1760          IFINCR     = MOD(IFHR,ITPREC)
   1761          ID(19)     = IFHR
   1762          ID(20)     = 4
   1763          IF (IFINCR.EQ.0) THEN
   1764             ID(18) = IFHR-ITPREC
   1765          ELSE
   1766             ID(18) = IFHR-IFINCR
   1767          ENDIF
   1768          IF (ID(18).LT.0) ID(18) = 0
   1769          CALL OUTPUT(IOUTYP,IGET(201),LVLS(1,IGET(201)),
   1770      X        GRID1,IMOUT,JMOUT)
   1771 
   1772          DO J=JSTA,JEND
   1773          DO I=1,IM
   1774            EGRID1(I,J)=DQFLX(I,J)-DQFLX7(I,J)
   1775          ENDDO
   1776          ENDDO
   1777 
   1778          CALL E2OUT(201,000,EGRID1,EGRID2,GRID1,GRID2,IMOUT,JMOUT)
   1779          ID(1:25) = 0
   1780          IFHR       = NTSD/TSPH + 0.5
   1781          ITPREC     = INT(TPREC)
   1782          IFINCR     = MOD(IFHR,ITPREC)
   1783          ID(19)     = IFHR
   1784          ID(20)     = 4
   1785          IF (IFINCR.EQ.0) THEN
   1786             ID(18) = IFHR-ITPREC
   1787          ELSE
   1788             ID(18) = IFHR-IFINCR
   1789          ENDIF
   1790          IF (ID(18).LT.0) ID(18) = 0
   1791          ID(9) = 101
   1792          ID(10) = 0
   1793          ID(11) = 70
   1794          CALL OUTPUT(IOUTYP,IGET(201),LVLS(1,IGET(201)),
   1795      X        GRID1,IMOUT,JMOUT)
   1796       ENDIF
   1797 C
   1798 C     DCFLX / WCCONV
   1799       IF (IGET(202).GT.0) THEN
   1800          CALL E2OUT(202,000,DCFLX,EGRID2,GRID1,GRID2,IMOUT,JMOUT)
   1801          ID(1:25) = 0
   1802          IFHR       = NTSD/TSPH + 0.5
   1803          ITPREC     = INT(TPREC)
   1804          IFINCR     = MOD(IFHR,ITPREC)
   1805          ID(19)     = IFHR

Page 28          Source Listing                  SURFCE2
2022-02-15 16:39                                 SURFCE2.f

   1806          ID(20)     = 4
   1807          IF (IFINCR.EQ.0) THEN
   1808             ID(18) = IFHR-ITPREC
   1809          ELSE
   1810             ID(18) = IFHR-IFINCR
   1811          ENDIF
   1812          IF (ID(18).LT.0) ID(18) = 0
   1813          CALL OUTPUT(IOUTYP,IGET(202),LVLS(1,IGET(202)),
   1814      X        GRID1,IMOUT,JMOUT)
   1815 
   1816          DO J=JSTA,JEND
   1817          DO I=1,IM
   1818            EGRID1(I,J)=DCFLX(I,J)-DCFLX7(I,J)
   1819          ENDDO
   1820          ENDDO
   1821 
   1822          CALL E2OUT(202,000,EGRID1,EGRID2,GRID1,GRID2,IMOUT,JMOUT)
   1823          ID(1:25) = 0
   1824          IFHR       = NTSD/TSPH + 0.5
   1825          ITPREC     = INT(TPREC)
   1826          IFINCR     = MOD(IFHR,ITPREC)
   1827          ID(19)     = IFHR
   1828          ID(20)     = 4
   1829          IF (IFINCR.EQ.0) THEN
   1830             ID(18) = IFHR-ITPREC
   1831          ELSE
   1832             ID(18) = IFHR-IFINCR
   1833          ENDIF
   1834          IF (ID(18).LT.0) ID(18) = 0
   1835          ID(9) = 101
   1836          ID(10) = 0
   1837          ID(11) = 70
   1838          CALL OUTPUT(IOUTYP,IGET(202),LVLS(1,IGET(202)),
   1839      X        GRID1,IMOUT,JMOUT)
   1840 
   1841       ENDIF
   1842 C
   1843 C     FQU / WVUFLX
   1844       IF (IGET(203).GT.0) THEN
   1845          CALL E2OUT(203,000,FQU,EGRID2,GRID1,GRID2,IMOUT,JMOUT)
   1846          ID(1:25) = 0
   1847          IFHR       = NTSD/TSPH + 0.5
   1848          ITPREC     = INT(TPREC)
   1849          IFINCR     = MOD(IFHR,ITPREC)
   1850          ID(19)     = IFHR
   1851          ID(20)     = 4
   1852          IF (IFINCR.EQ.0) THEN
   1853             ID(18) = IFHR-ITPREC
   1854          ELSE
   1855             ID(18) = IFHR-IFINCR
   1856          ENDIF
   1857          IF (ID(18).LT.0) ID(18) = 0
   1858          CALL OUTPUT(IOUTYP,IGET(203),LVLS(1,IGET(203)),
   1859      X        GRID1,IMOUT,JMOUT)
   1860 
   1861          DO J=JSTA,JEND
   1862          DO I=1,IM

Page 29          Source Listing                  SURFCE2
2022-02-15 16:39                                 SURFCE2.f

   1863            EGRID1(I,J)=FQU(I,J)-FQU7(I,J)
   1864          ENDDO
   1865          ENDDO
   1866 
   1867          CALL E2OUT(203,000,EGRID1,EGRID2,GRID1,GRID2,IMOUT,JMOUT)
   1868          ID(1:25) = 0
   1869          IFHR       = NTSD/TSPH + 0.5
   1870          ITPREC     = INT(TPREC)
   1871          IFINCR     = MOD(IFHR,ITPREC)
   1872          ID(19)     = IFHR
   1873          ID(20)     = 4
   1874          IF (IFINCR.EQ.0) THEN
   1875             ID(18) = IFHR-ITPREC
   1876          ELSE
   1877             ID(18) = IFHR-IFINCR
   1878          ENDIF
   1879          IF (ID(18).LT.0) ID(18) = 0
   1880          ID(9) = 101
   1881          ID(10) = 0
   1882          ID(11) = 70
   1883          CALL OUTPUT(IOUTYP,IGET(203),LVLS(1,IGET(203)),
   1884      X        GRID1,IMOUT,JMOUT)
   1885 
   1886       ENDIF
   1887 C
   1888 C     FQV / WVVFLX
   1889       IF (IGET(204).GT.0) THEN
   1890          CALL E2OUT(204,000,FQV,EGRID2,GRID1,GRID2,IMOUT,JMOUT)
   1891          ID(1:25) = 0
   1892          IFHR       = NTSD/TSPH + 0.5
   1893          ITPREC     = INT(TPREC)
   1894          IFINCR     = MOD(IFHR,ITPREC)
   1895          ID(19)     = IFHR
   1896          ID(20)     = 4
   1897          IF (IFINCR.EQ.0) THEN
   1898             ID(18) = IFHR-ITPREC
   1899          ELSE
   1900             ID(18) = IFHR-IFINCR
   1901          ENDIF
   1902          IF (ID(18).LT.0) ID(18) = 0
   1903          CALL OUTPUT(IOUTYP,IGET(204),LVLS(1,IGET(204)),
   1904      X        GRID1,IMOUT,JMOUT)
   1905 
   1906          DO J=JSTA,JEND
   1907          DO I=1,IM
   1908            EGRID1(I,J)=FQV(I,J)-FQV7(I,J)
   1909          ENDDO
   1910          ENDDO
   1911 
   1912          CALL E2OUT(204,000,EGRID1,EGRID2,GRID1,GRID2,IMOUT,JMOUT)
   1913          ID(1:25) = 0
   1914          IFHR       = NTSD/TSPH + 0.5
   1915          ITPREC     = INT(TPREC)
   1916          IFINCR     = MOD(IFHR,ITPREC)
   1917          ID(19)     = IFHR
   1918          ID(20)     = 4
   1919          IF (IFINCR.EQ.0) THEN

Page 30          Source Listing                  SURFCE2
2022-02-15 16:39                                 SURFCE2.f

   1920             ID(18) = IFHR-ITPREC
   1921          ELSE
   1922             ID(18) = IFHR-IFINCR
   1923          ENDIF
   1924          IF (ID(18).LT.0) ID(18) = 0
   1925          ID(9) = 101
   1926          ID(10) = 0
   1927          ID(11) = 70
   1928          CALL OUTPUT(IOUTYP,IGET(204),LVLS(1,IGET(204)),
   1929      X        GRID1,IMOUT,JMOUT)
   1930 
   1931       ENDIF
   1932 C
   1933 C     FCU / WCUFLX
   1934       IF (IGET(205).GT.0) THEN
   1935          CALL E2OUT(205,000,FCU,EGRID2,GRID1,GRID2,IMOUT,JMOUT)
   1936          ID(1:25) = 0
   1937          IFHR       = NTSD/TSPH + 0.5
   1938          ITPREC     = INT(TPREC)
   1939          IFINCR     = MOD(IFHR,ITPREC)
   1940          ID(19)     = IFHR
   1941          ID(20)     = 4
   1942          IF (IFINCR.EQ.0) THEN
   1943             ID(18) = IFHR-ITPREC
   1944          ELSE
   1945             ID(18) = IFHR-IFINCR
   1946          ENDIF
   1947          IF (ID(18).LT.0) ID(18) = 0
   1948          CALL OUTPUT(IOUTYP,IGET(205),LVLS(1,IGET(205)),
   1949      X        GRID1,IMOUT,JMOUT)
   1950 
   1951          DO J=JSTA,JEND
   1952          DO I=1,IM
   1953            EGRID1(I,J)=FCU(I,J)-FCU7(I,J)
   1954          ENDDO
   1955          ENDDO
   1956 
   1957          CALL E2OUT(205,000,EGRID1,EGRID2,GRID1,GRID2,IMOUT,JMOUT)
   1958          ID(1:25) = 0
   1959          IFHR       = NTSD/TSPH + 0.5
   1960          ITPREC     = INT(TPREC)
   1961          IFINCR     = MOD(IFHR,ITPREC)
   1962          ID(19)     = IFHR
   1963          ID(20)     = 4
   1964          IF (IFINCR.EQ.0) THEN
   1965             ID(18) = IFHR-ITPREC
   1966          ELSE
   1967             ID(18) = IFHR-IFINCR
   1968          ENDIF
   1969          IF (ID(18).LT.0) ID(18) = 0
   1970          ID(9) = 101
   1971          ID(10) = 0
   1972          ID(11) = 70
   1973          CALL OUTPUT(IOUTYP,IGET(205),LVLS(1,IGET(205)),
   1974      X        GRID1,IMOUT,JMOUT)
   1975 
   1976       ENDIF

Page 31          Source Listing                  SURFCE2
2022-02-15 16:39                                 SURFCE2.f

   1977 C
   1978 C     FCV / WCVFLX
   1979       IF (IGET(206).GT.0) THEN
   1980          CALL E2OUT(206,000,FCV,EGRID2,GRID1,GRID2,IMOUT,JMOUT)
   1981          ID(1:25) = 0
   1982          IFHR       = NTSD/TSPH + 0.5
   1983          ITPREC     = INT(TPREC)
   1984          IFINCR     = MOD(IFHR,ITPREC)
   1985          ID(19)     = IFHR
   1986          ID(20)     = 4
   1987          IF (IFINCR.EQ.0) THEN
   1988             ID(18) = IFHR-ITPREC
   1989          ELSE
   1990             ID(18) = IFHR-IFINCR
   1991          ENDIF
   1992          IF (ID(18).LT.0) ID(18) = 0
   1993          CALL OUTPUT(IOUTYP,IGET(206),LVLS(1,IGET(206)),
   1994      X        GRID1,IMOUT,JMOUT)
   1995 
   1996          DO J=JSTA,JEND
   1997          DO I=1,IM
   1998            EGRID1(I,J)=FCV(I,J)-FCV7(I,J)
   1999          ENDDO
   2000          ENDDO
   2001 
   2002          CALL E2OUT(206,000,EGRID1,EGRID2,GRID1,GRID2,IMOUT,JMOUT)
   2003          ID(1:25) = 0
   2004          IFHR       = NTSD/TSPH + 0.5
   2005          ITPREC     = INT(TPREC)
   2006          IFINCR     = MOD(IFHR,ITPREC)
   2007          ID(19)     = IFHR
   2008          ID(20)     = 4
   2009          IF (IFINCR.EQ.0) THEN
   2010             ID(18) = IFHR-ITPREC
   2011          ELSE
   2012             ID(18) = IFHR-IFINCR
   2013          ENDIF
   2014          IF (ID(18).LT.0) ID(18) = 0
   2015          ID(9) = 101
   2016          ID(10) = 0
   2017          ID(11) = 70
   2018          CALL OUTPUT(IOUTYP,IGET(206),LVLS(1,IGET(206)),
   2019      X        GRID1,IMOUT,JMOUT)
   2020 
   2021       ENDIF
   2022 
   2023 
   2024 C
   2025 C     VAPINC / WVINC
   2026       IF (IGET(207).GT.0) THEN
   2027          CALL E2OUT(207,000,VAPINC,EGRID2,GRID1,GRID2,IMOUT,JMOUT)
   2028          ID(1:25) = 0
   2029          IFHR       = NTSD/TSPH + 0.5
   2030          ITPREC     = INT(TPREC)
   2031          IFINCR     = MOD(IFHR,ITPREC)
   2032          ID(19)     = IFHR
   2033          ID(20)     = 4

Page 32          Source Listing                  SURFCE2
2022-02-15 16:39                                 SURFCE2.f

   2034          IF (IFINCR.EQ.0) THEN
   2035             ID(18) = IFHR-ITPREC
   2036          ELSE
   2037             ID(18) = IFHR-IFINCR
   2038          ENDIF
   2039          IF (ID(18).LT.0) ID(18) = 0
   2040          CALL OUTPUT(IOUTYP,IGET(207),LVLS(1,IGET(207)),
   2041      X        GRID1,IMOUT,JMOUT)
   2042 
   2043          DO J=JSTA,JEND
   2044          DO I=1,IM
   2045            EGRID1(I,J)=VAPINC(I,J)-VAPINC7(I,J)
   2046          ENDDO
   2047          ENDDO
   2048 
   2049          CALL E2OUT(207,000,EGRID1,EGRID2,GRID1,GRID2,IMOUT,JMOUT)
   2050          ID(1:25) = 0
   2051          IFHR       = NTSD/TSPH + 0.5
   2052          ITPREC     = INT(TPREC)
   2053          IFINCR     = MOD(IFHR,ITPREC)
   2054          ID(19)     = IFHR
   2055          ID(20)     = 4
   2056          IF (IFINCR.EQ.0) THEN
   2057             ID(18) = IFHR-ITPREC
   2058          ELSE
   2059             ID(18) = IFHR-IFINCR
   2060          ENDIF
   2061          IF (ID(18).LT.0) ID(18) = 0
   2062          ID(9) = 101
   2063          ID(10) = 0
   2064          ID(11) = 70
   2065          CALL OUTPUT(IOUTYP,IGET(207),LVLS(1,IGET(207)),
   2066      X        GRID1,IMOUT,JMOUT)
   2067 
   2068       ENDIF
   2069 C
   2070 C     CLDINC / WCINC
   2071       IF (IGET(208).GT.0) THEN
   2072          CALL E2OUT(208,000,CLDINC,EGRID2,GRID1,GRID2,IMOUT,JMOUT)
   2073          ID(1:25) = 0
   2074          IFHR       = NTSD/TSPH + 0.5
   2075          ITPREC     = INT(TPREC)
   2076          IFINCR     = MOD(IFHR,ITPREC)
   2077          ID(19)     = IFHR
   2078          ID(20)     = 4
   2079          IF (IFINCR.EQ.0) THEN
   2080             ID(18) = IFHR-ITPREC
   2081          ELSE
   2082             ID(18) = IFHR-IFINCR
   2083          ENDIF
   2084          IF (ID(18).LT.0) ID(18) = 0
   2085          CALL OUTPUT(IOUTYP,IGET(208),LVLS(1,IGET(208)),
   2086      X        GRID1,IMOUT,JMOUT)
   2087 
   2088          DO J=JSTA,JEND
   2089          DO I=1,IM
   2090            EGRID1(I,J)=CLDINC(I,J)-CLDINC7(I,J)

Page 33          Source Listing                  SURFCE2
2022-02-15 16:39                                 SURFCE2.f

   2091          ENDDO
   2092          ENDDO
   2093 
   2094          CALL E2OUT(208,000,EGRID1,EGRID2,GRID1,GRID2,IMOUT,JMOUT)
   2095          ID(1:25) = 0
   2096          IFHR       = NTSD/TSPH + 0.5
   2097          ITPREC     = INT(TPREC)
   2098          IFINCR     = MOD(IFHR,ITPREC)
   2099          ID(19)     = IFHR
   2100          ID(20)     = 4
   2101          IF (IFINCR.EQ.0) THEN
   2102             ID(18) = IFHR-ITPREC
   2103          ELSE
   2104             ID(18) = IFHR-IFINCR
   2105          ENDIF
   2106          IF (ID(18).LT.0) ID(18) = 0
   2107          ID(9) = 101
   2108          ID(10) = 0
   2109          ID(11) = 70
   2110          CALL OUTPUT(IOUTYP,IGET(208),LVLS(1,IGET(208)),
   2111      X        GRID1,IMOUT,JMOUT)
   2112 
   2113       ENDIF
   2114 
   2115 
   2116 
   2117 C     END OF ROUTINE
   2118       print*,'End of SURFCE2'
   2119 C     
   2120       RETURN
   2121       END

Page 34          Source Listing                  SURFCE2
2022-02-15 16:39 Entry Points                    SURFCE2.f



ENTRY POINTS

  Name                
                      
 surfce2_             


SYMBOL CROSS REFERENCE

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 40                         Label  519                                                            448,449                           
 A2                         Param  143      R(4)            4           scalar                    485                               
 A3                         Param  143      R(4)            4           scalar                    485                               
 A4                         Param  143      R(4)            4           scalar                    485                               
 ABS                        Func   761                                  scalar                    761,762,1629,1630,1651            
 ACMPRE                     Common 339                                  1467508  SAVE                                               
 ACMRDS                     Common 353                                  2201268  SAVE                                               
 ACMSFC                     Common 332                                  2568144  SAVE                                               
 AD05                       Param  135      R(4)            4           scalar                                                      
 AI                         Local  478      R(4)            4           scalar                    478,481,486                       
 AMAX1                      Func   473                                  scalar                    473                               
 AMIN1                      Func   477                                  scalar                    477,486                           
 ANCPRC                     Local  168      R(4)            4     2     91719                     515,1138                          
 BETA                       Param  139      R(4)            4           scalar                    139                               
 BI                         Local  479      R(4)            4           scalar                    479,482,486                       
 BOUND                      Subr   542                                                            542,551,576,595,733,850,882       
 BTG                        Param  139      R(4)            4           scalar                                                      
 C2K                        Param  159      R(4)            4           scalar                                                      
 CALDRG                     Subr   1509                                                           1509                              
 CALRH2                     Subr   879                                                            879                               
 CALTAU                     Subr   1518                                                           1518                              
 CALWXT                     Subr   1242                                                           1242                              
 CANRES                     Subr   1647                                                           1647                              
 CAPA                       Param  130      R(4)            4           scalar                    137,455,456,466                   
 CFT0                       Param  135      R(4)            4           scalar                                                      
 CLDWTR                     Common 262                                  17610408 SAVE                                               
 CLIMIT                     Local  411      R(4)            4           scalar                    411,419                           
 CM1                        Param  125      R(4)            4           scalar                                                      
 CM2                        Param  125      R(4)            4           scalar                                                      
 CM3                        Param  125      R(4)            4           scalar                                                      
 CNVCLD                     Common 303                                  1467504  SAVE                                               
 CP                         Param  136      R(4)            4           scalar                    138,142                           
 CPDR                       Param  138      R(4)            4           scalar                                                      
 CTLBLK                     Common 182                                  96       SAVE                                               
 D00                        Param  127      R(4)            4           scalar                    507,542,551,733                   
 D001                       Param  127      R(4)            4           scalar                    510,864                           
 D0065                      Param  131      R(4)            4           scalar                                                      
 D01                        Param  127      R(4)            4           scalar                    507                               
 D05                        Param  131      R(4)            4           scalar                    135                               
 D1                         Param  127      R(4)            4           scalar                                                      
 D115                       Param  131      R(4)            4           scalar                                                      
 D125                       Param  129      R(4)            4           scalar                                                      
 D25                        Param  129      R(4)            4           scalar                                                      
 D50                        Param  127      R(4)            4           scalar                                                      

Page 35          Source Listing                  SURFCE2
2022-02-15 16:39 Symbol Table                    SURFCE2.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 D608                       Param  131      R(4)            4           scalar                                                      
 DBOT                       Local  621      R(4)            4           scalar                    621,623,642,644,662,664           
 DEWPOINT                   Subr   584                                                            584,867                           
 DP10M                      Param  137      R(4)            4           scalar                                                      
 DTOP                       Local  617      R(4)            4           scalar                    617,619,621,622,638,640,642,643,65
                                                                                                  8,660,662,663                     
 DTR                        Param  136      R(4)            4           scalar                    136                               
 DWPSFC                     Local  167      R(4)            4     2     91719                     584,585                           
 E2OUT                      Subr   525                                                            525,533,541,550,559,567,575,585,59
                                                                                                  3,615,636,656,674,684,695,706,715,
                                                                                                  732,740,778,785,792,799,807,815,83
                                                                                                  8,849,868,880,893,916,931,943,955,
                                                                                                  967,984,999,1011,1023,1035,1053,10
                                                                                                  69,1078,1098,1118,1138,1158,1179,1
                                                                                                  200,1221,1265,1270,1275,1280,1301,
                                                                                                  1331,1361,1391,1421,1446,1472,1493
                                                                                                  ,1501,1510,1522,1531,1541,1549,155
                                                                                                  7,1565,1574,1587,1600,1613,1667,16
                                                                                                  75,1689,1697,1705,1713,1721,1729,1
                                                                                                  737,1748,1756,1778,1800,1822,1845,
                                                                                                  1867,1890,1912,1935,1957,1980,2002
                                                                                                  ,2027,2049,2072,2094              
 ECAN                       Local  173      R(4)            4     2     91719                     765,768,778                       
 EDIR                       Local  173      R(4)            4     2     91719                     765,769,785                       
 EGRID1                     Local  169      R(4)            4     2     91719                     612,615,633,636,653,656,849,867,86
                                                                                                  8,879,880,893,1050,1053,1064,1065,
                                                                                                  1069,1298,1301,1328,1331,1358,1361
                                                                                                  ,1388,1391,1418,1421,1443,1446,146
                                                                                                  9,1472,1509,1510,1518,1522,1531,15
                                                                                                  84,1587,1597,1600,1610,1613,1686,1
                                                                                                  689,1774,1778,1818,1822,1863,1867,
                                                                                                  1908,1912,1953,1957,1998,2002,2045
                                                                                                  ,2049,2090,2094                   
 EGRID2                     Local  169      R(4)            4     2     91719                     525,533,541,550,559,567,575,585,59
                                                                                                  3,615,636,656,674,684,695,706,715,
                                                                                                  732,740,778,785,792,799,807,815,83
                                                                                                  8,868,880,931,943,955,967,999,1011
                                                                                                  ,1023,1035,1053,1069,1078,1098,111
                                                                                                  8,1138,1158,1179,1200,1221,1265,12
                                                                                                  70,1275,1280,1301,1331,1361,1391,1
                                                                                                  421,1446,1472,1493,1501,1510,1518,
                                                                                                  1522,1531,1541,1549,1557,1565,1574
                                                                                                  ,1587,1600,1613,1667,1675,1689,169
                                                                                                  7,1705,1713,1721,1729,1737,1748,17
                                                                                                  56,1778,1800,1822,1845,1867,1890,1
                                                                                                  912,1935,1957,1980,2002,2027,2049,
                                                                                                  2072,2094                         
 ELDR                       Param  138      R(4)            4           scalar                                                      
 ELWV                       Param  138      R(4)            4           scalar                    138                               
 EPS                        Param  141      R(4)            4           scalar                    141,509,863                       
 EPSQ2                      Param  142      R(4)            4           scalar                                                      
 ERAD                       Param  136      R(4)            4           scalar                                                      
 ESNOW                      Local  173      R(4)            4     2     91719                     765,771,799                       
 ETCALC                     Subr   763                                                            763                               
 ETRANS                     Local  173      R(4)            4     2     91719                     765,770,792                       

Page 36          Source Listing                  SURFCE2
2022-02-15 16:39 Symbol Table                    SURFCE2.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 EVP                        Local  167      R(4)            4     2     91719                     509,510,584,863,864,867           
 EXP                        Func   453                                  scalar                    453,454,485                       
 EXTRA                      Common 211                                  71506268 SAVE                                               
 FACTRS                     Local  1632     R(4)            4           scalar                    1632,1634,1636                    
 FLOAT                      Func   1584                                 scalar                    1584,1597,1610,1686               
 FMD                        Param  141      R(4)            4           scalar                    141                               
 FMW                        Param  141      R(4)            4           scalar                    141                               
 FREEZR                     Local  172      R(4)            4     2     91719                     1256,1275                         
 G                          Param  134      R(4)            4           scalar                    134,453,454                       
 GC                         Local  170      R(4)            4     2     91719                     1648,1654,1667                    
 GI                         Param  134      R(4)            4           scalar                    138,459                           
 GRID1                      Local  171      R(4)            4     2     0                         525,528,533,536,541,542,545,550,55
                                                                                                  1,554,559,562,567,570,575,576,579,
                                                                                                  585,588,593,594,595,598,615,624,63
                                                                                                  6,645,656,666,674,679,684,688,690,
                                                                                                  695,699,701,706,708,710,715,717,71
                                                                                                  9,732,733,736,740,743,778,781,785,
                                                                                                  788,792,795,799,803,807,811,815,81
                                                                                                  9,838,844,849,850,856,868,874,880,
                                                                                                  881,882,888,893,899,916,918,931,93
                                                                                                  3,943,945,955,957,967,969,984,986,
                                                                                                  999,1001,1011,1013,1023,1025,1035,
                                                                                                  1037,1053,1056,1069,1071,1073,1078
                                                                                                  ,1091,1093,1098,1111,1113,1118,113
                                                                                                  1,1133,1138,1151,1153,1159,1172,11
                                                                                                  74,1180,1193,1195,1201,1214,1216,1
                                                                                                  222,1235,1237,1265,1267,1270,1272,
                                                                                                  1275,1277,1280,1282,1302,1316,1332
                                                                                                  ,1346,1362,1376,1392,1406,1422,143
                                                                                                  6,1447,1460,1462,1473,1486,1488,14
                                                                                                  93,1496,1501,1504,1510,1513,1523,1
                                                                                                  526,1532,1535,1541,1544,1549,1552,
                                                                                                  1557,1560,1565,1567,1569,1574,1577
                                                                                                  ,1587,1590,1600,1603,1613,1617,166
                                                                                                  7,1671,1675,1679,1689,1693,1697,17
                                                                                                  01,1705,1709,1713,1717,1721,1725,1
                                                                                                  729,1733,1737,1741,1748,1751,1756,
                                                                                                  1770,1778,1795,1800,1814,1822,1839
                                                                                                  ,1845,1859,1867,1884,1890,1904,191
                                                                                                  2,1929,1935,1949,1957,1974,1980,19
                                                                                                  94,2002,2019,2027,2041,2049,2066,2
                                                                                                  072,2086,2094,2111                
 GRID2                      Local  171      R(4)            4     2     0                         525,533,541,550,559,567,575,585,59
                                                                                                  3,615,636,656,674,684,695,706,715,
                                                                                                  732,740,778,785,792,799,807,815,83
                                                                                                  8,849,868,880,893,916,920,931,943,
                                                                                                  955,967,984,988,999,1011,1023,1035
                                                                                                  ,1053,1069,1078,1098,1118,1138,115
                                                                                                  9,1180,1201,1222,1265,1270,1275,12
                                                                                                  80,1302,1332,1362,1392,1422,1447,1
                                                                                                  473,1493,1501,1510,1523,1532,1541,
                                                                                                  1549,1557,1565,1574,1587,1600,1613
                                                                                                  ,1667,1675,1689,1697,1705,1713,172
                                                                                                  1,1729,1737,1748,1756,1778,1800,18
                                                                                                  22,1845,1867,1890,1912,1935,1957,1

Page 37          Source Listing                  SURFCE2
2022-02-15 16:39 Symbol Table                    SURFCE2.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
                                                                                                  980,2002,2027,2049,2072,2094      
 H1                         Param  128      R(4)            4           scalar                    135,506,595,733,882               
 H100                       Param  129      R(4)            4           scalar                    594,595,881,882                   
 H1000                      Param  129      R(4)            4           scalar                                                      
 H10000                     Param  130      R(4)            4           scalar                                                      
 H10E5                      Param  130      R(4)            4           scalar                                                      
 H1E2                       Param  132      R(4)            4           scalar                                                      
 H1E4                       Param  132      R(4)            4           scalar                                                      
 H1M12                      Param  128      R(4)            4           scalar                    473,576,850                       
 H1M2                       Param  132      R(4)            4           scalar                                                      
 H1M5                       Param  129      R(4)            4           scalar                                                      
 H2                         Param  128      R(4)            4           scalar                                                      
 H4                         Param  128      R(4)            4           scalar                                                      
 H999                       Param  127      R(4)            4           scalar                                                      
 H99999                     Param  128      R(4)            4           scalar                    542,551,576,850                   
 I                          Local  416      I(4)            4           scalar                    416,417,418,419,420,421,422,423,42
                                                                                                  5,428,449,452,453,454,455,456,459,
                                                                                                  462,465,466,472,473,474,484,493,50
                                                                                                  4,506,507,508,509,510,515,611,612,
                                                                                                  632,633,652,653,725,726,727,729,75
                                                                                                  7,761,762,763,764,765,766,768,769,
                                                                                                  770,771,772,773,862,863,864,1049,1
                                                                                                  050,1063,1064,1065,1248,1249,1254,
                                                                                                  1255,1256,1257,1297,1298,1327,1328
                                                                                                  ,1357,1358,1387,1388,1417,1418,144
                                                                                                  2,1443,1468,1469,1583,1584,1596,15
                                                                                                  97,1609,1610,1627,1629,1630,1631,1
                                                                                                  632,1636,1637,1638,1639,1642,1648,
                                                                                                  1649,1650,1651,1652,1654,1655,1656
                                                                                                  ,1657,1658,1659,1660,1661,1662,168
                                                                                                  5,1686,1773,1774,1817,1818,1862,18
                                                                                                  63,1907,1908,1952,1953,1997,1998,2
                                                                                                  044,2045,2089,2090                
 IDIM1                      Param  94       I(4)            4           scalar                                                      
 IDIM2                      Param  94       I(4)            4           scalar                                                      
 IFHR                       Local  1080     I(4)            4           scalar                    1080,1082,1083,1086,1088,1100,1102
                                                                                                  ,1103,1106,1108,1120,1122,1123,112
                                                                                                  6,1128,1140,1142,1143,1146,1148,11
                                                                                                  61,1163,1164,1167,1169,1182,1184,1
                                                                                                  185,1188,1190,1203,1205,1206,1209,
                                                                                                  1211,1224,1226,1227,1230,1232,1304
                                                                                                  ,1306,1307,1310,1312,1334,1336,133
                                                                                                  7,1340,1342,1364,1366,1367,1370,13
                                                                                                  72,1394,1396,1397,1400,1402,1424,1
                                                                                                  426,1427,1430,1432,1449,1451,1452,
                                                                                                  1455,1457,1475,1477,1478,1481,1483
                                                                                                  ,1758,1760,1761,1764,1766,1780,178
                                                                                                  2,1783,1786,1788,1802,1804,1805,18
                                                                                                  08,1810,1824,1826,1827,1830,1832,1
                                                                                                  847,1849,1850,1853,1855,1869,1871,
                                                                                                  1872,1875,1877,1892,1894,1895,1898
                                                                                                  ,1900,1914,1916,1917,1920,1922,193
                                                                                                  7,1939,1940,1943,1945,1959,1961,19
                                                                                                  62,1965,1967,1982,1984,1985,1988,1
                                                                                                  990,2004,2006,2007,2010,2012,2029,

Page 38          Source Listing                  SURFCE2
2022-02-15 16:39 Symbol Table                    SURFCE2.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
                                                                                                  2031,2032,2035,2037,2051,2053,2054
                                                                                                  ,2057,2059,2074,2076,2077,2080,208
                                                                                                  2,2096,2098,2099,2102,2104        
 IFINCR                     Local  1082     I(4)            4           scalar                    1082,1085,1088,1102,1105,1108,1122
                                                                                                  ,1125,1128,1142,1145,1148,1163,116
                                                                                                  6,1169,1184,1187,1190,1205,1208,12
                                                                                                  11,1226,1229,1232,1306,1309,1312,1
                                                                                                  336,1339,1342,1366,1369,1372,1396,
                                                                                                  1399,1402,1426,1429,1432,1451,1454
                                                                                                  ,1457,1477,1480,1483,1760,1763,176
                                                                                                  6,1782,1785,1788,1804,1807,1810,18
                                                                                                  26,1829,1832,1849,1852,1855,1871,1
                                                                                                  874,1877,1894,1897,1900,1916,1919,
                                                                                                  1922,1939,1942,1945,1961,1964,1967
                                                                                                  ,1984,1987,1990,2006,2009,2012,203
                                                                                                  1,2034,2037,2053,2056,2059,2076,20
                                                                                                  79,2082,2098,2101,2104            
 IGSTL                      Param  89       I(4)            4           scalar                    94                                
 IGSTR                      Param  89       I(4)            4           scalar                    94                                
 IIP                        Local  1251     I(4)            4           scalar                    1251,1255                         
 IM                         Param  83       I(4)            4           scalar                    91,94,101,106,108,109,111,165,166,
                                                                                                  167,168,169,170,171,172,173,174,17
                                                                                                  5,176,177,210,212,213,214,215,216,
                                                                                                  217,223,225,243,245,251,252,253,25
                                                                                                  4,255,257,263,271,285,286,287,288,
                                                                                                  289,290,298,299,300,304,312,313,31
                                                                                                  4,324,325,326,327,328,333,334,335,
                                                                                                  340,341,354,355,359,360,362,363,36
                                                                                                  6,367,368,369,371,372,373,374,376,
                                                                                                  377,389,390,392,393,416,449,584,61
                                                                                                  1,632,652,725,757,862,867,879,1049
                                                                                                  ,1063,1248,1297,1327,1357,1387,141
                                                                                                  7,1442,1468,1583,1596,1609,1627,16
                                                                                                  85,1773,1817,1862,1907,1952,1997,2
                                                                                                  044,2089                          
 IM1                        Param  108      I(4)            4           scalar                                                      
 IMJM                       Param  210      I(4)            4           scalar                    213                               
 IMOUT                      Dummy  1        I(4)            4           scalar   ARG,INOUT        171,525,528,533,536,541,542,545,55
                                                                                                  0,551,554,559,562,567,570,575,576,
                                                                                                  579,585,588,593,594,595,598,615,62
                                                                                                  4,636,645,656,666,674,679,684,688,
                                                                                                  690,695,699,701,706,708,710,715,71
                                                                                                  7,719,732,733,736,740,743,778,781,
                                                                                                  785,788,792,795,799,803,807,811,81
                                                                                                  5,819,838,844,849,850,856,868,874,
                                                                                                  880,881,882,888,893,899,916,918,92
                                                                                                  0,931,933,943,945,955,957,967,969,
                                                                                                  984,986,988,999,1001,1011,1013,102
                                                                                                  3,1025,1035,1037,1053,1056,1069,10
                                                                                                  71,1073,1078,1091,1093,1098,1111,1
                                                                                                  113,1118,1131,1133,1138,1151,1153,
                                                                                                  1159,1172,1174,1180,1193,1195,1201
                                                                                                  ,1214,1216,1222,1235,1237,1265,126
                                                                                                  7,1270,1272,1275,1277,1280,1282,13
                                                                                                  02,1316,1332,1346,1362,1376,1392,1

Page 39          Source Listing                  SURFCE2
2022-02-15 16:39 Symbol Table                    SURFCE2.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
                                                                                                  406,1422,1436,1447,1460,1462,1473,
                                                                                                  1486,1488,1493,1496,1501,1504,1510
                                                                                                  ,1513,1523,1526,1532,1535,1541,154
                                                                                                  4,1549,1552,1557,1560,1565,1567,15
                                                                                                  69,1574,1577,1587,1590,1600,1603,1
                                                                                                  613,1617,1667,1671,1675,1679,1689,
                                                                                                  1693,1697,1701,1705,1709,1713,1717
                                                                                                  ,1721,1725,1729,1733,1737,1741,174
                                                                                                  8,1751,1756,1770,1778,1795,1800,18
                                                                                                  14,1822,1839,1845,1859,1867,1884,1
                                                                                                  890,1904,1912,1929,1935,1949,1957,
                                                                                                  1974,1980,1994,2002,2019,2027,2041
                                                                                                  ,2049,2066,2072,2086,2094,2111    
 IMT                        Param  106      I(4)            4           scalar                    314,315                           
 IMX                        Param  101      I(4)            4           scalar                    310,311,316,317,318,319           
 INPES                      Param  86       I(4)            4           scalar                    91,94                             
 INT                        Func   1081                                 scalar                    1081,1101,1121,1141,1162,1183,1204
                                                                                                  ,1225,1305,1335,1365,1395,1425,145
                                                                                                  0,1476,1759,1781,1803,1825,1848,18
                                                                                                  70,1893,1915,1938,1960,1983,2005,2
                                                                                                  030,2052,2075,2097                
 IOUNIT                     Common 347                                  20       SAVE                                               
 IRAIN                      Local  1253     I(4)            4           scalar                    1253,1257                         
 ISNO                       Local  1250     I(4)            4           scalar                    1250,1254                         
 ISVALUE                    Local  676      I(4)            4           scalar                    676,677,840,841,842,852,853,854,87
                                                                                                  0,871,872,884,885,886,895,896,897,
                                                                                                  910,911,912,928,929,930,940,941,94
                                                                                                  2,952,953,954,964,965,966,978,979,
                                                                                                  980,996,997,998,1008,1009,1010,102
                                                                                                  0,1021,1022,1032,1033,1034        
 ITAIL                      Param  91       I(4)            4           scalar                                                      
 ITB                        Param  145      I(4)            4           scalar                    282,292                           
 ITBQ                       Param  145      I(4)            4           scalar                    283,292                           
 ITPREC                     Local  1081     I(4)            4           scalar                    1081,1082,1086,1101,1102,1106,1121
                                                                                                  ,1122,1126,1141,1142,1146,1162,116
                                                                                                  3,1167,1183,1184,1188,1204,1205,12
                                                                                                  09,1225,1226,1230,1450,1451,1455,1
                                                                                                  476,1477,1481,1759,1760,1764,1781,
                                                                                                  1782,1786,1803,1804,1808,1825,1826
                                                                                                  ,1830,1848,1849,1853,1870,1871,187
                                                                                                  5,1893,1894,1898,1915,1916,1920,19
                                                                                                  38,1939,1943,1960,1961,1965,1983,1
                                                                                                  984,1988,2005,2006,2010,2030,2031,
                                                                                                  2035,2052,2053,2057,2075,2076,2080
                                                                                                  ,2097,2098,2102                   
 ITSRFC                     Local  1305     I(4)            4           scalar                    1305,1306,1310,1335,1336,1340,1365
                                                                                                  ,1366,1370,1395,1396,1400,1425,142
                                                                                                  6,1430                            
 IVEG                       Local  727      I(4)            4           scalar                    727,728                           
 IVG                        Local  1642     I(4)            4           scalar                    1642,1648                         
 IW                         Local  171      R(4)            4     2     91719                     412,418,421,423,425,428,493,879   
 IWM1                       Local  171      R(4)            4           scalar                    418,425                           
 IWX                        Local  1249     I(4)            4           scalar                    1249,1250,1251,1252,1253          
 IWX1                       Local  165      I(4)            4     2     91719                     1242,1249                         
 IZR                        Local  1252     I(4)            4           scalar                    1252,1256                         

Page 40          Source Listing                  SURFCE2
2022-02-15 16:39 Symbol Table                    SURFCE2.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 J                          Local  415      I(4)            4           scalar                    415,417,418,419,420,421,422,423,42
                                                                                                  5,428,448,452,453,454,455,456,459,
                                                                                                  462,465,466,472,473,474,484,493,50
                                                                                                  4,506,507,508,509,510,515,610,612,
                                                                                                  631,633,651,653,724,726,727,729,75
                                                                                                  6,761,762,763,764,765,766,768,769,
                                                                                                  770,771,772,773,861,863,864,1048,1
                                                                                                  050,1062,1064,1065,1247,1249,1254,
                                                                                                  1255,1256,1257,1296,1298,1326,1328
                                                                                                  ,1356,1358,1386,1388,1416,1418,144
                                                                                                  1,1443,1467,1469,1582,1584,1595,15
                                                                                                  97,1608,1610,1626,1629,1630,1631,1
                                                                                                  632,1636,1637,1638,1639,1642,1648,
                                                                                                  1649,1650,1651,1652,1654,1655,1656
                                                                                                  ,1657,1658,1659,1660,1661,1662,168
                                                                                                  4,1686,1772,1774,1816,1818,1861,18
                                                                                                  63,1906,1908,1951,1953,1996,1998,2
                                                                                                  043,2045,2088,2090                
 JAM                        Param  108      I(4)            4           scalar                    269                               
 JDIM1                      Param  95       I(4)            4           scalar                                                      
 JDIM2                      Param  95       I(4)            4           scalar                                                      
 JGSTL                      Param  90       I(4)            4           scalar                    95                                
 JGSTR                      Param  90       I(4)            4           scalar                    95                                
 JM                         Param  83       I(4)            4           scalar                    92,95,101,106,108,111,165,166,167,
                                                                                                  168,169,170,171,172,173,174,175,17
                                                                                                  6,177,210,212,213,214,215,216,217,
                                                                                                  223,225,243,245,251,252,253,254,25
                                                                                                  5,257,263,271,285,286,287,288,289,
                                                                                                  290,298,299,300,304,312,313,314,32
                                                                                                  4,325,326,327,328,333,334,335,340,
                                                                                                  341,354,355,359,360,362,363,366,36
                                                                                                  7,368,369,371,372,373,374,376,377,
                                                                                                  389,390,392,393,584,867,879       
 JM2                        Param  108      I(4)            4           scalar                                                      
 JMOUT                      Dummy  1        I(4)            4           scalar   ARG,INOUT        171,525,528,533,536,541,542,545,55
                                                                                                  0,551,554,559,562,567,570,575,576,
                                                                                                  579,585,588,593,594,595,598,615,62
                                                                                                  4,636,645,656,666,674,679,684,688,
                                                                                                  690,695,699,701,706,708,710,715,71
                                                                                                  7,719,732,733,736,740,743,778,781,
                                                                                                  785,788,792,795,799,803,807,811,81
                                                                                                  5,819,838,844,849,850,856,868,874,
                                                                                                  880,881,882,888,893,899,916,918,92
                                                                                                  0,931,933,943,945,955,957,967,969,
                                                                                                  984,986,988,999,1001,1011,1013,102
                                                                                                  3,1025,1035,1037,1053,1056,1069,10
                                                                                                  71,1073,1078,1091,1093,1098,1111,1
                                                                                                  113,1118,1131,1133,1138,1151,1153,
                                                                                                  1159,1172,1174,1180,1193,1195,1201
                                                                                                  ,1214,1216,1222,1235,1237,1265,126
                                                                                                  7,1270,1272,1275,1277,1280,1282,13
                                                                                                  02,1316,1332,1346,1362,1376,1392,1
                                                                                                  406,1422,1436,1447,1460,1462,1473,
                                                                                                  1486,1488,1493,1496,1501,1504,1510
                                                                                                  ,1513,1523,1526,1532,1535,1541,154

Page 41          Source Listing                  SURFCE2
2022-02-15 16:39 Symbol Table                    SURFCE2.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
                                                                                                  4,1549,1552,1557,1560,1565,1567,15
                                                                                                  69,1574,1577,1587,1590,1600,1603,1
                                                                                                  613,1617,1667,1671,1675,1679,1689,
                                                                                                  1693,1697,1701,1705,1709,1713,1717
                                                                                                  ,1721,1725,1729,1733,1737,1741,174
                                                                                                  8,1751,1756,1770,1778,1795,1800,18
                                                                                                  14,1822,1839,1845,1859,1867,1884,1
                                                                                                  890,1904,1912,1929,1935,1949,1957,
                                                                                                  1974,1980,1994,2002,2019,2027,2041
                                                                                                  ,2049,2066,2072,2086,2094,2111    
 JMT                        Param  106      I(4)            4           scalar                    314,315                           
 JMX                        Param  101      I(4)            4           scalar                    310,311,316,317,318,319           
 JNPES                      Param  86       I(4)            4           scalar                    92,95                             
 JTAIL                      Param  92       I(4)            4           scalar                                                      
 JTB                        Param  145      I(4)            4           scalar                    282,292                           
 JTBQ                       Param  145      I(4)            4           scalar                    292                               
 KSAV                       Param  116      I(4)            4           scalar                                                      
 KSFI                       Param  115      I(4)            4           scalar                                                      
 KSLI                       Param  116      I(4)            4           scalar                                                      
 KSLP                       Param  116      I(4)            4           scalar                                                      
 KSLPD                      Param  115      I(4)            4           scalar                                                      
 KSMUD                      Param  115      I(4)            4           scalar                                                      
 KSRH                       Param  116      I(4)            4           scalar                                                      
 KSSLP                      Param  115      I(4)            4           scalar                                                      
 KST                        Param  115      I(4)            4           scalar                                                      
 KSUV                       Param  116      I(4)            4           scalar                                                      
 L                          Local  414      I(4)            4           scalar                    414,417,419,420,422,606,609,612,61
                                                                                                  8,621,624,630,633,639,642,645,650,
                                                                                                  653,659,662,666                   
 LB                         Param  111      I(4)            4           scalar                                                      
 LHEAT                      Param  142      I(4)            4           scalar                    142                               
 LHTOCP                     Param  142      I(4)            4           scalar                                                      
 LLGRDS                     Common 309                                  8071788  SAVE                                               
 LM                         Param  83       I(4)            4           scalar                    101,110,121,213,225,235,245,257,26
                                                                                                  3,281,389,414                     
 LM1                        Param  110      I(4)            4           scalar                                                      
 LMHK                       Local  452      I(4)            4           scalar                    452,453,454                       
 LOOPS                      Common 268                                  748952   SAVE                                               
 LP1                        Param  110      I(4)            4           scalar                    212,235,281                       
 LS                         Local  618      I(4)            4           scalar                    618,619,639,640,659,660           
 LSM                        Param  83       I(4)            4           scalar                    234                               
 MAPOT                      Common 229                                  1448     SAVE                                               
 MASKS                      Common 242                                  34853220 SAVE                                               
 MOD                        Func   841                                  scalar                    841,842,853,854,871,872,885,886,89
                                                                                                  6,897,911,912,929,930,941,942,953,
                                                                                                  954,965,966,979,980,997,998,1009,1
                                                                                                  010,1021,1022,1033,1034,1082,1102,
                                                                                                  1122,1142,1163,1184,1205,1226,1250
                                                                                                  ,1251,1252,1306,1336,1366,1396,142
                                                                                                  6,1451,1477,1760,1782,1804,1826,18
                                                                                                  49,1871,1894,1916,1939,1961,1984,2
                                                                                                  006,2031,2053,2076,2098           
 MXFLD                      Param  101      I(4)            4           scalar                    197,203,204,205,206               
 MXLVL                      Param  101      I(4)            4           scalar                    205                               
 NINC                       Param  109      I(4)            4           scalar                                                      

Page 42          Source Listing                  SURFCE2
2022-02-15 16:39 Symbol Table                    SURFCE2.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 NINT                       Func   622                                  scalar                    622,623,643,644,663,664           
 NROOT                      Param  155      I(4)            4           scalar                                                      
 NROOTS                     Local  165      I(4)            4     2     91719                     1649,1656,1686                    
 NSOIL                      Param  155      I(4)            4           scalar                    327,328,606,1648                  
 NSTAT                      Param  121      I(4)            4           scalar                                                      
 NSUMD                      Param  117      I(4)            4           scalar                                                      
 NWORD                      Param  121      I(4)            4           scalar                    121                               
 NWORD3                     Param  121      I(4)            4           scalar                                                      
 NWORD6                     Param  121      I(4)            4           scalar                                                      
 ONEPS                      Param  141      R(4)            4           scalar                    509,863                           
 OUTPUT                     Subr   527                                                            527,535,544,553,561,569,578,587,59
                                                                                                  7,624,645,666,678,689,700,709,718,
                                                                                                  735,742,780,787,794,802,810,818,84
                                                                                                  3,855,873,887,898,917,919,932,944,
                                                                                                  956,968,985,987,1000,1012,1024,103
                                                                                                  6,1055,1072,1092,1112,1132,1152,11
                                                                                                  73,1194,1215,1236,1266,1271,1276,1
                                                                                                  281,1315,1345,1375,1405,1435,1461,
                                                                                                  1487,1495,1503,1512,1525,1534,1543
                                                                                                  ,1551,1559,1568,1576,1589,1602,161
                                                                                                  6,1670,1678,1692,1700,1708,1716,17
                                                                                                  24,1732,1740,1750,1769,1794,1813,1
                                                                                                  838,1858,1883,1903,1928,1948,1973,
                                                                                                  1993,2018,2040,2065,2085,2110     
 OVERRC                     Param  135      R(4)            4           scalar                    135                               
 P10                        Local  177      R(4)            4     2     91719                     453,455,955                       
 P1000                      Param  137      R(4)            4           scalar                    455,456,466                       
 P1D                        Local  168      R(4)            4     2     91719                                                       
 P30                        Local  177      R(4)            4     2     91719                     454,456,1023                      
 PARALLEL                   Common 189                                  8240                                                        
 PHYS                       Common 276                                  7690036  SAVE                                               
 PPTASM                     Common 388                                  19811316 SAVE                                               
 PQ0                        Param  143      R(4)            4           scalar                    484                               
 PSFC                       Local  166      R(4)            4     2     91719                     462,466,484,509,525,533           
 PTRACE                     Param  156      R(4)            4           scalar                                                      
 PVRBLS                     Common 250                                  23480064 SAVE                                               
 Q1D                        Local  168      R(4)            4     2     91719                                                       
 QFLX                       Common 358                                  8438148                                                     
 QI                         Local  486      R(4)            4           scalar                    486,489,494                       
 QINT                       Local  487      R(4)            4           scalar                    487,491,496                       
 QSAT                       Local  489      R(4)            4           scalar                    489,491,494,496,501,504,508       
 QSFC                       Local  166      R(4)            4     2     91719                     472,473,504,508,509,575           
 QW                         Local  484      R(4)            4           scalar                    484,486,487,501                   
 RAIN                       Local  172      R(4)            4     2     91719                     1257,1280                         
 RC                         Local  1648     R(4)            4           scalar                    1648                              
 RCAPA                      Param  137      R(4)            4           scalar                                                      
 RCQ                        Local  176      R(4)            4     2     91719                     1650,1660,1729                    
 RCS                        Local  176      R(4)            4     2     91719                     1650,1659,1713                    
 RCSOIL                     Local  176      R(4)            4     2     91719                     1650,1662,1737                    
 RCT                        Local  176      R(4)            4     2     91719                     1650,1661,1721                    
 RD                         Param  134      R(4)            4           scalar                    134,138,142                       
 RDOCP                      Param  142      R(4)            4           scalar                                                      
 RDTPHS                     Local  1060     R(4)            4           scalar                    1060,1064                         
 RG                         Param  138      R(4)            4           scalar                                                      
 RHSFC                      Local  166      R(4)            4     2     91719                     504,506,507,508,593               

Page 43          Source Listing                  SURFCE2
2022-02-15 16:39 Symbol Table                    SURFCE2.f

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 ROG                        Param  134      R(4)            4           scalar                                                      
 RQSTFLD                    Common 202                                  64130                                                       
 RRNUM                      Local  1292     R(4)            4           scalar                    1292,1294,1298,1322,1324,1328,1352
                                                                                                  ,1354,1358,1382,1384,1388,1412,141
                                                                                                  4,1418                            
 RSMIN                      Local  175      R(4)            4     2     91719                     1649,1655,1675                    
 RTD                        Param  136      R(4)            4           scalar                                                      
 SCLFLD                     Subr   594                                                            594,688,699,708,717,881,1071,1091,
                                                                                                  1111,1131,1151,1172,1193,1214,1235
                                                                                                  ,1460,1486,1567                   
 SEC2HR                     Param  160      R(4)            4           scalar                                                      
 SFCPRS                     Local  1639     R(4)            4           scalar                    1639,1647                         
 SFCQ                       Local  1638     R(4)            4           scalar                    1638,1647                         
 SFCTMP                     Local  1637     R(4)            4           scalar                    1637,1647                         
 SLEET                      Local  172      R(4)            4     2     91719                     1255,1270                         
 SMCDRY                     Local  174      R(4)            4     2     91719                     765,772,807                       
 SMCMAX                     Local  174      R(4)            4     2     91719                     766,773,815                       
 SMCREF                     Local  175      R(4)            4     2     91719                     1649,1658,1705                    
 SMCWLT                     Local  175      R(4)            4     2     91719                     1649,1651,1652,1657,1697          
 SMTHA                      Param  117      R(4)            4           scalar                                                      
 SMTHB                      Param  117      R(4)            4           scalar                                                      
 SNCOVR                     Local  728      R(4)            4           scalar                    728,729                           
 SNEQV                      Local  726      R(4)            4           scalar                    726,728                           
 SNFRAC                     Subr   728                                                            728                               
 SNOW                       Local  172      R(4)            4     2     91719                     1254,1265                         
 SOIL                       Common 323                                  8438180                                                     
 SOLAR                      Local  1636     R(4)            4           scalar                    1636,1647                         
 SRFDSP                     Common 297                                  4402512                                                     
 SURFCE2                    Subr   1                                                                                                
 T10                        Local  177      R(4)            4     2     91719                     455,943                           
 T1D                        Local  168      R(4)            4     2     91719                                                       
 T30                        Local  177      R(4)            4     2     91719                     456,1011                          
 TFRZ                       Param  141      R(4)            4           scalar                                                      
 THSFC                      Local  167      R(4)            4     2     91719                     465,466,567                       
 TMT0                       Local  476      R(4)            4           scalar                    476,477,480,486,488,490           
 TMT15                      Local  477      R(4)            4           scalar                    477,487                           
 TSFC                       Local  166      R(4)            4     2     91719                     466,474,559                       
 TSFCK                      Local  474      R(4)            4           scalar                    474,476,485                       
 UA                         Local  169      R(4)            4     2     91719                                                       
 VA                         Local  169      R(4)            4     2     91719                                                       
 VRBLS                      Common 222                                  67138308                                                    
 ZSFC                       Local  167      R(4)            4     2     91719                     459,541,550                       


TYPE COMPONENTS/COMMON VARIABLES

 Name                       Type            Bytes Offset   Dimen Elements Attributes       References                         
                                                                                                                              
 ACCLIQ                     R(4)            4     6236892  2     91719    COM                                                 
 ACPREC                     R(4)            4     5870016  2     91719    COM              515,1078,1098                      
 ACSNOM                     R(4)            4     366880   2     91719    COM              1179                               
 ACSNOW                     R(4)            4     4        2     91719    COM              1158                               
 AETA                       R(4)            4     808      1     45       COM              1242,1639                          
 AETA2                      R(4)            4     264      1     45       COM                                                 
 AKHS                       R(4)            4     733752   2     91719    COM                                                 

Page 44          Source Listing                  SURFCE2
2022-02-15 16:39 Symbol Table                    SURFCE2.f

 Name                       Type            Bytes Offset   Dimen Elements Attributes       References                         
                                                                                                                              
 AKMS                       R(4)            4     366876   2     91719    COM                                                 
 ALBASE                     R(4)            4     5139788  2     91719    COM                                                 
 ALBEDO                     R(4)            4     5506664  2     91719    COM                                                 
 ALPINT                     R(4)            4     16876296 3     4219074  COM                                                 
 ALSL                       R(4)            4     472      1     39       COM                                                 
 APREC                      R(4)            4     17976924 2     91719    COM                                                 
 ARDSW                      R(4)            4     8              scalar   COM                                                 
 ASRFC                      R(4)            4     8              scalar   COM              1291,1292,1321,1322,1351,1352,1381 
                                                                                           ,1382,1411,1412                    
 ASWIN                      R(4)            4     1100640  2     91719    COM                                                 
 ASWOUT                     R(4)            4     1467516  2     91719    COM                                                 
 ASWTOA                     R(4)            4     1834392  2     91719    COM                                                 
 AVBL                       CHAR            20    59130    1     250      COM                                                 
 BGROFF                     R(4)            4     1100632  2     91719    COM              1221                               
 CFRACH                     R(4)            4     1100628  2     91719    COM                                                 
 CFRACL                     R(4)            4     366876   2     91719    COM                                                 
 CFRACM                     R(4)            4     733752   2     91719    COM                                                 
 CI                         R(4)            4     40             scalar   COM                                                 
 CLDEFI                     R(4)            4     5136264  2     91719    COM                                                 
 CLDINC                     R(4)            4     19077564 2     91719    COM              2072,2090                          
 CLDINC7                    R(4)            4     19444440 2     91719    COM              2090                               
 CMC                        R(4)            4     3668760  2     91719    COM              706,764                            
 CMLD                       R(4)            4     292            scalar   COM                                                 
 CPHI0                      R(4)            4     1420           scalar   COM                                                 
 CS                         R(4)            4     28             scalar   COM                                                 
 CUPPT                      R(4)            4     0        2     91719    COM                                                 
 CUPREC                     R(4)            4     6603768  2     91719    COM              515,1118                           
 CWM                        R(4)            4     0        3     4127355  COM              419                                
 CZEN                       R(4)            4     2204780  2     91719    COM              1632                               
 CZMEAN                     R(4)            4     6607292  2     91719    COM              1631,1632                          
 DATSET                     CHAR            6     54124          scalar   COM                                                 
 DCFLX                      R(4)            4     6236892  2     91719    COM              1800,1818                          
 DCFLX7                     R(4)            4     6970644  2     91719    COM              1818                               
 DEC                        R(4)            4     1016     1     250      COM                                                 
 DETA                       R(4)            4     628      1     45       COM                                                 
 DETA2                      R(4)            4     84       1     45       COM                                                 
 DFRLG                      R(4)            4     444      1     46       COM                                                 
 DI                         R(4)            4     44             scalar   COM                                                 
 DISLP                      R(4)            4     308            scalar   COM                                                 
 DLMD                       R(4)            4     284            scalar   COM                                                 
 DP30                       R(4)            4     296            scalar   COM                                                 
 DPHD                       R(4)            4     288            scalar   COM                                                 
 DQADV                      R(4)            4     7337520  2     91719    COM              1748                               
 DQFLX                      R(4)            4     5870016  2     91719    COM              1756,1774                          
 DQFLX7                     R(4)            4     6603768  2     91719    COM              1774                               
 DS                         R(4)            4     32             scalar   COM                                                 
 DT                         R(4)            4     48             scalar   COM                                                 
 DTD                        R(4)            4     16             scalar   COM                                                 
 DTQ2                       R(4)            4     8              scalar   COM              1060                               
 EGRDI                      R(4)            4     4769904  2     91719    COM                                                 
 EGRDJ                      R(4)            4     5136780  2     91719    COM                                                 
 ELWDWN                     R(4)            4     2938532  2     91719    COM                                                 
 EPSR                       R(4)            4     370400   2     91719    COM                                                 
 ERLAM0                     R(4)            4     1416           scalar   COM                                                 
 ETA                        R(4)            4     988      1     46       COM              1242                               

Page 45          Source Listing                  SURFCE2
2022-02-15 16:39 Symbol Table                    SURFCE2.f

 Name                       Type            Bytes Offset   Dimen Elements Attributes       References                         
                                                                                                                              
 EVLAT                      R(4)            4     4035808  2     91762    COM                                                 
 EVLON                      R(4)            4     4402856  2     91762    COM                                                 
 FCNEV                      R(4)            4     1467504  2     91719    COM                                                 
 FCNEV7                     R(4)            4     2201256  2     91719    COM                                                 
 FCSEV                      R(4)            4     1834380  2     91719    COM                                                 
 FCSEV7                     R(4)            4     2568132  2     91719    COM                                                 
 FCU                        R(4)            4     3668760  2     91719    COM              1935,1953                          
 FCU7                       R(4)            4     5136264  2     91719    COM              1953                               
 FCV                        R(4)            4     4035636  2     91719    COM              1980,1998                          
 FCV7                       R(4)            4     5503140  2     91719    COM              1998                               
 FIELD                      CHAR            20    54130    1     250      COM                                                 
 FIRST                      L(4)            4     24             scalar   COM                                                 
 FIS                        R(4)            4     733752   2     91719    COM              459                                
 FQNEV                      R(4)            4     0        2     91719    COM                                                 
 FQNEV1                     R(4)            4     7704396  2     91719    COM                                                 
 FQNEV7                     R(4)            4     733752   2     91719    COM                                                 
 FQSEV                      R(4)            4     366876   2     91719    COM                                                 
 FQSEV1                     R(4)            4     8071272  2     91719    COM                                                 
 FQSEV7                     R(4)            4     1100628  2     91719    COM                                                 
 FQU                        R(4)            4     2935008  2     91719    COM              1845,1863                          
 FQU7                       R(4)            4     4402512  2     91719    COM              1863                               
 FQV                        R(4)            4     3301884  2     91719    COM              1890,1908                          
 FQV7                       R(4)            4     4769388  2     91719    COM              1908                               
 FSL                        R(4)            4     70405632 2     91719    COM                                                 
 FVTLON                     R(4)            4     3668760  2     91762    COM                                                 
 GDLAT                      R(4)            4     0        2     91719    COM                                                 
 GDLON                      R(4)            4     366876   2     91719    COM                                                 
 GDTLAT                     R(4)            4     733752   2     91719    COM                                                 
 GDTLON                     R(4)            4     1100628  2     91719    COM                                                 
 GFFC                       R(4)            4     4406036  2     91719    COM                                                 
 GLAT                       R(4)            4     1471028  2     91719    COM                                                 
 GLON                       R(4)            4     1837904  2     91719    COM                                                 
 GRNFLX                     R(4)            4     1467504  2     91719    COM              1574                               
 HBM2                       R(4)            4     0        2     91719    COM              1636                               
 HBOT                       R(4)            4     3672284  2     91719    COM                                                 
 HDAC                       R(4)            4     5873540  2     91719    COM                                                 
 HDACV                      R(4)            4     6240416  2     91719    COM                                                 
 HTLAT                      R(4)            4     1467504  2     91719    COM                                                 
 HTLON                      R(4)            4     1834380  2     91719    COM                                                 
 HTM                        R(4)            4     1834380  3     4127355  COM              1242                               
 HTOP                       R(4)            4     3305408  2     91719    COM                                                 
 ICNT                       I(4)            4     40       1     1024     COM                                                 
 ID                         I(4)            4     54016    1     25       COM              526,534,543,552,560,568,577,586,59 
                                                                                           6,616,622,623,637,643,644,657,663, 
                                                                                           664,665,675,677,685,686,687,696,69 
                                                                                           7,698,707,716,734,741,779,786,793, 
                                                                                           800,801,808,809,816,817,839,841,84 
                                                                                           2,851,853,854,869,871,872,883,885, 
                                                                                           886,894,896,897,909,911,912,927,92 
                                                                                           9,930,939,941,942,951,953,954,963, 
                                                                                           965,966,977,979,980,995,997,998,10 
                                                                                           07,1009,1010,1019,1021,1022,1031,1 
                                                                                           033,1034,1054,1070,1079,1083,1084, 
                                                                                           1086,1088,1090,1099,1103,1104,1106 
                                                                                           ,1108,1110,1119,1123,1124,1126,112 

Page 46          Source Listing                  SURFCE2
2022-02-15 16:39 Symbol Table                    SURFCE2.f

 Name                       Type            Bytes Offset   Dimen Elements Attributes       References                         
                                                                                                                              
                                                                                           8,1130,1139,1143,1144,1146,1148,11 
                                                                                           50,1160,1164,1165,1167,1169,1171,1 
                                                                                           181,1185,1186,1188,1190,1192,1202, 
                                                                                           1206,1207,1209,1211,1213,1223,1227 
                                                                                           ,1228,1230,1232,1234,1243,1264,126 
                                                                                           9,1274,1279,1303,1307,1308,1310,13 
                                                                                           12,1314,1333,1337,1338,1340,1342,1 
                                                                                           344,1363,1367,1368,1370,1372,1374, 
                                                                                           1393,1397,1398,1400,1402,1404,1423 
                                                                                           ,1427,1428,1430,1432,1434,1448,145 
                                                                                           2,1453,1455,1457,1459,1474,1478,14 
                                                                                           79,1481,1483,1485,1494,1502,1511,1 
                                                                                           524,1533,1542,1550,1558,1566,1575, 
                                                                                           1588,1601,1614,1615,1668,1669,1676 
                                                                                           ,1677,1690,1691,1698,1699,1706,170 
                                                                                           7,1714,1715,1722,1723,1730,1731,17 
                                                                                           38,1739,1749,1757,1761,1762,1764,1 
                                                                                           766,1768,1779,1783,1784,1786,1788, 
                                                                                           1790,1791,1792,1793,1801,1805,1806 
                                                                                           ,1808,1810,1812,1823,1827,1828,183 
                                                                                           0,1832,1834,1835,1836,1837,1846,18 
                                                                                           50,1851,1853,1855,1857,1868,1872,1 
                                                                                           873,1875,1877,1879,1880,1881,1882, 
                                                                                           1891,1895,1896,1898,1900,1902,1913 
                                                                                           ,1917,1918,1920,1922,1924,1925,192 
                                                                                           6,1927,1936,1940,1941,1943,1945,19 
                                                                                           47,1958,1962,1963,1965,1967,1969,1 
                                                                                           970,1971,1972,1981,1985,1986,1988, 
                                                                                           1990,1992,2003,2007,2008,2010,2012 
                                                                                           ,2014,2015,2016,2017,2028,2032,203 
                                                                                           3,2035,2037,2039,2050,2054,2055,20 
                                                                                           57,2059,2061,2062,2063,2064,2073,2 
                                                                                           077,2078,2080,2082,2084,2095,2099, 
                                                                                           2100,2102,2104,2106,2107,2108,2109 
 IDAT                       I(4)            4     8        1     3        COM                                                 
 IDENT                      I(4)            4     52016    1     250      COM                                                 
 IDN                        I(4)            4     36             scalar   COM                                                 
 IDSP                       I(4)            4     4136     1     1024     COM                                                 
 IDTAD                      I(4)            4     68             scalar   COM                                                 
 IEGRD                      I(4)            4     5503656  2     91719    COM                                                 
 IEGRDK                     I(4)            4     2201256  2     91719    COM                                                 
 IFILV                      I(4)            4     53016    1     250      COM                                                 
 IGET                       I(4)            4     16       1     250      COM              410,442,443,444,445,446,513,514,52 
                                                                                           4,527,532,535,540,544,549,553,558, 
                                                                                           561,566,569,574,578,583,587,592,59 
                                                                                           7,608,609,624,629,630,645,649,650, 
                                                                                           666,673,678,683,689,694,700,705,70 
                                                                                           9,714,718,723,735,739,742,753,754, 
                                                                                           755,777,780,784,787,791,794,798,80 
                                                                                           2,806,810,814,818,830,831,832,837, 
                                                                                           843,848,855,860,873,878,887,892,89 
                                                                                           8,907,915,917,918,919,920,926,932, 
                                                                                           933,938,944,945,950,956,957,962,96 
                                                                                           8,969,975,983,985,986,987,988,994, 
                                                                                           1000,1001,1006,1012,1013,1018,1024 

Page 47          Source Listing                  SURFCE2
2022-02-15 16:39 Symbol Table                    SURFCE2.f

 Name                       Type            Bytes Offset   Dimen Elements Attributes       References                         
                                                                                                                              
                                                                                           ,1025,1030,1036,1037,1047,1055,105 
                                                                                           9,1072,1077,1092,1097,1112,1117,11 
                                                                                           32,1137,1152,1157,1173,1178,1194,1 
                                                                                           199,1215,1220,1236,1241,1266,1271, 
                                                                                           1276,1281,1290,1315,1320,1345,1350 
                                                                                           ,1375,1380,1405,1410,1435,1440,146 
                                                                                           1,1466,1487,1492,1495,1500,1503,15 
                                                                                           08,1512,1517,1521,1525,1530,1534,1 
                                                                                           540,1543,1548,1551,1556,1559,1564, 
                                                                                           1568,1573,1576,1581,1589,1594,1602 
                                                                                           ,1607,1616,1621,1622,1623,1624,162 
                                                                                           5,1666,1670,1674,1678,1683,1692,16 
                                                                                           96,1700,1704,1708,1712,1716,1720,1 
                                                                                           724,1728,1732,1736,1740,1747,1750, 
                                                                                           1755,1769,1794,1799,1813,1838,1844 
                                                                                           ,1858,1883,1889,1903,1928,1934,194 
                                                                                           8,1973,1979,1993,2018,2026,2040,20 
                                                                                           65,2071,2085,2110                  
 IHHA                       I(4)            4     3040     1     760      COM                                                 
 IHLA                       I(4)            4     0        1     760      COM                                                 
 IHRST                      I(4)            4     20             scalar   COM                                                 
 IOUT                       I(4)            4     44             scalar   COM                                                 
 IOUTYP                     I(4)            4     4              scalar   COM              527,535,544,553,561,569,578,587,59 
                                                                                           7,624,645,666,678,689,700,709,718, 
                                                                                           735,742,780,787,794,802,810,818,84 
                                                                                           3,855,873,887,898,917,919,932,944, 
                                                                                           956,968,985,987,1000,1012,1024,103 
                                                                                           6,1055,1072,1092,1112,1132,1152,11 
                                                                                           73,1194,1215,1236,1266,1271,1276,1 
                                                                                           281,1315,1345,1375,1405,1435,1461, 
                                                                                           1487,1495,1503,1512,1525,1534,1543 
                                                                                           ,1551,1559,1568,1576,1589,1602,161 
                                                                                           6,1670,1678,1692,1700,1708,1716,17 
                                                                                           24,1732,1740,1750,1769,1794,1813,1 
                                                                                           838,1858,1883,1903,1928,1948,1973, 
                                                                                           1993,2018,2040,2065,2085,2110      
 IQ                         I(4)            4     2016     1     250      COM                                                 
 IS                         I(4)            4     3016     1     250      COM                                                 
 ISHDE                      I(4)            4     12       1     61       COM                                                 
 ISLOPE                     I(4)            4     2935008  2     91719    COM              1610                               
 ISLTYP                     I(4)            4     2568132  2     91719    COM              764,1597,1648,1652                 
 ISMFUL                     I(4)            4     5016     1     250      COM                                                 
 ISMOUT                     I(4)            4     6016     1     250      COM                                                 
 ISMSTG                     I(4)            4     4016     1     250      COM                                                 
 ITSTLOC                    I(4)            4     18343800       scalar   COM                                                 
 IUNIT                      I(4)            4     1440           scalar   COM                                                 
 IUP                        I(4)            4     32             scalar   COM                                                 
 IVGTYP                     I(4)            4     2201256  2     91719    COM              727,1584,1642                      
 IVHA                       I(4)            4     9120     1     760      COM                                                 
 IVLA                       I(4)            4     6080     1     760      COM                                                 
 IWGT                       I(4)            4     6237408  2     91719    COM                                                 
 IXM                        I(4)            4     4              scalar   COM                                                 
 IYM                        I(4)            4     8              scalar   COM                                                 
 JEGRD                      I(4)            4     5870532  2     91719    COM                                                 
 JEGRDK                     I(4)            4     2568132  2     91719    COM                                                 

Page 48          Source Listing                  SURFCE2
2022-02-15 16:39 Symbol Table                    SURFCE2.f

 Name                       Type            Bytes Offset   Dimen Elements Attributes       References                         
                                                                                                                              
 JEND                       I(4)            4     12             scalar   COM              415,448,610,631,651,724,756,861,10 
                                                                                           48,1062,1247,1296,1326,1356,1386,1 
                                                                                           416,1441,1467,1582,1595,1608,1626, 
                                                                                           1684,1772,1816,1861,1906,1951,1996 
                                                                                           ,2043,2088                         
 JEND_2U                    I(4)            4     8236           scalar   COM                                                 
 JEND_M                     I(4)            4     20             scalar   COM                                                 
 JEND_M2                    I(4)            4     28             scalar   COM                                                 
 JRA                        I(4)            4     12160    1     760      COM                                                 
 JSTA                       I(4)            4     8              scalar   COM              415,448,610,631,651,724,756,861,10 
                                                                                           48,1062,1247,1296,1326,1356,1386,1 
                                                                                           416,1441,1467,1582,1595,1608,1626, 
                                                                                           1684,1772,1816,1861,1906,1951,1996 
                                                                                           ,2043,2088                         
 JSTA_2L                    I(4)            4     8232           scalar   COM                                                 
 JSTA_M                     I(4)            4     16             scalar   COM                                                 
 JSTA_M2                    I(4)            4     24             scalar   COM                                                 
 JTSTLOC                    I(4)            4     18343804       scalar   COM                                                 
 KGTYPE                     I(4)            4     0              scalar   COM                                                 
 KMNT                       I(4)            4     50629068 2     4118670  COM                                                 
 KMNTM                      I(4)            4     50628888 1     45       COM                                                 
 KTM                        I(4)            4     0              scalar   COM                                                 
 KUNIT                      I(4)            4     1428           scalar   COM                                                 
 LC                         I(4)            4     16876656 2     91719    COM                                                 
 LCNTRL                     I(4)            4     4              scalar   COM                                                 
 LIST                       I(4)            4     40             scalar   COM                                                 
 LMH                        I(4)            4     15200    2     91719    COM              417,452,1242,1637,1638,1639        
 LMV                        I(4)            4     382076   2     91719    COM                                                 
 LSL                        I(4)            4     0              scalar   COM                                                 
 LUNCO                      I(4)            4     8              scalar   COM                                                 
 LUNIT                      I(4)            4     1432           scalar   COM                                                 
 LUNLL                      I(4)            4     12             scalar   COM                                                 
 LUNOUT                     I(4)            4     16             scalar   COM                                                 
 LVLS                       I(4)            4     7016     2     11250    COM              514,527,535,544,553,561,569,578,58 
                                                                                           7,597,609,630,650,678,689,700,709, 
                                                                                           718,735,742,780,787,794,802,810,81 
                                                                                           8,843,855,873,887,898,918,920,933, 
                                                                                           945,957,969,986,988,1001,1013,1025 
                                                                                           ,1037,1055,1072,1092,1112,1132,115 
                                                                                           2,1173,1194,1215,1236,1266,1271,12 
                                                                                           76,1281,1315,1345,1375,1405,1435,1 
                                                                                           461,1487,1495,1503,1512,1525,1534, 
                                                                                           1543,1551,1559,1568,1576,1589,1602 
                                                                                           ,1616,1670,1678,1692,1700,1708,171 
                                                                                           6,1724,1732,1740,1750,1769,1794,18 
                                                                                           13,1838,1858,1883,1903,1928,1948,1 
                                                                                           973,1993,2018,2040,2065,2085,2110  
 ME                         I(4)            4     4              scalar   COM                                                 
 MTSTPE                     I(4)            4     18343808       scalar   COM                                                 
 MUNIT                      I(4)            4     1436           scalar   COM                                                 
 NBC                        I(4)            4     36             scalar   COM                                                 
 NBOCO                      I(4)            4     72             scalar   COM                                                 
 NCP                        I(4)            4     80             scalar   COM                                                 
 NDDAMP                     I(4)            4     60             scalar   COM                                                 
 NFCST                      I(4)            4     32             scalar   COM                                                 

Page 49          Source Listing                  SURFCE2
2022-02-15 16:39 Symbol Table                    SURFCE2.f

 Name                       Type            Bytes Offset   Dimen Elements Attributes       References                         
                                                                                                                              
 NFLD                       I(4)            4     12             scalar   COM                                                 
 NPHS                       I(4)            4     84             scalar   COM                                                 
 NPREC                      I(4)            4     64             scalar   COM                                                 
 NRADL                      I(4)            4     92             scalar   COM                                                 
 NRADS                      I(4)            4     88             scalar   COM                                                 
 NRDSW                      I(4)            4     4              scalar   COM                                                 
 NSHDE                      I(4)            4     76             scalar   COM                                                 
 NSRFC                      I(4)            4     4              scalar   COM                                                 
 NTSD                       I(4)            4     52             scalar   COM              1080,1100,1120,1140,1161,1182,1203 
                                                                                           ,1224,1304,1334,1364,1394,1424,144 
                                                                                           9,1475,1758,1780,1802,1824,1847,18 
                                                                                           69,1892,1914,1937,1959,1982,2004,2 
                                                                                           029,2051,2074,2096                 
 NTSTM                      I(4)            4     56             scalar   COM                                                 
 NUM_PROCS                  I(4)            4     0              scalar   COM                                                 
 NUNIT                      I(4)            4     1444           scalar   COM                                                 
 OLDRD                      L(4)            4     71506260       scalar   COM                                                 
 PCTSNO                     R(4)            4     1834380  2     91719    COM              729,732                            
 PD                         R(4)            4     0        2     91719    COM              453,454,462,1242                   
 PDSL                       R(4)            4     67837500 2     91719    COM              1639                               
 PDVP1                      R(4)            4     68204376 2     91719    COM                                                 
 PFSL                       R(4)            4     69305004 2     91719    COM                                                 
 PHOUR                      R(4)            4     0        2     91719    COM                                                 
 PINT                       R(4)            4     0        3     4219074  COM                                                 
 PL                         R(4)            4     48             scalar   COM                                                 
 PLQ                        R(4)            4     72             scalar   COM                                                 
 POTEVP                     R(4)            4     2201268  2     91719    COM              763,1469                           
 PPTDAT                     R(4)            4     16876296 3     275157   COM                                                 
 PREC                       R(4)            4     5503140  2     91719    COM              1064,1242                          
 PSHLTR                     R(4)            4     2568132  2     91719    COM              863,879,893                        
 PSLP                       R(4)            4     68571252 2     91719    COM                                                 
 PT                         R(4)            4     260            scalar   COM              453,454,462,1242,1639              
 PT2                        R(4)            4     4              scalar   COM                                                 
 PTBL                       R(4)            4     7341044  2     10184    COM                                                 
 PTSL                       R(4)            4     68938128 2     91719    COM                                                 
 Q                          R(4)            4     50628888 3     4127355  COM              1242,1638                          
 Q10                        R(4)            4     733752   2     91719    COM              967                                
 Q2                         R(4)            4     6970644  3     4127355  COM                                                 
 Q30                        R(4)            4     3301884  2     91719    COM              1035                               
 QS                         R(4)            4     1467504  2     91719    COM              472                                
 QS0                        R(4)            4     628      1     134      COM                                                 
 QSHLTR                     R(4)            4     2201256  2     91719    COM              849,863,879                        
 QSL                        R(4)            4     70772508 2     91719    COM                                                 
 QWBS                       R(4)            4     4035636  2     91719    COM              763,1549                           
 QZ0                        R(4)            4     2935008  2     91719    COM                                                 
 R                          R(4)            4     256            scalar   COM                                                 
 RADIN                      R(4)            4     737276   2     91719    COM                                                 
 RADOT                      R(4)            4     1104152  2     91719    COM                                                 
 RDP                        R(4)            4     64             scalar   COM                                                 
 RDPQ                       R(4)            4     76             scalar   COM                                                 
 RDQ                        R(4)            4     56             scalar   COM                                                 
 RDTH                       R(4)            4     60             scalar   COM                                                 
 RDTHE                      R(4)            4     68             scalar   COM                                                 
 RDTHEQ                     R(4)            4     80             scalar   COM                                                 
 RES                        R(4)            4     366876   2     91719    COM              1242                               

Page 50          Source Listing                  SURFCE2
2022-02-15 16:39 Symbol Table                    SURFCE2.f

 Name                       Type            Bytes Offset   Dimen Elements Attributes       References                         
                                                                                                                              
 RESTRT                     L(4)            4     28             scalar   COM                                                 
 RF                         R(4)            4     3301884  2     91719    COM                                                 
 RITE2                      L(4)            4     54120          scalar   COM                                                 
 RITEHD                     L(4)            4     54116          scalar   COM                                                 
 RMXSNAL                    R(4)            4     3524     2     91719    COM                                                 
 ROI                        R(4)            4     36             scalar   COM                                                 
 ROS                        R(4)            4     24             scalar   COM                                                 
 RSWIN                      R(4)            4     12       2     91719    COM              1636                               
 RSWOUT                     R(4)            4     366888   2     91719    COM                                                 
 RSWTOA                     R(4)            4     733764   2     91719    COM                                                 
 RTDPTH                     R(4)            4     6970660  1     4        COM                                                 
 RUN                        L(4)            4     4              scalar   COM                                                 
 SBD                        R(4)            4     272            scalar   COM                                                 
 SFCEVP                     R(4)            4     1834392  2     91719    COM              1443                               
 SFCEXC                     R(4)            4     366876   2     91719    COM              1557                               
 SFCLHX                     R(4)            4     366888   2     91719    COM              1298                               
 SFCSHX                     R(4)            4     12       2     91719    COM              1328                               
 SFCUVX                     R(4)            4     1467516  2     91719    COM              1418                               
 SH2O                       R(4)            4     6970676  3     366876   COM              653,764,1648                       
 SI                         R(4)            4     4769388  2     91719    COM              740                                
 SICE                       R(4)            4     1467504  2     91719    COM              762,1630                           
 SIGMA                      L(4)            4     0              scalar   COM                                                 
 SIGT4                      R(4)            4     6974168  2     91719    COM                                                 
 SLDPTH                     R(4)            4     6970644  1     4        COM              619,621,640,642,660,662            
 SLP                        R(4)            4     67103748 2     91719    COM                                                 
 SM                         R(4)            4     1100628  2     91719    COM              761,1629,1652                      
 SMC                        R(4)            4     4035636  3     366876   COM              633                                
 SMSTAV                     R(4)            4     733752   2     91719    COM              684                                
 SMSTOT                     R(4)            4     1100628  2     91719    COM              695                                
 SNO                        R(4)            4     4402512  2     91719    COM              715,726,763                        
 SNOPCX                     R(4)            4     1100640  2     91719    COM              1388                               
 SOILTB                     R(4)            4     0        2     91719    COM              674                                
 SPHI0                      R(4)            4     1424           scalar   COM                                                 
 SPL                        R(4)            4     316      1     39       COM                                                 
 SQS                        R(4)            4     1164     1     134      COM                                                 
 SR                         R(4)            4     17243532 2     91719    COM              1050                               
 SSROFF                     R(4)            4     733756   2     91719    COM              1200                               
 SST                        R(4)            4     4772912  2     91719    COM                                                 
 STC                        R(4)            4     5503140  3     366876   COM              612                                
 STDOUT                     I(4)            4     0              scalar   COM                                                 
 STDRD                      L(4)            4     71506264       scalar   COM                                                 
 STHE                       R(4)            4     2004     1     76       COM                                                 
 STHEQ                      R(4)            4     2916     1     152      COM                                                 
 SUBSHX                     R(4)            4     733764   2     91719    COM              1358                               
 SVALUE                     R(4)            4     8              scalar   COM                                                 
 SWNET                      R(4)            4     2571656  2     91719    COM                                                 
 T                          R(4)            4     34119468 3     4127355  COM              420,422,453,454,1242,1637          
 T500                       R(4)            4     67470624 2     91719    COM                                                 
 TDTD                       R(4)            4     20             scalar   COM                                                 
 TDTQ2                      R(4)            4     12             scalar   COM                                                 
 TG                         R(4)            4     4039160  2     91719    COM                                                 
 TH10                       R(4)            4     366876   2     91719    COM              455,931                            
 TH30                       R(4)            4     2935008  2     91719    COM              456,999                            
 THE0                       R(4)            4     1700     1     76       COM                                                 
 THE0Q                      R(4)            4     2308     1     152      COM                                                 

Page 51          Source Listing                  SURFCE2
2022-02-15 16:39 Symbol Table                    SURFCE2.f

 Name                       Type            Bytes Offset   Dimen Elements Attributes       References                         
                                                                                                                              
 THL                        R(4)            4     52             scalar   COM                                                 
 THS                        R(4)            4     1100628  2     91719    COM              465                                
 THZ0                       R(4)            4     2568132  2     91719    COM                                                 
 TLAT                       R(4)            4     366876   3     4127355  COM                                                 
 TLM0D                      R(4)            4     276            scalar   COM                                                 
 TPH0D                      R(4)            4     280            scalar   COM                                                 
 TPREC                      R(4)            4     0              scalar   COM              1081,1101,1121,1141,1162,1183,1204 
                                                                                           ,1225,1450,1476,1759,1781,1803,182 
                                                                                           5,1848,1870,1893,1915,1938,1960,19 
                                                                                           83,2005,2030,2052,2075,2097        
 TRDSW                      R(4)            4     0              scalar   COM                                                 
 TSHDE                      R(4)            4     1172     1     61       COM                                                 
 TSHLTR                     R(4)            4     1834380  2     91719    COM              838,879                            
 TSL                        R(4)            4     69671880 2     91719    COM                                                 
 TSPH                       R(4)            4     264            scalar   COM              1080,1100,1120,1140,1161,1182,1203 
                                                                                           ,1224,1304,1334,1364,1394,1424,144 
                                                                                           9,1475,1758,1780,1802,1824,1847,18 
                                                                                           69,1892,1914,1937,1959,1982,2004,2 
                                                                                           029,2051,2074,2096                 
 TSRFC                      R(4)            4     0              scalar   COM              1305,1335,1365,1395,1425           
 TTBL                       R(4)            4     7381780  2     10184    COM                                                 
 TTBLQ                      R(4)            4     7422516  2     66880    COM                                                 
 TTV                        R(4)            4     70038756 2     91719    COM                                                 
 TWBS                       R(4)            4     3668760  2     91719    COM              1541                               
 U                          R(4)            4     1100628  3     4127355  COM                                                 
 U00                        R(4)            4     16509420 2     91719    COM                                                 
 U10                        R(4)            4     1100628  2     91719    COM              916                                
 U30                        R(4)            4     3668760  2     91719    COM              984                                
 UL                         R(4)            4     16876296 1     90       COM                                                 
 USTAR                      R(4)            4     0        2     91719    COM              1501                               
 UZ0                        R(4)            4     1834380  2     91719    COM                                                 
 V                          R(4)            4     17610048 3     4127355  COM                                                 
 V10                        R(4)            4     1467504  2     91719    COM              916                                
 V30                        R(4)            4     4035636  2     91719    COM              984                                
 VAPINC                     R(4)            4     18343812 2     91719    COM              2027,2045                          
 VAPINC7                    R(4)            4     18710688 2     91719    COM              2045                               
 VBM2                       R(4)            4     366876   2     91719    COM                                                 
 VBM3                       R(4)            4     733752   2     91719    COM                                                 
 VEGFRC                     R(4)            4     3301884  2     91719    COM              763,1565                           
 VTLAT                      R(4)            4     2935008  2     91719    COM                                                 
 VTLON                      R(4)            4     3301884  2     91719    COM                                                 
 VTM                        R(4)            4     18343800 3     4127355  COM                                                 
 VZ0                        R(4)            4     2201256  2     91719    COM                                                 
 WBD                        R(4)            4     268            scalar   COM                                                 
 WIJ                        R(4)            4     6604284  2     91719    COM                                                 
 WIJP                       R(4)            4     7338036  2     91719    COM                                                 
 WIPJ                       R(4)            4     6971160  2     91719    COM                                                 
 WIPJP                      R(4)            4     7704912  2     91719    COM                                                 
 X1P                        R(4)            4     300            scalar   COM                                                 
 Y1P                        R(4)            4     304            scalar   COM                                                 
 Z0                         R(4)            4     0        2     91719    COM              1493                               
 Z0SLP                      R(4)            4     312            scalar   COM                                                 
 Z1000                      R(4)            4     71139384 2     91719    COM                                                 
 ZINT                       R(4)            4     33752592 3     4219074  COM                                                 

Page 52          Source Listing                  SURFCE2
2022-02-15 16:39 Subprograms/Common Blocks       SURFCE2.f



SUBPROGRAMS/COMMON BLOCKS

 Name                       Object Declared Type            Bytes Dimen Elements Attributes       References                        
                                                                                                                                    
 ACMPRE                     Common 339                                  1467508  SAVE                                               
 ACMRDS                     Common 353                                  2201268  SAVE                                               
 ACMSFC                     Common 332                                  2568144  SAVE                                               
 CLDWTR                     Common 262                                  17610408 SAVE                                               
 CNVCLD                     Common 303                                  1467504  SAVE                                               
 CTLBLK                     Common 182                                  96       SAVE                                               
 EXTRA                      Common 211                                  71506268 SAVE                                               
 IOUNIT                     Common 347                                  20       SAVE                                               
 LLGRDS                     Common 309                                  8071788  SAVE                                               
 LOOPS                      Common 268                                  748952   SAVE                                               
 MAPOT                      Common 229                                  1448     SAVE                                               
 MASKS                      Common 242                                  34853220 SAVE                                               
 PARALLEL                   Common 189                                  8240                                                        
 PHYS                       Common 276                                  7690036  SAVE                                               
 PPTASM                     Common 388                                  19811316 SAVE                                               
 PVRBLS                     Common 250                                  23480064 SAVE                                               
 QFLX                       Common 358                                  8438148                                                     
 RQSTFLD                    Common 202                                  64130                                                       
 SOIL                       Common 323                                  8438180                                                     
 SRFDSP                     Common 297                                  4402512                                                     
 SURFCE2                    Subr   1                                                                                                
 VRBLS                      Common 222                                  67138308                                                    

COMPILER OPTIONS BEING USED

       -align noall                          -align nonone
       -align nocommons                      -align nodcommons
       -align noqcommons                     -align nozcommons
       -align records                        -align nosequence
       -align norec1byte                     -align norec2byte
       -align norec4byte                     -align norec8byte
       -align norec16byte                    -align norec32byte
       -align norec64byte                    -align noarray8byte
       -align noarray16byte                  -align noarray32byte
       -align noarray64byte                  -align noarray128byte
       -align noarray256byte                 -altparam
       -assume accuracy_sensitive            -assume nobscc
       -assume nobuffered_io                 -assume nobuffered_stdout
       -assume byterecl                      -assume nocontiguous_assumed_shape
       -assume nocontiguous_pointer          -assume nocc_omp
       -assume nocstring                     -assume nodummy_aliases
       -assume nofpe_summary                 -assume noieee_fpe_flags
       -assume nominus0                      -assume noold_boz
       -assume old_complex_align             -assume old_unit_star
       -assume old_inquire_recl              -assume old_ldout_format
       -assume old_ldout_zero                -assume noold_logical_assign
       -assume noold_logical_ldio            -assume old_maxminloc
       -assume old_xor                       -assume noprotect_allocates
       -assume protect_constants             -assume noprotect_parens
       -assume split_common                  -assume source_include
       -assume nostd_intent_in               -assume std_minus0_rounding

Page 53          Source Listing                  SURFCE2
2022-02-15 16:39                                 SURFCE2.f

       -assume nostd_mod_proc_name           -assume std_value
       -assume realloc_lhs                   -assume underscore
       -assume no2underscores                -assume norecursion
  no   -auto                                 -auto_scalar
  no   -bintext                              -ccdefault default
       -check noarg_temp_created             -check noassume
       -check nobounds                       -check nocontiguous
       -check noformat                       -check nooutput_conversion
       -check nooverflow                     -check nopointers
       -check noshape                        -check nostack
       -check nouninitialized                -check noudio_iostat
       -coarray-num-procs 0             no   -coarray-config-file
       -convert big_endian                   -cross_reference
       -D __INTEL_COMPILER=1910              -D __INTEL_COMPILER_UPDATE=3
       -D __unix__                           -D __unix
       -D __linux__                          -D __linux
       -D __gnu_linux__                      -D unix
       -D linux                              -D __ELF__
       -D __x86_64                           -D __x86_64__
       -D __amd64                            -D __amd64__
       -D __INTEL_COMPILER_BUILD_DATE=20200925       -D __INTEL_OFFLOAD
       -D __MMX__                            -D __SSE__
       -D __SSE_MATH__                       -D __SSE2__
       -D __SSE2_MATH__                      -D __SSE3__
       -D __SSSE3__                          -D __SSE4_1__
       -D __SSE4_2__                         -D __POPCNT__
       -D __PCLMUL__                         -D __AES__
       -D __AVX__                            -D __F16C__
       -D __AVX_I__                          -D __RDRND__
       -D __FMA__                            -D __FP_FAST_FMA
       -D __FP_FAST_FMAF                     -D __BMI__
       -D __LZCNT__                          -D __AVX2__
       -D __haswell                          -D __haswell__
       -D __tune_haswell__                   -D __core_avx2
       -D __core_avx2__                      -D __tune_core_avx2__
       -D __CRAY_X86_ROME                    -D __CRAYXT_COMPUTE_LINUX_TARGET
       -double_size 64                  no   -d_lines
  no   -Qdyncom                              -error_limit 30
  no   -f66                             no   -f77rtl
  no   -fast                                 -fpscomp nofilesfromcmd
       -fpscomp nogeneral                    -fpscomp noioformat
       -fpscomp noldio_spacing               -fpscomp nologicals
       -fixed                           no   -fpconstant
       -fpe3                                 -fprm nearest
  no   -ftz                                  -fp_model noprecise
       -fp_model fast                        -fp_model nostrict
       -fp_model nosource                    -fp_model nodouble
       -fp_model noextended                  -fp_model novery_fast
       -fp_model noexcept                    -fp_model nono_except
       -heap_arrays 0                   no   -threadprivate_compat
       -g2                                   -iface nomixed_str_len_arg
       -iface nono_mixed_str_len_arg         -init noarrays
       -init nohuge                          -init noinfinity
       -init nominus_huge                    -init nominus_infinity
       -init nominus_tiny                    -init nonan
       -init nosnan                          -init notiny
       -init nozero                     no   -intconstant

Page 54          Source Listing                  SURFCE2
2022-02-15 16:39                                 SURFCE2.f

       -integer_size 32                 no   -mixed_str_len_arg
  no   -module                               -names lowercase
  no   -noinclude                       no   -o
       -offload-build=host                   -openmp-simd
       -O2                              no   -pad_source
       -real_size 32                    no   -recursive
       -reentrancy threaded                  -vec=simd
       -show nofullpath                      -show noinclude
       -show map                             -show options
  no   -syntax_only                     no   -threadcom
  no   -U                               no   -vms
       -w noall                              -w nonone
       -w alignments                         -w nodeclarations
       -w noexternals                        -w general
       -w noignore_bounds                    -w noignore_loc
       -w nointerfaces                       -w noshape
       -w notruncated_source                 -w uncalled
       -w uninitialized                      -w nounused
       -w usage                         no   -wrap-margins

       -includepath : /pe/intel/compilers_and_libraries_2020.4.304/linux/pstl/include/,/pe/intel/compilers_and_libraries_2020.4.304/linux/compiler/include/,
           .f90,./.f90,/opt/cray/pe/mpich/8.1.9/ofi/intel/19.0/include/.f90,/pe/intel/compilers_and_libraries_2020.4.304/linux/ipp/include/.f90,
           /pe/intel/compilers_and_libraries_2020.4.304/linux/mkl/include/.f90,/pe/intel/compilers_and_libraries_2020.4.304/linux/pstl/include/.f90,
           /pe/intel/compilers_and_libraries_2020.4.304/linux/pstl/stdlib/.f90,/pe/intel/compilers_and_libraries_2020.4.304/linux/tbb/include/.f90,
           /pe/intel/compilers_and_libraries_2020.4.304/linux/compiler/include/intel64/.f90,/pe/intel/compilers_and_libraries_2020.4.304/linux/compiler/include/icc/.f90,
           /pe/intel/compilers_and_libraries_2020.4.304/linux/compiler/include/.f90,/usr/lib64/gcc/x86_64-suse-linux/7/include/.f90,
           /usr/lib64/gcc/x86_64-suse-linux/7/include-fixed/.f90,/usr/include/.f90,/usr/include/.f90,/usr/include/.f90
       -list filename : SURFCE2.lst
  no   -o

COMPILER: Intel(R) Fortran 19.1-1655
